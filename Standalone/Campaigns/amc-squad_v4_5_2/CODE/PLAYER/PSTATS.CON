/*
-------------------------------------------------------------------------------
===============================================================================

         -ooo:             +oo-            `+oo.       ./+oooooooooo+/:
        /NMMMN+            NMMNo`         -dMMM/      .mMMNmmmmmmmmmMMNo
       /NMd:mMMo           NMMNMd:      `oNMNMM/      :MMM/.........mMMh
      oNMd. -mMMy`         NMN:mMNs`   -hMm/mMM/      :MMM:         ::-.
    `sMMh`   .dMMh`        NMN .sNMd:`oNMh. mMM/      :MMM:
   `yMMMdhhhhhmMMMd.       NMN   /mMNdMm+`  mMM/      :MMM:         ss+:
  `hMMdhhhhhhhhhmMMm-      NMN    .yMMh.    mMM/      :MMM/.........mMMh
 .dMMs`         .hMMm:     NMN      :/`     mMM/      .mMMNmmmmmmmmmMMNo
 :oo+            `+oo+     +o+              +oo.       ./++ooooooooo+/:

###############################################################################
+ The AMC Squad
+ CON code by James Stanfield, Cedric "Sangman" Haegeman, Dino Bollinger,
+              Mikko Sandt, Cedric "Zaxtor" Lutes and Dan "Danarama" Gaskill
-------------------------------------------------------------------------------
* See AMC_MAIN.CON for a full list of script authors.

Feel free to use any code in the game for your own uses; just make
sure to mention the authors and/or "The AMC Squad" in your credits.
--------------------------------------------------------------------------------
NOTES:

--------------------------------------------------------------------------------
*/

defstate load_tile_pic
	ife CHAR 0
		{
		ifand CHAR_APP 64 set loading_tile 25507 else
		ifand CHAR_APP 1 set loading_tile 23848 else
		set loading_tile 3746
		}
	else
	ife CHAR 1 set loading_tile 3747 else
	ife CHAR 2
		{
		ifand CHAR_APP 4 set loading_tile 23888 else
		set loading_tile 3748
		}
	else
	ife CHAR 3
		{
		ifand CHAR_APP 16 set loading_tile 23889 else
		set loading_tile 3749
		}
	else
	ife CHAR 4
		{
		ifand CHAR_APP 2 set loading_tile 23834 else
		set loading_tile 3750
		}
	else
	ife CHAR 5 set loading_tile 3751 else
	ife CHAR 6 set loading_tile 3752 else
	ife CHAR 7
		{
		set loading_tile 3753
		}
		else
	ife CHAR 9 set loading_tile 23890 else
	ife CHAR 10 set loading_tile 10364 else
	ife CHAR 12 set loading_tile 12883 else
	ife CHAR 13
		{
		set loading_tile 16601
		}
	else
	ife CHAR 14 set loading_tile 20964 else
	ife CHAR 15 set loading_tile 16571 else
	ife CHAR 17 set loading_tile 27263 else
	set loading_tile 3587
ends

var ts_temp 0 0

defstate spawn_bat
ifand CHAR_APP 2 nullop else espawn 6200 // Sang's bat will no longer spawn after Le Sang is killed
ends

var is_player_close 0 2

defstate check_player_prox
	ifp palive
	 ife MOUSEUP 0
	  ifcansee
	   ifpdistl 1536
	   {
		 ifp pfacing
			set is_player_close 1
		else
		ifpdistl 768
			set is_player_close 1
		else set is_player_close 0
		}
	else set is_player_close 0
ends

defstate set_max_ally
	set max_ally 3 // default
	ife CHAR 3 add max_ally 1 // Highwire can command an extra ally
	ife PERSONNEL_RESEARCH[38] 2 add max_ally 1 // MJ12 comms?
	ife PERSONNEL_RESEARCH[39] 2 add max_ally 1 // Pitfiend comms?
	ifn CHAR -1
        ife ARTIFACTS_LOADOUT[CHAR] 12 
            add max_ally 1 // Pelinals sword adds an extra ally slot
ends

defstate SELECTEDCHAR
	readarrayfromfile ARTIFACTS_LOADOUT F_ARTIFACTS_LOADOUT_AMCTC
	readarrayfromfile SPECIALIST_EQUIPMENT F_SPECIAL_LOADOUT_AMCTC
	readarrayfromfile TIMES_CHOSEN F_TIMES_CHOSEN
	set ts_temp 0

	ife CHAR 0
			{
				setp[].max_player_health 100
				seta[PLAYER_IDENTITY].extra 100
			}
	ife CHAR 1 { setp[].max_player_health 255 seta[PLAYER_IDENTITY].extra 255 }
	ife CHAR 2 { setp[].max_player_health 200 seta[PLAYER_IDENTITY].extra 200 setp[].ammo_amount 1 3 }
	ife CHAR 3 { setp[].max_player_health 100 seta[PLAYER_IDENTITY].extra 100 }
	ife CHAR 4
		{
		ife PERSONNEL_RESEARCH[10] 2 { setp[].max_player_health 100 seta[PLAYER_IDENTITY].extra 100 }
        else ifand CHAR_APP 2 { setp[].max_player_health 100 seta[PLAYER_IDENTITY].extra 100 }
		else { setp[].max_player_health 75 seta[PLAYER_IDENTITY].extra 75 }
		state spawn_bat
		}
	ife CHAR 5
		{
		ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 140 seta[PLAYER_IDENTITY].extra 140 }
		else { setp[].max_player_health 120 seta[PLAYER_IDENTITY].extra 120 }
		}
	ife CHAR 6
        {
	    ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 140 seta[PLAYER_IDENTITY].extra 140 }
        else { setp[].max_player_health 120 seta[PLAYER_IDENTITY].extra 120 }
        }
	ife CHAR 7 // MIKKO
		{
			{
				ife PERSONNEL_RESEARCH[6] 2 // Both
				 ife PERSONNEL_RESEARCH[9] 2
				 {
				  setp[].max_player_health 200
				  seta[PLAYER_IDENTITY].extra 200
				 }
				 else
				ife PERSONNEL_RESEARCH[6] 2 // Cybertour sheathing
					{
					setp[].max_player_health 170
					seta[PLAYER_IDENTITY].extra 170
					}
					else
				ife PERSONNEL_RESEARCH[9] 2 // MS Corp ceramic plating
					{
					setp[].max_player_health 180
					seta[PLAYER_IDENTITY].extra 180
					}
				 else
				 {
				setp[].max_player_health 150
				seta[PLAYER_IDENTITY].extra 150
				}
			}
		}
	ife CHAR 9 { setp[].max_player_health 100 seta[PLAYER_IDENTITY].extra 100 }
	ife CHAR 10 { setp[].max_player_health 100 seta[PLAYER_IDENTITY].extra 100 }
	ife CHAR 11 { setp[].max_player_health 150 seta[PLAYER_IDENTITY].extra 150 }
	ife CHAR 12 { setp[].max_player_health 100 seta[PLAYER_IDENTITY].extra 100 }
	ife CHAR 13 { setp[].max_player_health 100 seta[PLAYER_IDENTITY].extra 100 }
	ife CHAR 14
		{
		set P_ENERGYSHIELD P_MAX_SHIELD
		ife PERSONNEL_RESEARCH[10] 2 { setp[].max_player_health 75 seta[PLAYER_IDENTITY].extra 75 } else
		{ setp[].max_player_health 50 seta[].extra 50 }
		}
	ife CHAR 16 { setp[].max_player_health 150 seta[PLAYER_IDENTITY].extra 150 }
	ife CHAR 17
		{
		ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 120 seta[PLAYER_IDENTITY].extra 120 }
		else { setp[].max_player_health 100 seta[].extra 100 }
		}
	ife CHAR 18
		{
		ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 80 seta[PLAYER_IDENTITY].extra 80 }
		else { setp[].max_player_health 70 seta[].extra 70 }
		}
	getp[].max_player_health pmax_health
	ife ARTIFACTS_LOADOUT[CHAR] 11 add pmax_health 20
	ife MEAL_BUFF[CHAR] 1 add pmax_health 10
	setp[].max_player_health pmax_health
	seta[PLAYER_IDENTITY].extra pmax_health

	ife MEAL_BUFF[CHAR] 4 set P_SPIRIT_ARMOUR 25

	set ts_temp TIMES_CHOSEN[CHAR]
	add ts_temp 1

	state set_max_ally

	setarray TIMES_CHOSEN[CHAR] ts_temp
	writearraytofile TIMES_CHOSEN F_TIMES_CHOSEN

	ifn CHAR 2 setp[].ammo_amount 1 48
	set CHARSELECT 0
	ifmultiplayer
	{
	qgetsysstr 356 STR_PLAYERNAME
	ife CHAR 0 qstrcat 356 357
	ife CHAR 1 qstrcat 356 358
	ife CHAR 2 qstrcat 356 359
	ife CHAR 3 qstrcat 356 360
	ife CHAR 4 qstrcat 356 361
	ife CHAR 5 qstrcat 356 362
	ife CHAR 6 qstrcat 356 363
	ife CHAR 7 qstrcat 356 364
	ife CHAR 9 qstrcat 356 365
	ife CHAR 10 qstrcat 356 366
	ife CHAR 11 qstrcat 356 367
	ife CHAR 12 qstrcat 356 368
	ife CHAR 13 qstrcat 356 369
	ife CHAR 14 qstrcat 356 370
	ife CHAR 16 qstrcat 356 371
	ife CHAR 17 qstrcat 356 372
	userquote 356
	}
	globalsound CHOSEN
	set char_sel_anim 30

		ife CHAR 0
			{
			readgamevar JAMES_1911
			readgamevar JAMES_JACKH
			}
ends


// character appearence
appendevent EVENT_ENTERLEVEL
    switch VOLUME
        case -1
            // inherit previous value
            break
        case 0 // Episode 1
            switch LEVEL
                case 26 // TRAINING
                    // inherit previous value
                    break
                default
                    set CHAR_APP 0 // only default appearances here
                    break
            endswitch
            break
        case 1 // Episode 2
            switch LEVEL
                case 22 // MOON_DX.MAP
                case 30 // VTEST.MAP
                    // inherit previous value
                    break
                default
                    set CHAR_APP 0 // only default appearances here
                    break
            endswitch
            break
        case 2 // Episode 3
            switch LEVEL
                case 32 // GARMID.MAP
                    // inherit previous value
                    break
                case 0 // INTRO3.MAP
                case 1 // AMCB.MAP
                case 2 // BRIEF6.MAP
                case 3 // X64-2M.MAP
                case 4 // AMCB.MAP
                case 5 // EINTRO.MAP
                case 6 // EGY_HUB.MAP
                case 7 // CATAC.MAP
                case 8 // SS.MAP
                case 9 // EGLOKE_PT1.MAP
                case 10 // EGLOKE_PT2.MAP
                case 11 // SANGTOMB.MAP
                case 12 // LESANG.MAP
                case 13 // SS2.MAP
                case 46 // X64-2M_2.MAP
                    set CHAR_APP 1 // James' bionic hand
                    break
                default // everything else
                    set CHAR_APP 3 // James' bionic hand + Rehab Sang
                    break
            endswitch
            break
        case 3 // Episode 4
            set CHAR_APP 3 // James' bionic hand + Crusader Sang
			switch LEVEL
					case 8 // Wetlands
					case 9 // Forest
					case 10 // Saelmere
					case 15 // Darrow lake
					case 16 // knight's fall
					case 17 // Necropolis
					case 18 // cave diving in the sky
					case 19 // underworld
					case 20 // Mongur
					case 22 // Grotto
					case 23 // Library
					case 25 // palace
					case 26 // dragonfight
					case 27 // skytown
					case 28 // temple
					case 29 // snow temple
					case 31 // boat battle
					case 32 // dehydration
					case 34 // Roesia's den
					case 36 // battle prep
					case 37 // town attack
					case 41 // pyramid
					case 42 // Skytown cutscene
					case 43 // Anchors aweigh
					case 52 // ending cutscene
					case 55 // rowgar
					case 56 // necro keep
					case 57 // naaldir
					case 58 // home base
					case 60
						or CHAR_APP 64 // Ringworld James
						or CHAR_APP 128 // beard micky
						or CHAR_APP 4 // Berserker Merlijn
						or CHAR_APP 32 // Rusty's hunter outfit
						break
					default // everything else
						break
			endswitch
            break
		case 4
				or CHAR_APP 16 // SMART Highwire
				or CHAR_APP 64 // Ringworld James
				or CHAR_APP 128 // beard micky
				or CHAR_APP 4 // Berserker Merlijn
				or CHAR_APP 32 // Rusty's hunter outfit
				break
		case 5
        case 6 // EDF Usermaps
            // inherit previous value
            break
    endswitch
endevent


defstate setknockback // Player knockback
getp[].posx mx
getp[].posy my
geta[].x x
geta[].y y
sub mx x
sub my y
getangle knockbackang mx my
set knockback 3
ends

// GUN SOUND =====================================================================================================================


useractor notenemy SOUND_SPRITE
cstat 32768
seta[].ang player[].ang
ifg temp MAX_SOUNDS killit
soundvar temp
killit
enda


defstate katana_swing_sounds
ifrnd 96 sound SWING4
else ifrnd 96 sound SWING3
else ifrnd 97 sound SWING2
else sound SWING
ends

defstate shield_stuff
		getp[].ang temp7
		add temp7 1024
		getincangle temp4 sprite[].htang temp7
		ifand temp4 2147483648
			{
			xorvar temp4 -1 // bitfield: 4294967295
			add temp4 1
			}
		ifg riot_shield 0
		ifg shield_up 0
		{
		ifl temp4 225 // is angle between them less than 200?
			{
				ifand PROJ_UDATA 131072 divvar damage_temp 4 // melee damage is much weaker against shields
				ife temp2 HOLLOW_POINT_SHOT divvar damage_temp 6 // soft bullets damage are sixthed
				ife temp2 GREENLASERSHOT divvar damage_temp 6 // soft damage are sixthed
				ife temp2 SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 ENEMY_SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 F45_CALIBRE divvar damage_temp 3 // .45 don't penetrate armour as much
				ife temp2 NINEMM_CALIBRE divvar damage_temp 2 // 9mm bullets don't penetrate armour as much
				ife temp2 ARMOUR_PIERCING_SHOT mulvar damage_temp 2 // AP bullets wreck armour
				ife temp2 MPLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 MDF_PLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 5372 divvar damage_temp 2  // plasma doesn't work as well against body armour
				ifg damage_temp 50 set CUS_WACK 1
				ife shield_type 1 sound HITWOOD
				else ife shield_type 2 sound SOMETHINGHITFORCE
				else
					{
					ifrnd 96 sound RIOTSHIELD_HIT1
					else ifrnd 96 sound RIOTSHIELD_HIT2
					else sound RIOTSHIELD_HIT3
					}
				sub riot_shield damage_temp
				div damage_temp 2
				ifg damage_temp 10 set damage_temp 10
				set shield_shake damage_temp
				set damage_temp 0
	            seta[].htextra -1
	            	ifl riot_shield 1
					{
					set CUS_WACK 2
					ife shield_type 1 globalsound WOODBREAK else
					ife shield_type 2 globalsound WOODBREAK else
						{
						globalsound RIOTSHIELD_BREAK
						lotsofglass 16
						}
					set riot_shield 0
					set shield_up 0
					palfrom 20 20 0 0
					}
			}
		}
		else
		ife CHAR 11 // Maartn?
		{
		ifl temp4 512 // is angle between them less than 512?
			{
			ifg merl_shieldup 0
	       	ifg maartn_shield 0
				{
				ifand PROJ_UDATA 131072
					{
					ifge shield_bash 15 { sound SH_PARRY set damage_temp 0 } else
					divvar damage_temp 4 // melee damage is much weaker against shields
					}
				ife temp2 HOLLOW_POINT_SHOT divvar damage_temp 6 // soft bullets damage are sixthed
				ife temp2 GREENLASERSHOT divvar damage_temp 6 // soft damage are sixthed
				ife temp2 SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 ENEMY_SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 F45_CALIBRE divvar damage_temp 3 // .45 don't penetrate armour as much
				ife temp2 NINEMM_CALIBRE divvar damage_temp 2 // 9mm bullets don't penetrate armour as much
				ife temp2 ARMOUR_PIERCING_SHOT mulvar damage_temp 2 // AP bullets wreck armour
				ife temp2 MPLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 MDF_PLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 5372 divvar damage_temp 2  // plasma doesn't work as well against body armour
				ifg damage_temp 50 set CUS_WACK 1
				ifg damage_temp 0
					{
					ifrnd 128 sound SHIELDHIT2 else sound SHIELDHIT
					}
				sub maartn_shield damage_temp
				div damage_temp 2
				ifg damage_temp 10 set damage_temp 10
				set shield_shake damage_temp
				set damage_temp 0
	            	seta[].htextra -1
	            	ifl maartn_shield 1
						{
						set CUS_WACK 2
						globalsound SHIELD_DESTROY
						set maartn_shield 0
						palfrom 20 20 0 0
						}
				}
			}
		}
		else
		ife CHAR 2 // Merlijn?
		{
		ife m_shieldtype 0
		ifl temp4 275 // is angle between them less than 275?
			{
			ifg merl_shieldup 0
	       	ifg merlijn_shield 0
				{
				ifand PROJ_UDATA 131072
					{
					ifge shield_bash 15 { sound SH_PARRY set damage_temp 0 } else
					divvar damage_temp 4 // melee damage is much weaker against shields
					}
				ife temp2 HOLLOW_POINT_SHOT divvar damage_temp 6 // soft bullets damage are sixthed
				ife temp2 GREENLASERSHOT divvar damage_temp 6 // soft damage are sixthed
				ife temp2 SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 ENEMY_SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 F45_CALIBRE divvar damage_temp 3 // .45 don't penetrate armour as much
				ife temp2 NINEMM_CALIBRE divvar damage_temp 2 // 9mm bullets don't penetrate armour as much
				ife temp2 ARMOUR_PIERCING_SHOT mulvar damage_temp 2 // AP bullets wreck armour
				ife temp2 MPLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 MDF_PLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 5372 divvar damage_temp 2  // plasma doesn't work as well against body armour
				ifrnd 32 set CUS_WACK 1
				ifg damage_temp 0
					{
					ifrnd 128 sound SHIELDHIT2 else sound SHIELDHIT
					}
				sub merlijn_shield damage_temp
				div damage_temp 2
				ifg damage_temp 10 set damage_temp 10
				set shield_shake damage_temp
				set damage_temp 0
	            	seta[].htextra -1
	            	ifl merlijn_shield 1
						{
						set CUS_WACK 2
						globalsound SHIELD_DESTROY
						palfrom 20 20 0 0
						set merlijn_shield 0
						}
				}
			}
		 else
		ife m_shieldtype 1
		ifl temp4 512 // is angle between them less than 512?
			{
			ifg merl_shieldup 0
	       	ifg merlijn_shield 0
				{
				ifand PROJ_UDATA 131072
					{
					ifge shield_bash 15 { sound SH_PARRY set damage_temp 0 } else
					divvar damage_temp 4 // melee damage is much weaker against shields
					}
				ife temp2 HOLLOW_POINT_SHOT divvar damage_temp 6 // soft bullets damage are sixthed
				ife temp2 GREENLASERSHOT divvar damage_temp 6 // soft damage are sixthed
				ife temp2 SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 ENEMY_SHOTGUN divvar damage_temp 4 // shotgun pellets don't penetrate armour as much
				ife temp2 F45_CALIBRE divvar damage_temp 3 // .45 don't penetrate armour as much
				ife temp2 NINEMM_CALIBRE divvar damage_temp 2 // 9mm bullets don't penetrate armour as much
				ife temp2 ARMOUR_PIERCING_SHOT mulvar damage_temp 2 // AP bullets wreck armour
				ife temp2 MPLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 MDF_PLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
				ife temp2 5372 divvar damage_temp 2  // plasma doesn't work as well against body armour
				ifg damage_temp 50 set CUS_WACK 1
				ifg damage_temp 0
					{
					ifrnd 128 sound SHIELDHIT2 else sound SHIELDHIT
					}
				sub merlijn_shield damage_temp
				div damage_temp 2
				ifg damage_temp 10 set damage_temp 10
				set shield_shake damage_temp
				set damage_temp 0
	            	seta[].htextra -1
	            	ifl merlijn_shield 1
						{
						set CUS_WACK 2
						globalsound SHIELD_DESTROY
						set merlijn_shield 0
						palfrom 20 20 0 0
						}
				}
			}
		}
ends

defstate emp_hitstuff
	palfrom 20 40 0 0
	ifrnd 96 set PLAYER_VOICEOVER 58
	seta[].htextra -1

		ifl SKILL_LEVEL 2 set emp_damage 90
		else ife SKILL_LEVEL 2 set emp_damage 150
		else ife SKILL_LEVEL 3 set emp_damage 180
		else ife SKILL_LEVEL 4 set emp_damage 240
		else ife SKILL_LEVEL 5 set emp_damage 300
ends

defstate cursed_hitstuff
ife ARTIFACTS_LOADOUT[CHAR] 3 // Minerva's amulet?
 ifrnd 16 // has a rare chance of nullifying the damage
	{
	set artifact_used 60
	seta[].htextra -1
	palfrom 20 0 0 40
	soundonce SPARM_PROTECT
	}
	else
ife CHAR 14
 ifn player[].holoduke_on -1 // Snowfall's psi-shield?
	{
	seta[].htextra -1
	palfrom 20 0 0 40
	soundonce SPARM_PROTECT
	}
	else
ifg P_SPIRIT_ARMOUR 0
	{
		sub P_SPIRIT_ARMOUR damage_temp
		seta[].htextra -1
		palfrom 20 0 0 40
		set mindshield_cooldown 150
		soundonce SPARM_PROTECT
		ifl P_SPIRIT_ARMOUR 0 set P_SPIRIT_ARMOUR 0
	}
else
	{
	sound P_CURSED
	palfrom 20 40 0 40
	ifrnd 96 set PLAYER_VOICEOVER 49
	ife MYSTICAL_RESEARCH[4] 2 // Siren Ward?
		{
		ifl SKILL_LEVEL 2 set CURSED 60
		else ife SKILL_LEVEL 2 set CURSED 105
		else ife SKILL_LEVEL 3 set CURSED 126
		else ife SKILL_LEVEL 4 set CURSED 168
		else ife SKILL_LEVEL 5 set CURSED 210
		}
	else
		{
		ifl SKILL_LEVEL 2 set CURSED 90
		else ife SKILL_LEVEL 2 set CURSED 150
		else ife SKILL_LEVEL 3 set CURSED 180
		else ife SKILL_LEVEL 4 set CURSED 240
		else ife SKILL_LEVEL 5 set CURSED 300
		}
	ife CHAR 4 ifg PARMOUR 0 div CURSED 2
	}
ends

defstate spirit_armour_hitstuff
ife ARTIFACTS_LOADOUT[CHAR] 3 // Minerva's amulet?
{
ifrnd 6 // has a very rare chance of nullifying the damage
	{
	set artifact_used 60
	seta[].htextra -1
	palfrom 20 0 0 40
	soundonce SPARM_PROTECT
	}
}
ifg P_SPIRIT_ARMOUR 0
{
	sub P_SPIRIT_ARMOUR damage_temp
	seta[].htextra -1
	palfrom 20 0 0 40
	soundonce SPARM_PROTECT
	set mindshield_cooldown 150
	ifl P_SPIRIT_ARMOUR 0 set P_SPIRIT_ARMOUR 0
}
ife CHAR 4 ifg PARMOUR 0 div damage_temp 2
ends

defstate suit_armour_stuff
geta[].htextra damage_temp
	ifg damage_temp 0 // if the actor is set to take some damage from a weapon...
		{
		geta[].htpicnum temp2
		ifand tiledata[temp2].gameflags 8 getprojectile[temp2].userdata PROJ_UDATA else
		ife temp2 COOLEXPLOSION1 set PROJ_UDATA 16384 else set PROJ_UDATA 0

		ife CHAR 14
		 ifn player[].holoduke_on -1 // Snowfall's psi-shield?
			{
			ifand PROJ_UDATA 278528
				{
				seta[].htextra -1
				palfrom 20 0 0 40
				soundonce SPARM_PROTECT
				}
			}

		ifand PROJ_UDATA 2 state fire_armour_hitstuff
		else ifand PROJ_UDATA 16384 state spirit_armour_hitstuff
		else ifand PROJ_UDATA 262144 state cursed_hitstuff
		else ifand PROJ_UDATA 524288 set BLINDED 120
		else ifand PROJ_UDATA 2097152 state emp_hitstuff
		else ife temp2 COOLEXPLOSION1 state spirit_armour_hitstuff
			else
			{
			state shield_stuff
			ifand PROJ_UDATA 16 sound LASER_IMPACT
					ife CHAR 13 // micky?
					 ifp pboosted // energy dampener?
					 {
					  ife temp2 FIRELASER // have to do default hardcoded projectiles manually
						{
						sound SHORT_CIRCUIT
						palfrom 10 0 0 32
						getp[].shield_amount armour_temp
						ifl armour_temp 100
							{
							div damage_temp 2
							add armour_temp damage_temp
							setp[].shield_amount armour_temp
							}
						set damage_temp 0
						seta[].htextra -1
						}
					  ifand PROJ_UDATA 8209
						{
						sound SHORT_CIRCUIT
						palfrom 10 0 0 32
						getp[].shield_amount armour_temp
						ifl armour_temp 100
							{
							div damage_temp 4
							add armour_temp damage_temp
							setp[].shield_amount armour_temp
							}
						set damage_temp 0
						seta[].htextra -1
						}
					}
		   ifg player[].shield_amount 0
				{
					getp[].shield_amount armour_temp
					ifand PROJ_UDATA 32 nullop else
					ifand PROJ_UDATA 64 nullop else
						{
						mul damage_temp 10
						div damage_temp 13 // does an initial 25% flat reduction
						}
					ifand PROJ_UDATA 128 divvar damage_temp 2
					set ARM_BLEEDOFF damage_temp
					ifand PROJ_UDATA 32 div ARM_BLEEDOFF 3 else // AP spreads 33% to HP
					ifand PROJ_UDATA 8192 div ARM_BLEEDOFF 2 else // Electric spreads 50% to HP
					div ARM_BLEEDOFF 5 // spread 20% to HP
					sub damage_temp ARM_BLEEDOFF // 1/5 damage goes to Jane/Micky/Snowfall
					sub armour_temp damage_temp // 4/5 damage goes to shield
					ifl armour_temp 0 setp[].shield_amount 0 else
					setp[].shield_amount armour_temp
					ifg ARM_BLEEDOFF 0
						{
						seta[].htextra ARM_BLEEDOFF
						set ARM_BLEEDOFF 0
						}
						else
					seta[].htextra -1

				   state HIT_IND_ARM
				}
			}
		}
ends

defstate body_armour_stuff
	geta[].htextra damage_temp
	ifg damage_temp 0 // if the actor is set to take some damage from a weapon...
		{
		geta[].htpicnum temp2
		ifand tiledata[temp2].gameflags 8 getprojectile[temp2].userdata PROJ_UDATA else set PROJ_UDATA 0
		ifand PROJ_UDATA 2 state fire_armour_hitstuff
		else ifand PROJ_UDATA 16384 state spirit_armour_hitstuff
		else ifand PROJ_UDATA 262144 state cursed_hitstuff
		else ifand PROJ_UDATA 524288 set BLINDED 120
		else ifand PROJ_UDATA 2097152 state emp_hitstuff
		else ife temp2 COOLEXPLOSION1 state spirit_armour_hitstuff
		else ifand PROJ_UDATA 8 { set CUS_WACK 1 palfrom 40 40 0 0 }
			else
			{
			state shield_stuff
			ifand PROJ_UDATA 16 sound LASER_IMPACT
		   ifg player[].shield_amount 0
				{
					getp[].shield_amount armour_temp
					ife PERSONNEL_RESEARCH[4] 2 // player has the improved armour?
						{
						ife temp2 HOLLOW_POINT_SHOT divvar damage_temp 3 // soft bullets damage are sixthed
						ife temp2 GREENLASERSHOT divvar damage_temp 3 // soft damage are sixthed
						ife temp2 SHOTGUN divvar damage_temp 2 // shotgun pellets don't penetrate armour as much
						ife temp2 ENEMY_SHOTGUN divvar damage_temp 2 // shotgun pellets don't penetrate armour as much
						ife temp2 F45_CALIBRE divvar damage_temp 2 // 45 bullets don't penetrate armour as much
						ife temp2 NINEMM_CALIBRE divvar damage_temp 2
						}
					/*
					ife PERSONNEL_RESEARCH[4] 2 // player has the improved armour?
						{
						ife temp2 HOLLOW_POINT_SHOT divvar damage_temp 4
						ife temp2 GREENLASERSHOT divvar damage_temp 4
						ife temp2 SHOTGUN divvar damage_temp 3
						ife temp2 ENEMY_SHOTGUN divvar damage_temp 3
						ife temp2 F45_CALIBRE divvar damage_temp 3
						ife temp2 NINEMM_CALIBRE divvar damage_temp 3
						}
					else
						{
						ife temp2 HOLLOW_POINT_SHOT divvar damage_temp 3 // soft bullets damage are sixthed
						ife temp2 GREENLASERSHOT divvar damage_temp 3 // soft damage are sixthed
						ife temp2 SHOTGUN divvar damage_temp 2 // shotgun pellets don't penetrate armour as much
						ife temp2 ENEMY_SHOTGUN divvar damage_temp 2 // shotgun pellets don't penetrate armour as much
						ife temp2 F45_CALIBRE divvar damage_temp 2 // 45 bullets don't penetrate armour as much
						}
					*/
					ifand PROJ_UDATA 32
						{
						divvar damage_temp 2 // AP goes through armour
						set ARM_BLEEDOFF damage_temp
						}
					ife temp2 1670 // radius explosion
						{
						divvar damage_temp 2 // explosions go through armour
						set ARM_BLEEDOFF damage_temp
						}
					ife temp2 2690 // missile
						{
						divvar damage_temp 2 // explosions go through armour
						set ARM_BLEEDOFF damage_temp
						}
					ife temp2 2605 // RPG
						{
						divvar damage_temp 2 // explosions go through armour
						set ARM_BLEEDOFF damage_temp
						}
					ife temp2 MPLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
					ife temp2 MDF_PLASMA divvar damage_temp 2 // plasma doesn't work as well against body armour
					ife temp2 5372 divvar damage_temp 2 // plasma doesn't work as well against body armour
					sub armour_temp damage_temp
					ifl armour_temp 0 setp[].shield_amount 0 else
					setp[].shield_amount armour_temp
					ifg ARM_BLEEDOFF 0
						{
						seta[].htextra ARM_BLEEDOFF
						set ARM_BLEEDOFF 0
						}
						else
					seta[].htextra -1

				   state HIT_IND_ARM
					ifl armour_temp 0
					 ifn PERSONNEL_RESEARCH[16] 2 // player doesn't have the ablative plating research?
						{
						geta[].extra temp3
						add temp3 armour_temp
						seta[].extra temp3
						setp[].shield_amount 0
						palfrom 20 20 0 0
						}
				}
			}
		}
ends

defstate ARMOUR_STUFF
switch CHAR
case 0 // James' armour
case 7 // Mikko's armour
	geta[].htextra damage_temp
	ifg damage_temp 0 // if the actor is set to take some damage from a weapon...
		{
		geta[].htpicnum temp2
		ifand tiledata[temp2].gameflags 8 getprojectile[temp2].userdata PROJ_UDATA else set PROJ_UDATA 0
		ifand PROJ_UDATA 2 state fire_armour_hitstuff
		else ifand PROJ_UDATA 16384 state spirit_armour_hitstuff
		else ifand PROJ_UDATA 262144 state cursed_hitstuff
		else ifand PROJ_UDATA 524288 set BLINDED 120
		else ifand PROJ_UDATA 2097152 state emp_hitstuff
		else ife temp2 COOLEXPLOSION1 state spirit_armour_hitstuff
			else
			{
			state shield_stuff
			ifand PROJ_UDATA 16 sound LASER_IMPACT
		   ifg player[].shield_amount 0
		    ifg damage_temp 0
				{
					getp[].shield_amount armour_temp
					ife CHAR 0
					ifand CHAR_APP 1 // more armoured up James?
						{
						mul damage_temp 10
						div damage_temp 13 // does an initial 25% flat reduction
						}
					else
						{
						mul damage_temp 10
						div damage_temp 12 // does an initial 20% flat reduction
						}
					ife PERSONNEL_RESEARCH[4] 2 // player has the improved armour?
						{
						ife temp2 HOLLOW_POINT_SHOT div damage_temp 2
						else ife temp2 GREENLASERSHOT div damage_temp 2
						else ife temp2 SHOTGUN div damage_temp 2
						else ife temp2 ENEMY_SHOTGUN div damage_temp 2
						else ife temp2 F45_CALIBRE div damage_temp 2
						else ifand PROJ_UDATA 128 div damage_temp 2
						}
					set ARM_BLEEDOFF damage_temp
					div ARM_BLEEDOFF 3
					sub damage_temp ARM_BLEEDOFF // 1/3 damage goes to player
					sub armour_temp damage_temp // 2/3 damage goes to shield
					ifl armour_temp 0 setp[].shield_amount 0 else
					setp[].shield_amount armour_temp
					ifg ARM_BLEEDOFF 0
						{
						seta[].htextra ARM_BLEEDOFF
						set ARM_BLEEDOFF 0
						}
						else
					seta[].htextra -1

				   state HIT_IND_ARM
					ifl armour_temp 0
					 ifn PERSONNEL_RESEARCH[16] 2 // player doesn't have the ablative plating research?
						{
						geta[].extra temp3
						add temp3 armour_temp
						seta[].extra temp3
						setp[].shield_amount 0
						palfrom 20 20 0 0
						}
				}
			}
		}
	break
case 1 // Zaxtor's armour
case 17 // Kagura
	geta[].htextra damage_temp
	ifg damage_temp 0 // if the actor is set to take some damage from a weapon...
		{
		geta[].htpicnum temp2
		ifand tiledata[temp2].gameflags 8 getprojectile[temp2].userdata PROJ_UDATA else set PROJ_UDATA 0
		ifand PROJ_UDATA 2 state fire_armour_hitstuff
		else ifand PROJ_UDATA 16384 state spirit_armour_hitstuff
		else ifand PROJ_UDATA 262144 state cursed_hitstuff
		else ifand PROJ_UDATA 524288 set BLINDED 120
		else ifand PROJ_UDATA 2097152 state emp_hitstuff
		else ife temp2 COOLEXPLOSION1 state spirit_armour_hitstuff
			else
			{
			state shield_stuff
			ifand PROJ_UDATA 16 sound LASER_IMPACT
		   ifg player[].shield_amount 0
				{
					getp[].shield_amount armour_temp
					mul damage_temp 2
					div damage_temp 3 // Zaxtor's armour does a flat 33% damage reduction against ALL damage
					set ARM_BLEEDOFF damage_temp
					sub armour_temp damage_temp
					ifl armour_temp 0 setp[].shield_amount 0 else
					setp[].shield_amount armour_temp
					ifg ARM_BLEEDOFF 0
						{
						seta[].htextra ARM_BLEEDOFF
						set ARM_BLEEDOFF 0
						}
						else
					seta[].htextra -1

				   state HIT_IND_ARM
					ifl armour_temp 0
					 ifn PERSONNEL_RESEARCH[16] 2 // player doesn't have the ablative plating research?
						{
						geta[].extra temp3
						add temp3 armour_temp
						seta[].extra temp3
						setp[].shield_amount 0
						palfrom 20 20 0 0
						}
				}
			}
		}
	break
case 2 // Merlijn
case 11 // Maarten
geta[].htextra damage_temp
ifg damage_temp 0 // if the player is set to take some damage from a weapon...
	{
	ife CHAR 2
	 {
	 ifand CHAR_APP 4 // Berserker Merlijn? protects him the more hurt he is
		{
		ifl PHEALTH 125
			{
			mul damage_temp 10
			div damage_temp 13 // does an initial 25% flat reduction
			}
		else
		ifl PHEALTH 75
			{
			mul damage_temp 10
			div damage_temp 15 // does an initial 33% flat reduction
			}
		else
		ifl PHEALTH 50
			{
			mul damage_temp 10
			div damage_temp 20 // does an initial 50% flat reduction
			}
		ifl PHEALTH 75 ife player_ability_2 0
			{
			seta[].htextra -1
			setactor[].extra 125
			quake 26
			ifrnd 128 sound M_MELEE_1 else sound M_MELEE_2
			palfrom 40 64
			set player_berserking 450
			ife MELEE_RESEARCH[8] 2 set player_ability_2 600 else
			set player_ability_2 900
			}
		ifg player_berserking 0 div damage_temp 3
		}
	else
	ife MELEE_RESEARCH[8] 2 // Merlijn berserk research
		{
		ifl PHEALTH 75 ife player_ability_2 0
			{
			seta[].htextra -1
			setactor[].extra 75
			quake 26
			ifrnd 128 sound M_MELEE_1 else sound M_MELEE_2
			palfrom 40 64
			set player_berserking 450
			set player_ability_2 900
			}
		ifg player_berserking 0 div damage_temp 3
		}
	  }
		geta[].htpicnum temp2
		ifand tiledata[temp2].gameflags 8 getprojectile[temp2].userdata PROJ_UDATA else set PROJ_UDATA 0
		ifand PROJ_UDATA 2 state fire_armour_hitstuff
		else ifand PROJ_UDATA 16384 state spirit_armour_hitstuff
		else ifand PROJ_UDATA 262144 state cursed_hitstuff
		else ifand PROJ_UDATA 524288 palfrom 40 0 0 0
		else ifand PROJ_UDATA 2097152 state emp_hitstuff
		else ife temp2 COOLEXPLOSION1 state spirit_armour_hitstuff
		else
			{
			state shield_stuff
			  ifg player[].shield_amount 0
							{
							getp[].shield_amount armour_temp
							ifand PROJ_UDATA 64 // armour negating?
								{
								ifand PROJ_UDATA 131072 divvar damage_temp 2 // Merlijn's armour should still protect a bit against this so it's not useless
								}
								else
								{
								ifand PROJ_UDATA 131072 divvar damage_temp 6 else // Merlijn's armour is extra effective against melee attacks
								divvar damage_temp 2
								}
							set ARM_BLEEDOFF damage_temp
							sub armour_temp damage_temp
							ifl armour_temp 0 setp[].shield_amount 0 else
							setp[].shield_amount armour_temp
							ifg ARM_BLEEDOFF 0
								{
								seta[].htextra ARM_BLEEDOFF
								set ARM_BLEEDOFF 0
								}
								else
							seta[].htextra -1

						   state HIT_IND_ARM

							ifl armour_temp 0
							 ifn PERSONNEL_RESEARCH[16] 2 // player doesn't have the ablative plating research?
								{
								geta[].extra temp3
								add temp3 armour_temp
								seta[].extra temp3
								setp[].shield_amount 0
								palfrom 20 20 0 0
								}
						}
			}
	}
break
case 4 // Sang
geta[].htextra damage_temp
ifg damage_temp 0 // if the player is set to take some damage from a weapon...
	{
		geta[].htpicnum temp2
		ifand tiledata[temp2].gameflags 8 getprojectile[temp2].userdata PROJ_UDATA else set PROJ_UDATA 0
		ifand PROJ_UDATA 2 state fire_armour_hitstuff
		else ifand PROJ_UDATA 16384 state spirit_armour_hitstuff
		else ifand PROJ_UDATA 262144 state cursed_hitstuff
		else ifand PROJ_UDATA 524288 palfrom 40 0 0 0
		else ifand PROJ_UDATA 2097152 state emp_hitstuff
		else ife temp2 COOLEXPLOSION1 state spirit_armour_hitstuff
		else
			{
			state shield_stuff
			  ifg player[].shield_amount 0
							{
							getp[].shield_amount armour_temp
							ifand CHAR_APP 2 // armoured sang?
								{
								mul damage_temp 10
								div damage_temp 13 // does an initial 25% flat reduction
								}
							ifand PROJ_UDATA 16384 divvar damage_temp 3 else // Sang's armour is extra effective against spirit attacks
							ifand PROJ_UDATA 262144 divvar damage_temp 3 else // Sang's armour is extra effective against cursed attacks
							divvar damage_temp 2
							set ARM_BLEEDOFF damage_temp
							sub armour_temp damage_temp
							ifl armour_temp 0 setp[].shield_amount 0 else
							setp[].shield_amount armour_temp
							ifg ARM_BLEEDOFF 0
								{
								seta[].htextra ARM_BLEEDOFF
								set ARM_BLEEDOFF 0
								}
								else
							seta[].htextra -1

						   state HIT_IND_ARM

							ifl armour_temp 0
							 ifn PERSONNEL_RESEARCH[16] 2 // player doesn't have the ablative plating research?
								{
								geta[].extra temp3
								add temp3 armour_temp
								seta[].extra temp3
								setp[].shield_amount 0
								palfrom 20 20 0 0
								}
						}
			}
	}
break
case 3
	ifand CHAR_APP 16 state suit_armour_stuff
	else state body_armour_stuff
	break
case 5
case 6
case 9
case 10
	state body_armour_stuff
	break
case 12 // Jane
case 13 // Micky
case 14 // Snowfall
	state suit_armour_stuff
	break
endswitch
ends

onevent EVENT_GETAUTOAIMANGLE
 setvar AUTOAIMANGLE 96
endevent


// ALLY STUFF

defstate ignore_ally_damage
	getav[EV_TARG_SPRITE].faction_flag temp8

	ifand temp8 ALLIED_FACTION_FLAG
	{
		ifand ALLY_ORDER 1 set target -1

		geta[].owner temp
		geta[temp].picnum temp2

		// allow player self damage
		ife temp2 SHRINKSPARK
			nullop
		else ife EV_TARG_SPRITE temp
			ife temp2 APLAYER
		{
			nullop
		}
		else
		{
			geta[EV_TARG_SPRITE].picnum temp3
			getav[temp].faction_flag temp4
			geta[temp].picnum temp5

			// temp3 = picnum of target
			// temp5 = picnum of shooter

			// faction_flag = faction of target
			// temp4 = faction of shooter

			// Other actor also is an ally
			ifand temp4 ALLIED_FACTION_FLAG
				set RETURN -1
			else // not in allied faction but need to ignore damage all the same for these cases
				ife actorvar[temp].actor_type TYPE_IGNORE_DAMAGE set RETURN -1
		}
	}
ends

// WEAPON, AMMO, ITEMS 'N SHIT ACTIONS ===========================================================================================

var revol_temp 0 1

defstate revolver_eject
	set temp4 MAXPISTOLMAG
	sub temp4 PISTOLMAG
	clamp temp4 0 MAXPISTOLMAG
	set revol_temp 0
	whilevarvarn revol_temp temp4
		{
		shoot REVOLV_SHELL
		add revol_temp 1
		}
ends

defstate revolver_silver_eject
	set temp4 MAXPISTOLMAG
	sub temp4 PISTOLMAG
	clamp temp4 0 MAXPISTOLMAG
	set revol_temp 0
	whilevarvarn revol_temp temp4
		{
		shoot SRIFLESHELL
		add revol_temp 1
		}
ends

defstate spawn_lasersite // code by Dan Gaskil
ifp prunning
	{
	getp[].ang angvar
	getp[].horiz zdist
	sub zdist 135

	getp[].weapon_pos temp
	ifl temp 0 mul temp -1
	mul temp 3
	sub zdist temp

	set temp gun_pos
	div temp -2
	sub zdist temp

	set temp weapon_xoffset
	div temp 2
	add angvar temp

	mul zdist -2048
	cos mycos angvar
	sin mysin angvar

    ifn mysector -1
	    hitscan player[].posx player[].posy player[].posz mysector mycos mysin zdist hitsector hitwall hitsprite hitx hity hitz CLIPMASK0
	}
	espawn 3023 // Spawn the laser sight

    seta[RETURN].htbposx hitx
    seta[RETURN].htbposy hity
    seta[RETURN].htbposz hitz
    setsprite RETURN hitx hity hitz
ends

defstate revolver_2_eject
	set temp4 MAXPISTOLMAG
	sub temp4 PISTOLMAG

	set temp5 0
	whilevarvarn temp5 temp4
		{
		eshoot REVOLV_SHELL
		geta[RETURN].ang temp
		add temp 1024
		seta[RETURN].ang temp
		add temp5 1
		}
ends

defstate revolver_silver2_eject
	set temp4 MAXPISTOLMAG
	sub temp4 PISTOLMAG

	set temp5 0
	whilevarvarn temp5 temp4
		{
		shoot SRIFLESHELL
		add temp5 1
		}
ends

defstate SHOTGUN_SHELL // shoots the proper shotgun shell being used
	ife LAST_SHELL_FIRED 1 shoot EXSHELL else
	ife LAST_SHELL_FIRED 4 shoot FL_SHELL else
	ife LAST_SHELL_FIRED 64 shoot MAGN_SHELL else
	ife LAST_SHELL_FIRED 1024 { setprojectile[3761].pal 5 shoot 3761 setprojectile[3761].pal 0 } else
	ife LAST_SHELL_FIRED 2048 { setprojectile[3761].pal 46 shoot 3761 setprojectile[3761].pal 0 } else
	ife LAST_SHELL_FIRED 65536 { setprojectile[3761].pal 27 shoot 3761 setprojectile[3761].pal 0 } else
	shoot 3761
ends

defstate SHOTGUN_SHELL2 // shoots the proper shotgun shell being used out of 2nd barrel
	ife LAST_SHELL_FIRED_2 1 shoot EXSHELL else
	ife LAST_SHELL_FIRED_2 4 shoot FL_SHELL else
	ife LAST_SHELL_FIRED_2 64 shoot MAGN_SHELL else
	ife LAST_SHELL_FIRED_2 1024 { setprojectile[3761].pal 5 shoot 3761 setprojectile[3761].pal 0 } else
	ife LAST_SHELL_FIRED_2 65536 { setprojectile[3761].pal 27 shoot 3761 setprojectile[3761].pal 0 } else
	shoot 3761
ends

defstate GREEN_BOOK_ARTIFACT
ifpdistl 1524
 ifn CHAR -1
 {
	ife ARTIFACTS_LOADOUT[CHAR] 8
		{
		ifl PHEALTH pmax_health
		 ife EXTRASAVED 0
			{
			set artifact_used 60
			addphealth 1
			palfrom 10 0 40 0
			sound LEAF1
			set EXTRASAVED 1
			}
		}
 }
ends

defstate MAKO_RING_ARTIFACT
 ifpdistl 1524
	ife ARTIFACTS_LOADOUT[CHAR] 10
		{
		 ife EXTRASAVED 0
			{
			set artifact_used 60
			ifl P_SPIRIT_ARMOUR 100 { add P_SPIRIT_ARMOUR 15 clamp P_SPIRIT_ARMOUR 0 100 }
			ifl P_FIRE_ARMOUR 100 { add P_FIRE_ARMOUR 15 clamp P_FIRE_ARMOUR 0 100 }

			ifl p_blue_mana max_blue_mana
			{
				add p_blue_mana 15
				clamp p_blue_mana 0 max_blue_mana
			}

			ifl p_green_mana max_green_mana
			{
				add p_green_mana 10
				clamp p_green_mana 0 max_green_mana
			}

			ifl p_orange_mana max_orange_mana
			{
				add p_orange_mana 1
				clamp p_orange_mana 0 max_orange_mana
			}

			ifl p_purple_mana max_purple_mana
			{
				add p_purple_mana 1
				clamp p_purple_mana 0 p_purple_mana
			}

			palfrom 10 0 0 40
			sound GET_MAGIC
			set EXTRASAVED 1
			}
		}
ends

defstate TURNOFF_NVG
ife player[].heat_on 1
	{
	setgamepalette 0
	palfrom 30 0 0 0
	ife CHAR 0 sound JAMES_HEATOFF
	else ife CHAR 3 sound HIGH_HEATOFF
	else ife CHAR 4 sound SHEAT_EYEGLASS
	else ife CHAR 6 sound GEO_HEATOFF
	else ife CHAR 7 sound MIK_HEATOFF
	else ife CHAR 9 sound SHEAT_EYEGLASS
	else ife CHAR 10 sound MIK_HEATOFF
	else ife CHAR 13 sound HIGH_HEATOFF
	else sound NITEVISION_ON
	setp[].heat_on 0
	}
ends

defstate UPPERCUT_STUFF
	ifn MELEE_LOCKED_ON -1
		{
		dist temp2 MELEE_LOCKED_ON THISACTOR
		geta[MELEE_LOCKED_ON].extra temp
		ifl temp 40
		ifl temp2 750
		ifg kickbackpic 0
		 ife UPPER_CUT 20
			{
			state lower_weapon
			setp[].kickback_pic 0
			set UPPER_CUT 0
			}
		}
ends

defstate spawn_cold_breathe
ifand sector[].floorstat 8192 // floor set to cold breathe?
	{
		add actor_breathe_count 1
		ifg actor_breathe_count 50
			{
				ifactor APLAYER
				{
				getp[].horiz temp2
				sub temp2 100
				espawn 10737
				mulvar temp2 8
				setactorvar[RETURN].z temp2
				}
			else
			spawn 10737 randvar actor_breathe_count 5
			}
	}
else
ife weather_type 1
	{
	ifdead nullop else
		{
		add actor_breathe_count 1
		ifoutside ifg actor_breathe_count 50
			{
			ifactor APLAYER
				{
				getp[].horiz temp2
				sub temp2 100
				espawn 10737
				mulvar temp2 8
				setactorvar[RETURN].z temp2
				}
			else
			spawn 10737 randvar actor_breathe_count 5
			}
		ife sector[].ceilingpicnum 179 ifg actor_breathe_count 50
			{
			ifactor APLAYER
				{
				getp[].horiz temp2
				sub temp2 100
				espawn 10737
				mulvar temp2 8
				setactorvar[RETURN].z temp2
				}
			else
			spawn 10737 randvar actor_breathe_count 5
			}
		}
	}
else
ife weather_type 4
	{
	ifdead nullop else
		{
		add actor_breathe_count 1
		ifg actor_breathe_count 50
			{
				ifactor APLAYER
				ife player_using_hovercraft -1
				ife player_using_mech -1
				ife ANGLE 0
				{
				getp[].horiz temp2
				sub temp2 100
				espawn 10737
				mulvar temp2 8
				setactorvar[RETURN].z temp2
				}
			else
			spawn 10737 randvar actor_breathe_count 5
			}
		}
	}
ends

defstate ITEM_BOX_DISP_STUFF
ife disp_temp 21 set disp_temp WEAPON_TILE[1]
ife disp_temp 28 set disp_temp WEAPON_TILE[2]
ife disp_temp 22 set disp_temp WEAPON_TILE[3]
ife disp_temp 23 set disp_temp WEAPON_TILE[4]
ife disp_temp 26 set disp_temp WEAPON_TILE[5]
ife disp_temp 25 set disp_temp WEAPON_TILE[6]
ife disp_temp 29 set disp_temp WEAPON_TILE[7]
ife disp_temp 27 set disp_temp WEAPON_TILE[8]
ife disp_temp 24 set disp_temp WEAPON_TILE[9]
ife disp_temp 40 set disp_temp W_AMMO_TILE[1]
ife disp_temp 49 set disp_temp W_AMMO_TILE[2]
ife disp_temp 41 set disp_temp W_AMMO_TILE[3]
ife disp_temp 44 set disp_temp W_AMMO_TILE[4]
ife disp_temp 47 set disp_temp W_AMMO_TILE[5]
ife disp_temp 46 set disp_temp W_AMMO_TILE[6]
ife disp_temp 42 set disp_temp W_AMMO_TILE[7]
ife disp_temp 37 set disp_temp W_AMMO_TILE[9]
ife disp_temp 45 set disp_temp W_AMMO_TILE[11]
ife disp_temp 54 set disp_temp c_armour
ife disp_temp 53 set disp_temp c_medikit
ife disp_temp 55 set disp_temp c_steroids
ife disp_temp 56 set disp_temp c_scuba
ife disp_temp 57 set disp_temp c_jetpack
ife disp_temp 59 set disp_temp disp_nvg
ife disp_temp 61 set disp_temp c_boots
ife disp_temp 1348 set disp_temp c_holoduke
ends

onevent EVENT_GETSHOTRANGE
ifn using_turret -1
{
set ANGRANGE 32
set ZRANGE 256
}
else
{
set temp7 GUN_ACCURACY
set ANGRANGE GUN_ACCURACY
ifg GUN_MAX_SPREAD 0 add ANGRANGE gun_spread
ifg GUN_MAX_SPREAD 0 add temp7 gun_spread
mulvar temp7 8
set ZRANGE temp7
}
endevent

defstate JMOVESOUND2
  ife MOUSEUP 0
   ife DOCUMENT -1
    ife CHARSELECT 0
	 ife MISSION_UP 0
	{
	ifrnd 64 soundonce JMOVE6 else
	ifrnd 64 soundonce JMOVE7
	}
ends

state spawn_gunsmoke
ife PERFMODE 1
	{
		ifinwater espawn WATERBUBBLE else espawn GUNSMOKE
		geta[].x temp
		geta[].y temp2
		set temp3 temp
		add temp3 128
		geta[].ang temp4
		add temp4 gunsmoke_angle
		randvar temp5 16
		ifrnd 128 add temp4 temp5 else sub temp4 temp5
		rotatepoint temp temp2 temp3 temp2 temp4 temp5 temp6
		seta[RETURN].x temp5
		seta[RETURN].y temp6
		geta[].z temp
		ifactor AUTO_TURRET sub temp 3096 else sub temp 9596
		ifactor APLAYER
			{
			ifn ANGLE 0 sub temp 12896
			getp[].horiz temp2
			sub temp2 100
			mulvar temp2 14
			sub temp temp2
			}
		seta[RETURN].z temp
	}
ends

defstate spawn_gunsmoke_z
ife PERFMODE 1
	{
		ifinwater espawn WATERBUBBLE else espawn GUNSMOKE
		geta[].x temp
		geta[].y temp2
		set temp3 temp
		add temp3 128
		geta[].ang temp4
		add temp4 gunsmoke_angle
		randvar temp5 16
		ifrnd 128 add temp4 temp5 else sub temp4 temp5
		rotatepoint temp temp2 temp3 temp2 temp4 temp5 temp6
		seta[RETURN].x temp5
		seta[RETURN].y temp6
		geta[].z temp
		sub temp gunsmoke_z
		ifactor APLAYER
			{
			ifn ANGLE 0 sub temp 12896
			getp[].horiz temp2
			sub temp2 100
			mulvar temp2 14
			sub temp temp2
			}
		seta[RETURN].z temp
	}
ends

defstate spawn_enemy_ARFLASH
ifrnd 64 espawn 16116
else ifrnd 64 espawn 16117
else ifrnd 64 espawn 16118
else ifrnd 64 espawn 16119
else ifrnd 64 espawn 16120
else espawn 16121
ends

defstate spawn_muzzleflash // spawn the muzzleflash first, then run this state
ife PERFMODE 1
	{
		geta[].x temp
		geta[].y temp2
		set temp3 temp
		add temp3 256
		geta[].ang temp4
		set temp6 gunsmoke_angle
		divvar temp6 2
		ifactor LPOWERSUIT add temp4 256 else
			{
			add temp4 temp6
			randvar temp5 4
			ifrnd 128 add temp4 temp5 else sub temp4 temp5
			}
		rotatepoint temp temp2 temp3 temp2 temp4 temp5 temp6
		seta[RETURN].x temp5
		seta[RETURN].y temp6
		geta[].z temp
		sub temp gunsmoke_z
		ifactor APLAYER
			{
			ifn ANGLE 0 sub temp 12896
			getp[].horiz temp2
			sub temp2 100
			mulvar temp2 14
			sub temp temp2
			}
		seta[RETURN].z temp
	}
ends

defstate gun_pushback
ifinwater nullop else
	{
	ifl sprite[].xvel 40
		{
				ife CHAR 2 ifand CHAR_APP 4 div gun_pushback_power 2
				ife CHAR 3 ifand CHAR_APP 16 div gun_pushback_power 2
				ife CHAR 7 ifand CHAR_APP 8 div gun_pushback_power 2
				getp[].ang knockbackang
				cos xvel knockbackang
				sin yvel knockbackang
				ifp pducking div gun_pushback_power 2
				mulvarvar xvel gun_pushback_power
				mulvarvar yvel gun_pushback_power
				getp[].posxv temp
				add xvel temp
				setp[].posxv xvel
				getp[].posyv temp
				add yvel temp
				setp[].posyv yvel
		}
	}
ends

// HEAVYARMOUR
action JHEAVYSPRITE 0
action RHEAVYSPRITE 762
action SHEAVYSPRITE 1151
action RNHEAVYSPRITE 1631
action GHEAVYSPRITE 1400

defstate quikget
ife camerasprite -1 // Don't play pickup sounds if playing a cutscene
  {
  ifactor COPPER_AMULET { sound GET_POWERUP setactorsoundpitch THISACTOR GET_POWERUP 512 }
  else ifactor SILVER_AMULET { sound GET_POWERUP setactorsoundpitch THISACTOR GET_POWERUP 256 }
  else ifactor GOLD_AMULET sound GET_POWERUP
  else ifactor PLATINUM_AMULET { sound GET_POWERUP setactorsoundpitch THISACTOR GET_POWERUP -256 }
  else ifactor MEGASPHERE globalsound GET_POWERUP
  else ifactor SWORD_RAMPAGE globalsound GET_POWERUP
  else ifactor COOKIE globalsound GET_COOKIE
  else ifactor SHIELD state ARMOURPICKUPSOUNDS
  else ifactor HEAVYARMOUR state ARMOURPICKUPSOUNDS
  // ammo
  else ifactor AMMO { ife CHAR 4 globalsound GET_MAGIC else globalsound AMMO_PICK }
  else ifactor SHOTGUNAMMO { ife CHAR 4 globalsound GET_MAGIC else globalsound AMMO_PICK }
  else ifactor BATTERYAMMO globalsound AMMO_PICK
  else ifactor RPGAMMO { ife CHAR 4 globalsound GET_MAGIC else globalsound BIG_AMMO }
  else ifactor CRYSTALAMMO { ife CHAR 4 globalsound GET_MAGIC else globalsound BIG_AMMO }
  else ifactor HBOMBAMMO globalsound AMMO_PICK
  else ifactor DEVISTATORAMMO { ife CHAR 4 globalsound GET_MAGIC else globalsound BIG_AMMO }
  else ifactor FREEZEAMMO { ife CHAR 4 globalsound GET_MAGIC else globalsound BIG_AMMO }
  else ifactor GROWAMMO { ife CHAR 4 globalsound GET_MAGIC else globalsound BIG_AMMO }
  // special ammo
  else ifactor SILVERAMMO_DRUM { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor SILVER_CROSSBOW_BOLTS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor VOID_CROSSBOW_BOLTS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor EXPL_SHELLS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor FORTYMM_NADES { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor FORTYMM_CASELESS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor FORTYMM_SLUGS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor FORTYMM_ELECTRO { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor FORTYMM_CRYO { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor FORTYMM_SHELLS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor FLECHETE_SHELLS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor TESLA_AMMO_SPRITE { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor MICRO_TORPEDO_PACK { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor MAGNUM_SHELLS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor DRAGONS_SHELLS { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor HEAT_SEEK_CARD_PICKUP { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor ATOMIC_BOMB_PICKUP { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor DUP_MISSILES_PICKUP { globalsound SPECIAL_AMMO set PLAYER_VOICEOVER 23 }
  else ifactor ORANGE_MANA_PICKUP { globalsound GET_MAGIC set PLAYER_VOICEOVER 23 }
  else ifactor GREEN_MANA_PICKUP { globalsound GET_MAGIC set PLAYER_VOICEOVER 23 }
  else ifactor BLUE_MANA_PICKUP { globalsound GET_MAGIC set PLAYER_VOICEOVER 23 }
  else ifactor PURPLE_MANA_PICKUP { globalsound GET_MAGIC set PLAYER_VOICEOVER 23 }
  // keys
  else ifactor FLAMEKEY globalsound GET_OLD_KEY
  else ifactor SPIDERKEY globalsound GET_OLD_KEY
  else ifactor DAGGERKEY globalsound GET_OLD_KEY
  else ifactor MOONKEY globalsound GET_OLD_KEY
  else ifactor SKULLKEY globalsound GET_OLD_KEY
  else ifactor EYEKEY globalsound GET_OLD_KEY
  else ifactor GENERICKEY globalsound GET_GEN_KEY
  else ifactor DIAMOND_KEY globalsound GET_GEN_KEY
  else ifactor CLUB_KEY globalsound GET_GEN_KEY
  else ifactor SPADE_KEY globalsound GET_GEN_KEY
  else ifactor HEART_KEY globalsound GET_GEN_KEY
  else ifactor NORMAL_KEY5 globalsound GET_GEN_KEY
  else ifactor KEY_CARD globalsound GET_KEYCARD
  else ifactor ACCESSCARD2 globalsound GET_KEYCARD
  else ifactor SW_TECHCARD globalsound GET_KEYCARD
  else ifactor RUNEKEY globalsound GET_KEYCARD
  else ifactor BLUEPLUG globalsound GET_KEYCARD
  else ifactor REDPLUG globalsound GET_KEYCARD
  else ifactor YELLOWPLUG globalsound GET_KEYCARD
  else ifactor SW_OLDKEY globalsound GET_SW_KEY
  else ifactor ABYSS_KEY globalsound GET_OLD_KEY
  else ifactor SCARABKEY globalsound SCARAB_KEY
  else ifactor FIRE_ARMOUR globalsound BARMOUR_PICK
  else ifactor SPIRIT_ARMOUR globalsound BARMOUR_PICK
  else ifactor SUPER_ARMOUR globalsound BARMOUR_PICK
  // quest items
  else ifactor BLOODCHALICE globalsound QUEST_ITEM
  else ifactor SOULBOX globalsound QUEST_ITEM
  else ifactor SKULLCROWN globalsound QUEST_ITEM
  else ifactor DARKBOOK globalsound QUEST_ITEM
  else ifactor BROKENTORCH globalsound QUEST_ITEM
  else ifactor 3349 globalsound QUEST_ITEM
  else ifactor 25499 globalsound QUEST_ITEM
  else ifactor 17031 globalsound QUEST_ITEM
  // generic items
  else ife CHAR 0 globalsound JGETITEM
  else ife CHAR 2 globalsound MGETITEM
  else ife CHAR 3 globalsound RGETITEM
  else ife CHAR 4 globalsound SGETITEM
  else ife CHAR 5 globalsound RNGETITEM
  else ife CHAR 6 globalsound GGETITEM
  else ife CHAR 7 globalsound MSGETITEM
  else ife CHAR 9 globalsound SGETITEM
  else ife CHAR 10 globalsound RGETITEM
  else ife CHAR 11 globalsound MGETITEM
  else ife CHAR 12 globalsound JGETITEM
  else ife CHAR 13 globalsound MC_GETITEM
  else ife CHAR 14 globalsound SF_GETITEM
  else ife CHAR 15 globalsound MC_GETITEM
  else ife CHAR 17 globalsound KG_GETITEM
  else globalsound ZAX_GET

  ifactor MEGASPHERE palfrom 60 0 60 0
  ifactor COPPER_AMULET palfrom 10 0 50 0
  ifactor SILVER_AMULET palfrom 20 0 50 0
  ifactor GOLD_AMULET palfrom 30 0 50 0
  ifactor PLATINUM_AMULET palfrom 40 0 50 0
  }
  killit
ends

defstate getcode
  ifrespawn
  {
  ifspawnedby 10570 killit
    move RESPAWN_ACTOR_FLAG
	ife camerasprite -1  // Don't play pickup sounds if playing a cutscene
		{
		ife CHAR 0 globalsound JGETITEM
		  else ife CHAR 1 globalsound ZAX_GET
		  else ife CHAR 2 globalsound MGETITEM
		  else ife CHAR 3 globalsound RGETITEM
		  else ife CHAR 4 globalsound SGETITEM
		  else ife CHAR 5 globalsound RNGETITEM
		  else ife CHAR 6 globalsound GGETITEM
		  else ife CHAR 7 globalsound MSGETITEM
		  else ife CHAR 9 globalsound SGETITEM
		  else ife CHAR 10 globalsound RGETITEM
		  else ife CHAR 11 globalsound MGETITEM
		  else ife CHAR 12 globalsound JGETITEM
		  else ife CHAR 13 globalsound MC_GETITEM
		  else ife CHAR 14 globalsound SF_GETITEM
		  else ife CHAR 15 globalsound MC_GETITEM
		  else ife CHAR 17 globalsound KG_GETITEM
		}
    cstat 32768
  }
  else
    state quikget
ends


defstate respawnit
  ifcount RESPAWNITEMTIME
  {
    spawn TRANSPORTERSTAR
    move 0
    cstat 0
    sound RESPAWN_SOUND
  }
ends

defstate quikweaponget
ife cur_weap 0 state lower_weapon
ife camerasprite -1 // Don't play pickup sounds if playing a cutscene
ife cuts_txt -1
ife PLAYER_VOICEOVER 0
{
  ifactor SWORDSPRITE globalsound DRAW_SWORD2 else
  ifactor MOPSPRITE globalsound WOOD_IMPACT else
  ifactor BLOODY_MOPSPRITE globalsound WOOD_IMPACT else
  globalsound GET_GUN
  ifactor CHAINSAWSPRITE
   ife CHAR 9
    {
		ife gp_subt 0
			{
			qputs 7500 ^54???:  ^0Time to shake hands with the great communicator!
			set gp_subt 95
			}
		screensound C_CHAINS1
	}
  ifactor CHAINGUNSPRITE
	{
	ife CHAR 13
		ifrnd 196
		{
		ife gp_subt 0
			{
			qputs 7500 ^8Micky:  ^0Time to make Swiss cheese.
			set gp_subt 60
			}
		screensound MC_SWISS
		}
	}
  ifactor FREEZESPRITE
	{
	ife CHAR 13 ifrnd 196
		{
		ife gp_subt 0
			{
			qputs 7500 ^8Micky:  ^0let's go throw a shrimp on the barby.
			set gp_subt 60
			}
		screensound MC_BARBY
		}
	}
   ifactor SHRINKERSPRITE
   {
   ife CHAR 13 ifrnd 196
	{
		ife gp_subt 0
			{
			qputs 7500 ^8Micky:  ^0Time for a field test.
			set gp_subt 60
			}
	screensound MC_FIELDTEST
	}
   }
  ifspawnedby APLAYER nullop else ife gp_subt 0 state randgetweapsnds
}
  ifgotweaponce 1
    break
  ifmove RESPAWN_ACTOR_FLAG break
  ifrespawn
  {
    ifspawnedby 10570 killit
  ifspawnedby APLAYER killit
    move RESPAWN_ACTOR_FLAG
    cstat 32768
  }
  else
  killit
ends

var weapon_voices 0 1

defstate getweaponcode
ife camerasprite -1 // Don't play pickup sounds if playing a cutscene
ifle cuts_txt 0
	{
	  ifactor SWORDSPRITE globalsound DRAW_SWORD2 else
	  ifactor MOPSPRITE globalsound WOOD_IMPACT else
	  ifactor BLOODY_MOPSPRITE globalsound WOOD_IMPACT else
	  ifactor FIRSTGUNSPRITE
		{
		globalsoundvar wep_get_sound[1]
		ifand weapon_voices 1 nullop else
			{
			ife voice_cooldown 0 state randgetweapsnds
			xor weapon_voices 1
			}
		}
		else
	  ifactor SHOTGUNSPRITE
		{
		globalsoundvar wep_get_sound[2]
		ifand weapon_voices 2 nullop else
			{
			ife voice_cooldown 0 state randgetweapsnds
			xor weapon_voices 2
			}
		}
		else
	  ifactor CHAINGUNSPRITE
		{
		globalsoundvar wep_get_sound[3]
		ifand weapon_voices 4 nullop else
			{
			ife voice_cooldown 0 state randgetweapsnds
			xor weapon_voices 4
			}
		}
		else
	  ifactor RPGSPRITE
		{
		globalsoundvar wep_get_sound[4]
		ifand weapon_voices 8 nullop else
			{
			ife voice_cooldown 0 state randgetweapsnds
			xor weapon_voices 8
			}
		}
		else
	  ifactor SHRINKERSPRITE
		{
		globalsoundvar wep_get_sound[6]
		ifand weapon_voices 16 nullop else
			{
			ife voice_cooldown 0 state randgetweapsnds
			xor weapon_voices 16
			}
		}
		else
	  ifactor DEVISTATORSPRITE
		{
		globalsoundvar wep_get_sound[7]
		ifand weapon_voices 32 nullop else
			{
			ife voice_cooldown 0 state randgetweapsnds
			xor weapon_voices 32
			}
		}
		else
	  ifactor FREEZESPRITE
		{
		globalsoundvar wep_get_sound[9]
		ifand weapon_voices 64 nullop else
			{
			ife voice_cooldown 0 state randgetweapsnds
			xor weapon_voices 64
			}
		}
		else
		  {
		  ifspawnedby APLAYER nullop else state randgetweapsnds
		  globalsound GET_GUN
		  }

    ife PLAYER_VOICEOVER 0
	 ife CHAR 13
	  ife voice_cooldown 0
		  {
		  ifactor CHAINGUNSPRITE
				{
					ifrnd 196
					{
					ife gp_subt 0
						{
						qputs 7500 ^8Micky:  ^0Time to make Swiss cheese.
						set gp_subt 60
						}
					screensound MC_SWISS
					}
				}
		  ifactor FREEZESPRITE
				{
				ifrnd 196
					{
					ife gp_subt 0
						{
						qputs 7500 ^8Micky:  ^0Let's go throw a shrimp on the barby.
						set gp_subt 60
						}
					screensound MC_BARBY
					}
				}
	   ifactor SHRINKERSPRITE
			   {
			   ifrnd 196
					{
						ife gp_subt 0
							{
							qputs 7500 ^8Micky:  ^0Time for a field test.
							set gp_subt 60
							}
					screensound MC_FIELDTEST
					}
			   }
		}
  }
  ifmove RESPAWN_ACTOR_FLAG break
  ifrespawn
  {
    ifspawnedby 10570 killit
  ifspawnedby APLAYER killit
    move RESPAWN_ACTOR_FLAG
    cstat 32768
  }
  else
  killit
ends

defstate checkenemybloodpools
ifactor CULTIST spawn 7991
else ifactor NEWBEAST spawn 4679
else spawn BLOODPOOL
ends

defstate trigger_showoff
ife camerasprite -1
 ife sprite[].htowner PLAYER_IDENTITY
  ife cuts_txt -1
	{
	palfrom 32 32 32 32
	set SLO_MO_SHOWOFF 40
	screensound START_SLOW
	spawn FRAMEEFFECT1
	}
ends

defstate random_trigger_showoff
    switch opt_slomo_frequency
    case 0
        // never trigger slomo
        break
    case 1
        // 8 / 256 chance == 3.1%
        ifrnd 7 state trigger_showoff
        break
    case 2
        // 16 / 256 chance == 6.25%
        ifrnd 15 state trigger_showoff
        break
    case 3
        // 24 / 256 chance == 9.4%
        ifrnd 23 state trigger_showoff
        break
    case 4
    default
        // 32 / 256 chance == 12.5%
        ifrnd 31 state trigger_showoff
        break
    case 5
        // 40 / 256 chance == 15.6%
        ifrnd 39 state trigger_showoff
        break
    case 6
        // 48 / 256 chance == 18.75%
        ifrnd 47 state trigger_showoff
        break
    case 7
        // 64 / 256 chance == 25%
        ifrnd 63 state trigger_showoff
        break
    case 8
        // 128 / 256 chance == 50%
        ifrnd 127 state trigger_showoff
        break
    endswitch
ends

defstate standard_jibs
	set HEADSHOT 0
	ifactor NEWBEAST spritepal 6

	guts JIBS2 1
	ifactor LIZTROOP nullop else guts JIBS3 2
	guts JIBS1 2
	guts JIBS4 3
	guts JIBS5 2
	guts JIBS6 3

	ifactor SORCERER nullop
	else
	{
		shoot NJIB
		shoot NJIB
	}

	ifrnd 96 state checkenemybloodpools
    // 50% reduced chance
    ifrnd 128 ifcansee ife SLO_MO_SHOWOFF 0 state random_trigger_showoff
    ife fake_shrunk 1 set force_taunt 13 else state jib_sounds
ends



defstate DISP_nvg
ife HELMET_LOADOUT[CHAR] 4 set disp_nvg GHOST_GOGGLES else
ife HEAT_GOGGLES 1 set disp_nvg c_nvg_heat else
set disp_nvg c_nvg_normal
ends

defstate mind_shield_state
ife mindshield_cooldown 0
 ife CHARSELECT 0
	{
	ife INTERNALCOUNT 0
		{
		ife MYSTICAL_RESEARCH[3] 2
			ifl P_SPIRIT_ARMOUR 20
				{
				ife camerasprite -1 palfrom 10 0 0 10
				add P_SPIRIT_ARMOUR 4
				set INTERNALCOUNT 52
				}
		else
		ife MYSTICAL_RESEARCH[2] 2
			ifl P_SPIRIT_ARMOUR 15
				{
				ife camerasprite -1 palfrom 10 0 0 10
				add P_SPIRIT_ARMOUR 3
				set INTERNALCOUNT 52
				}
		else
		ife MYSTICAL_RESEARCH[1] 2
			ifl P_SPIRIT_ARMOUR 10
				{
				ife camerasprite -1 palfrom 10 0 0 10
				add P_SPIRIT_ARMOUR 2
				set INTERNALCOUNT 52
				}
		}
	}
ends

defstate check_cased_grenades_avail
	ife gl_countd 43
		{
		 ifand AMMO_TYPES[cur_weap] 32
		 {
		  ife fortymm_shells 0
			{
			ifand AMMO_TYPE 32 xorvar AMMO_TYPE 32 setarray AMMO_TYPES[cur_weap] AMMO_TYPE
			set gl_countd 0
			state lower_weapon
			xorvar gun_firemode 32768
			}
		  }
		else
		 ifand AMMO_TYPES[cur_weap] 128
		 {
		  ife fortymm_MIA_shells 0
			{
			ifand AMMO_TYPE 128 xorvar AMMO_TYPE 128 setarray AMMO_TYPES[cur_weap] AMMO_TYPE
			set gl_countd 0
			state lower_weapon
			xorvar gun_firemode 32768
			}
		 }
		else
		 ifand AMMO_TYPES[cur_weap] 256
		 {
		  ife fortymm_plasma 0
			{
			ifand AMMO_TYPE 256 xorvar AMMO_TYPE 256 setarray AMMO_TYPES[cur_weap] AMMO_TYPE
			set gl_countd 0
			state lower_weapon
			xorvar gun_firemode 32768
			}
		 }
		else
		ife fortymm_grenades 0
			{
			set gl_countd 0
			state lower_weapon
			xorvar gun_firemode 32768
			}
		}
ends

defstate shoot_empty_40mmshell
	ifand AMMO_TYPES[cur_weap] 128
	{ setprojectile[13531].pal 7 eshoot 13531 setprojectile[13531].pal 0 }
	else
	ifand AMMO_TYPES[cur_weap] 256
	{ setprojectile[13531].pal 2 eshoot 13531 setprojectile[13531].pal 0 }
	else
	ifand AMMO_TYPES[cur_weap] 32
	{ setprojectile[13531].pal 25 eshoot 13531 setprojectile[13531].pal 0 }
	else
	eshoot 13531
ends

defstate check_caseless_grenades_avail
	ife gl_countd 43
		{
		ifand AMMO_TYPES[cur_weap] 512
			{
			  ife fortymm_slug 0
				{
				xorvar AMMO_TYPE 512 setarray AMMO_TYPES[cur_weap] AMMO_TYPE
				set gl_countd 0
				state lower_weapon
				xorvar gun_firemode 32768
				}
			}
		else
		ifand AMMO_TYPES[cur_weap] 2048
			{
			  ife fortymm_electro 0
				{
				xorvar AMMO_TYPE 2048 setarray AMMO_TYPES[cur_weap] AMMO_TYPE
				set gl_countd 0
				state lower_weapon
				xorvar gun_firemode 32768
				}
			}
		else
		ifand AMMO_TYPES[cur_weap] 4096
			{
			  ife fortymm_cryo 0
				{
				xorvar AMMO_TYPE 4096 setarray AMMO_TYPES[cur_weap] AMMO_TYPE
				set gl_countd 0
				state lower_weapon
				xorvar gun_firemode 32768
				}
			}
		else
		ife fortymm_caseless 0
			{
			set gl_countd 0
			state lower_weapon
			xorvar gun_firemode 32768
			}
		}
ends



// =======================================================================Animations

action BOAT_USE 9810 1 5 1 10
action FIGHTER_USE 13937 1 1 1 10
action HOVERTANK_USE 20192 1 1 1 10
action VR_TANK_USE 21028 1 1 1 10
action SUBMARINE_USE 27832 1 1 1 10

action PMECH_IDLE 10499 1 1 1 10

action PEXPLODE   106   5   1   1   10
action PEXPLODEAD   113   1   1

// Cassandra

action CSTAND 16520 1 5 1 1
action CGROW 16520 1 5 1 1
action CWALK 16525 4 5 1 16
action CJPHOUVER  16520   1   5   1
action CRUN 16525 4 5 1 10
action CJUMPING 16525 4 5 1 30
action CFALLING   16525   1   5
action CDUCKING   16545   1   5
action CCRAWLING  16545   4   5   1   20
action CAKICKING  16525   2   5   1   25
action CFLINTCHING  16525  1   1   1   10
action CTHROWNBACK  16525  5   1   1   18
action CFROZEN     16525  1   5
action CLYINGDEAD   16525  1   1
action CSWIMMINGO   16525   1   5   1   10
action CSWIMMING   16525   4   5   1   13
action CSWIMMINGWAIT 16525   1   5   1   13
action CTREDWATER  16525   2   5   1   17

// Civilian

action CIV_ASTAND 14194 1 5 1 0
action CIV_AWALK 13995 4 5 1 16
action CIV_ARUN 13995 4 5 1 10

// ENVIRO_SUIT

action ES_STAND 12313 1 5 1 1
action ES_GROWING 12318 1 5 1 1
action ES_WALK 12318 4 5 1 16
action ES_RUN 12318 4 5 1 10
action ES_JPHOUVER  12318   1   5   1
action ES_JUMPING 12318 4 5 1 30
action ES_FALLING   12318   1   5
action ES_DUCKING   12338   1   5
action ES_CRAWLING  12338   2   5   1   20
action ES_AKICKING  12318   2   5   1   25
action ES_FLINTCHING  12348  1   1   1   10
action ES_THROWNBACK  12348  5   1   1   18
action ES_FROZEN     12318  1   5
action ES_LYINGDEAD   12352  1   1
action ES_SWIMMINGGO   12318   1   5   1   10
action ES_SWIMMING   12318   4   5   1   13
action ES_SWIMMINGWAIT 12318   1   5   1   13
action ES_TREDWATER  12318   2   5   1   17

// JUGGERNAUT SUIT

action JG_STAND 22537 1 5 1 1
action JG_FIRE 22537 2 5 1 1
action JG_GROWING 22547 1 5 1 1
action JG_WALK 22517 4 5 1 24
action JG_RUN 22517 4 5 1 20
action JG_JPHOUVER  22517   1   5   1
action JG_JUMPING 22517 4 5 1 30
action JG_FALLING   22517   1   5
action JG_DUCKING   22517   1   5
action JG_CRAWLING  22517   2   5   1   20
action JG_AKICKING  22517   2   5   1   25
action JG_FLINTCHING  22547  1   1   1   10
action JG_THROWNBACK  22547  5   1   1   18
action JG_FROZEN     22547  1   5
action JG_LYINGDEAD   22551  1   1
action JG_SWIMMINGGO   22517   1   5   1   10
action JG_SWIMMING   22517   4   5   1   13
action JG_SWIMMINGWAIT 22517   1   5   1   13
action JG_TREDWATER  22517   2   5   1   17

// SPACESUIT

action SS_STAND 21640 1 5 1 1
action SS_GROWING 21640 1 5 1 1
action SS_WALK 21645 4 5 1 16
action SS_RUN 21645 4 5 1 10
action SS_JPHOUVER  21665   1   5   1
action SS_JUMPING 21665 1 5 1 30
action SS_FALLING   21665   1   5
action SS_DUCKING   21670   1   5
action SS_CRAWLING  21688   2   5   1   20
action SS_AKICKING  21640   2   5   1   25
action SS_FLINTCHING  21640  1   1   1   10
action SS_THROWNBACK  21675  5   1   1   18
action SS_FROZEN     21640  1   5
action SS_LYINGDEAD   21679  1   1
action SS_SWIMMINGGO   21645   1   5   1   10
action SS_SWIMMING   21645   4   5   1   13
action SS_SWIMMINGWAIT 21645   1   5   1   13
action SS_TREDWATER  21645   2   5   1   17

defstate check_civ_standard
  ifp pwalking
    action CIV_AWALK
  else
    ifp pkicking
      action CIV_AWALK
  else
    ifp prunning
      action CIV_ARUN
  else
    ifp pjumping
      action CIV_ARUN
  else
    ifp pducking
      action CIV_AWALK
ends

defstate CIVILIAN_ANIMS

ifaction 0 ife CHARSELECT 0 action CIV_ASTAND

    ifaction CIV_ASTAND
      state check_civ_standard
  else
    ifaction CIV_AWALK
  {
      ifp pstanding
        action CIV_ASTAND
    else
      ifp prunning
        action CIV_ARUN
  }

  else
    ifaction CIV_ARUN
  {
    ifp pstanding
       action CIV_ASTAND
    else
      ifp pwalking
        action CIV_AWALK
  }
  ends

// **************************************CASSANDRA ANIMS******************************************************

defstate check_cstandard
  ifp pwalking
    action CWALK
  else
    ifp pkicking
	 ife camerasprite -1
      action CAKICKING
  else
    ifp prunning
      action CRUN
  else
    ifp pjumping
      action CJUMPING
  else
    ifp pducking
	 ife camerasprite -1
      action CDUCKING
ends

defstate CASSANDRA_ANIMS

ifaction 0 ife CHARSELECT 0 { action CSTAND }

  ifaction CFLINTCHING
  {
    ifactioncount 2
      action CSTAND
    break
  }

  ifinwater
  {
    ifaction CTREDWATER
    {
      ifp pwalking prunning
        action CSWIMMINGO
    }
    else
      ifp pstanding pwalkingback prunningback
        action CTREDWATER
    else
    {
      ifaction CSWIMMING
      {
        ifrnd 4
          spawn WATERBUBBLE
        ifactioncount 4
          action CSWIMMINGWAIT
      }
      else
        ifaction CSWIMMINGWAIT
      {
        ifactioncount 2
          action CSWIMMINGO
      }
      else
        ifaction CSWIMMINGO
      {
        ifactioncount 2
          action CSWIMMING
      }
      else
        action CTREDWATER
    }

    ifrnd 4
      spawn WATERBUBBLE // For effect

    break
  }
  else ifp pjetpack
  {
    ifaction CJPHOUVER
    {
      ifactioncount 4
        resetactioncount
    }
    else
      action CJPHOUVER
    break
  }
  else
  {
    ifaction CTREDWATER
      action CSTAND
    ifaction CSWIMMING
      action CSTAND
    ifaction CSWIMMINGWAIT
      action CSTAND
    ifaction CSWIMMINGO
      action CSTAND
    ifaction CJPHOUVER
      action CFALLING
  }

  ifaction CFALLING
  {
    ifp ponground
      { action CSTAND state landsounds }
    else
    {
      ifp pfalling
        break
      else
        state check_cstandard
    }
  }

  ifaction CDUCKING
  {
    ifgapzl 48
    {
      ifp pwalking pwalkingback prunning prunningback
        action CCRAWLING
    }
    else ifp pducking
    {
      ifp pwalking pwalkingback prunning prunningback
        action CCRAWLING
    }
    else
    {
      ifp pstanding
         action CSTAND
      else
        state check_cstandard
    }
  }

  else ifaction CCRAWLING
  {
    ifgapzl 48
    {
      ifp pstanding
        action CCRAWLING
    }
    else
      ifp pducking
    {
      ifp pstanding
        action CDUCKING
    }
    else
    {
      ifp pstanding
       action CSTAND
      else
        state check_cstandard
    }
  }
  else
    ifgapzl 48
      action CDUCKING

  else
    ifaction CJUMPING
  {
    ifp ponground
       action CSTAND
    else
      ifactioncount 4
        ifp pfalling
          action CFALLING
  }

  ifp pfalling
    action CFALLING
  else
    ifaction CSTAND
      state check_cstandard
  else
    ifaction CAKICKING
  {
    ifactioncount 2
      action CSTAND
    break
  }
  else
    ifaction CWALK
  {
    ifp pfalling
      action CFALLING
    else
      ifp pstanding
        action CSTAND
    else
      ifp prunning
        action CRUN
    else
      ifp pjumping
        action CJUMPING
    else
      ifp pducking
        action CDUCKING
  }

  else
    ifaction CRUN
  {
    ifp pstanding
       action CSTAND
    else
      ifp pwalking
        action CWALK
    else
      ifp pjumping
        action CJUMPING
    else
      ifp pducking
        action CDUCKING
  }
ends

// ************************************** ENVIROSUIT ANIMS******************************************************

defstate check_ES_standard
  ifp pwalking
    action ES_WALK
  else
    ifp pkicking
	 ife camerasprite -1
      action ES_AKICKING
  else
    ifp prunning
      action ES_RUN
  else
    ifp pjumping
      action ES_JUMPING
  else
    ifp pducking
	 ife camerasprite -1
      action ES_DUCKING
ends

defstate ENVIRO_SUIT_ANIMS
  ifaction ES_FLINTCHING
  {
    ifactioncount 2
      action ES_STAND
    break
  }

  ifinwater
  {
    ifaction ES_TREDWATER
    {
      ifp pwalking prunning
        action ES_SWIMMINGGO
    }
    else
      ifp pstanding pwalkingback prunningback
        action ES_TREDWATER
    else
    {
      ifaction ES_SWIMMING
      {
        ifrnd 4
          spawn WATERBUBBLE
        ifactioncount 4
          action ES_SWIMMINGWAIT
      }
      else
        ifaction ES_SWIMMINGWAIT
      {
        ifactioncount 2
          action ES_SWIMMINGGO
      }
      else
        ifaction ES_SWIMMINGGO
      {
        ifactioncount 2
          action ES_SWIMMING
      }
      else
        action ES_TREDWATER
    }

    ifrnd 4
      spawn WATERBUBBLE // For effect

    break
  }
  else ifp pjetpack
  {
    ifaction ES_JPHOUVER
    {
      ifactioncount 4
        resetactioncount
    }
    else
      action ES_JPHOUVER
    break
  }
  else
  {
    ifaction ES_TREDWATER
      action ES_STAND
    ifaction ES_SWIMMING
      action ES_STAND
    ifaction ES_SWIMMINGWAIT
      action ES_STAND
    ifaction ES_SWIMMINGGO
      action ES_STAND
    ifaction ES_JPHOUVER
      action ES_FALLING
  }

  ifaction ES_FALLING
  {
    ifp ponground
      { action ES_STAND state landsounds }
    else
    {
      ifp pfalling
        break
      else
        state check_ES_standard
    }
  }

  ifaction ES_DUCKING
  {
    ifgapzl 48
    {
      ifp pwalking pwalkingback prunning prunningback
        action ES_CRAWLING
    }
    else ifp pducking
    {
      ifp pwalking pwalkingback prunning prunningback
        action ES_CRAWLING
    }
    else
    {
      ifp pstanding
         action ES_STAND
      else
        state check_ES_standard
    }
  }

  else ifaction ES_CRAWLING
  {
    ifgapzl 48
    {
      ifp pstanding
        action ES_CRAWLING
    }
    else
      ifp pducking
    {
      ifp pstanding
        action ES_DUCKING
    }
    else
    {
      ifp pstanding
       action ES_STAND
      else
        state check_ES_standard
    }
  }
  else
    ifgapzl 48
      action ES_DUCKING

  else
    ifaction ES_JUMPING
  {
    ifp ponground
       action ES_STAND
    else
      ifactioncount 4
        ifp pfalling
          action ES_FALLING
  }

  ifp pfalling
    action ES_FALLING
  else
    ifaction ES_STAND
      state check_ES_standard
  else
    ifaction ES_AKICKING
  {
    ifactioncount 2
      action ES_STAND
    break
  }
  else
    ifaction ES_WALK
  {
    ifp pfalling
      action ES_FALLING
    else
      ifp pstanding
        action ES_STAND
    else
      ifp prunning
        action ES_RUN
    else
      ifp pjumping
        action ES_JUMPING
    else
      ifp pducking
        action ES_DUCKING
  }

  else
    ifaction ES_RUN
  {
    ifp pstanding
       action ES_STAND
    else
      ifp pwalking
        action ES_WALK
    else
      ifp pjumping
        action ES_JUMPING
    else
      ifp pducking
        action ES_DUCKING
  }
  ends

  // ************************************** JUGGERNAUT SUIT ANIMS******************************************************

defstate check_JG_standard
  ifp pwalking
    action JG_WALK
  else
    ifp pkicking
	 ife camerasprite -1
      action JG_AKICKING
  else
    ifp prunning
      action JG_RUN
  else
    ifp pjumping
      action JG_JUMPING
  else
    ifp pducking
	 ife camerasprite -1
      action JG_DUCKING
ends

defstate JUGGERN_SUIT_ANIMS

ife kickbackpic 1 ifp pstanding {  ifaction JG_FIRE nullop else action JG_FIRE }

ifaction JG_FIRE
{
 ifactioncount 2
 ife kickbackpic 0
  action JG_STAND
   break
}


  ifaction JG_FLINTCHING
  {
    ifactioncount 2
      action JG_STAND
    break
  }

  ifinwater
  {
    ifaction JG_TREDWATER
    {
      ifp pwalking prunning
        action JG_SWIMMINGGO
    }
    else
      ifp pstanding pwalkingback prunningback
        action JG_TREDWATER
    else
    {
      ifaction JG_SWIMMING
      {
        ifrnd 4
          spawn WATERBUBBLE
        ifactioncount 4
          action JG_SWIMMINGWAIT
      }
      else
        ifaction JG_SWIMMINGWAIT
      {
        ifactioncount 2
          action JG_SWIMMINGGO
      }
      else
        ifaction JG_SWIMMINGGO
      {
        ifactioncount 2
          action JG_SWIMMING
      }
      else
        action JG_TREDWATER
    }

    ifrnd 4
      spawn WATERBUBBLE // For effect

    break
  }
  else ifp pjetpack
  {
    ifaction JG_JPHOUVER
    {
      ifactioncount 4
        resetactioncount
    }
    else
      action JG_JPHOUVER
    break
  }
  else
  {
    ifaction JG_TREDWATER
      action JG_STAND
    ifaction JG_SWIMMING
      action JG_STAND
    ifaction JG_SWIMMINGWAIT
      action JG_STAND
    ifaction JG_SWIMMINGGO
      action JG_STAND
    ifaction JG_JPHOUVER
      action JG_FALLING
  }

  ifaction JG_FALLING
  {
    ifp ponground
      { action JG_STAND state landsounds }
    else
    {
      ifp pfalling
        break
      else
        state check_JG_standard
    }
  }

  ifaction JG_DUCKING
  {
    ifgapzl 48
    {
      ifp pwalking pwalkingback prunning prunningback
        action JG_CRAWLING
    }
    else ifp pducking
    {
      ifp pwalking pwalkingback prunning prunningback
        action JG_CRAWLING
    }
    else
    {
      ifp pstanding
         action JG_STAND
      else
        state check_JG_standard
    }
  }

  else ifaction JG_CRAWLING
  {
    ifgapzl 48
    {
      ifp pstanding
        action JG_CRAWLING
    }
    else
      ifp pducking
    {
      ifp pstanding
        action JG_DUCKING
    }
    else
    {
      ifp pstanding
       action JG_STAND
      else
        state check_JG_standard
    }
  }
  else
    ifgapzl 48
      action JG_DUCKING

  else
    ifaction JG_JUMPING
  {
    ifp ponground
       action JG_STAND
    else
      ifactioncount 4
        ifp pfalling
          action JG_FALLING
  }

  ifp pfalling
    action JG_FALLING
  else
    ifaction JG_STAND
      state check_JG_standard
  else
    ifaction JG_AKICKING
  {
    ifactioncount 2
      action JG_STAND
    break
  }
  else
    ifaction JG_WALK
  {
    ifp pfalling
      action JG_FALLING
    else
      ifp pstanding
        action JG_STAND
    else
      ifp prunning
        action JG_RUN
    else
      ifp pjumping
        action JG_JUMPING
    else
      ifp pducking
        action JG_DUCKING
  }

  else
    ifaction JG_RUN
  {
    ifp pstanding
       action JG_STAND
    else
      ifp pwalking
        action JG_WALK
    else
      ifp pjumping
        action JG_JUMPING
    else
      ifp pducking
        action JG_DUCKING
  }
  ends

 // ************************************** SPACESUIT ANIMS******************************************************

defstate check_SS_standard
  ifp pwalking
    action SS_WALK
  else
    ifp pkicking
	 ife camerasprite -1
      action SS_AKICKING
  else
    ifp prunning
      action SS_RUN
  else
    ifp pjumping
      action SS_JUMPING
  else
    ifp pducking
	 ife camerasprite -1
      action SS_DUCKING
ends

defstate SPACE_SUIT_ANIMS

  ifaction SS_FLINTCHING
  {
    ifactioncount 2
      action SS_STAND
    break
  }

  ifinwater
  {
    ifaction SS_TREDWATER
    {
      ifp pwalking prunning
        action SS_SWIMMINGGO
    }
    else
      ifp pstanding pwalkingback prunningback
        action SS_TREDWATER
    else
    {
      ifaction SS_SWIMMING
      {
        ifrnd 4
          spawn WATERBUBBLE
        ifactioncount 4
          action SS_SWIMMINGWAIT
      }
      else
        ifaction SS_SWIMMINGWAIT
      {
        ifactioncount 2
          action SS_SWIMMINGGO
      }
      else
        ifaction SS_SWIMMINGGO
      {
        ifactioncount 2
          action SS_SWIMMING
      }
      else
        action SS_TREDWATER
    }

    ifrnd 4
      spawn WATERBUBBLE // For effect

    break
  }
  else ifp pjetpack
  {
    ifaction SS_JPHOUVER
    {
      ifactioncount 4
        resetactioncount
    }
    else
      action SS_JPHOUVER
    break
  }
  else
  {
    ifaction SS_TREDWATER
      action SS_STAND
    ifaction SS_SWIMMING
      action SS_STAND
    ifaction SS_SWIMMINGWAIT
      action SS_STAND
    ifaction SS_SWIMMINGGO
      action SS_STAND
    ifaction SS_JPHOUVER
      action SS_FALLING
  }

  ifaction SS_FALLING
  {
    ifp ponground
      { action SS_STAND state landsounds }
    else
    {
      ifp pfalling
        break
      else
        state check_SS_standard
    }
  }

  ifaction SS_DUCKING
  {
    ifgapzl 48
    {
      ifp pwalking pwalkingback prunning prunningback
        action SS_CRAWLING
    }
    else ifp pducking
    {
      ifp pwalking pwalkingback prunning prunningback
        action SS_CRAWLING
    }
    else
    {
      ifp pstanding
         action SS_STAND
      else
        state check_SS_standard
    }
  }

  else ifaction SS_CRAWLING
  {
    ifgapzl 48
    {
      ifp pstanding
        action SS_CRAWLING
    }
    else
      ifp pducking
    {
      ifp pstanding
        action SS_DUCKING
    }
    else
    {
      ifp pstanding
       action SS_STAND
      else
        state check_SS_standard
    }
  }
  else
    ifgapzl 48
      action SS_DUCKING

  else
    ifaction SS_JUMPING
  {
    ifp ponground
       action SS_STAND
    else
      ifactioncount 4
        ifp pfalling
          action SS_FALLING
  }

  ifp pfalling
    action SS_FALLING
  else
    ifaction SS_STAND
      state check_SS_standard
  else
    ifaction SS_AKICKING
  {
    ifactioncount 2
      action SS_STAND
    break
  }
  else
    ifaction SS_WALK
  {
    ifp pfalling
      action SS_FALLING
    else
      ifp pstanding
        action SS_STAND
    else
      ifp prunning
        action SS_RUN
    else
      ifp pjumping
        action SS_JUMPING
    else
      ifp pducking
        action SS_DUCKING
  }

  else
    ifaction SS_RUN
  {
    ifp pstanding
       action SS_STAND
    else
      ifp pwalking
        action SS_WALK
    else
      ifp pjumping
        action SS_JUMPING
    else
      ifp pducking
        action SS_DUCKING
  }
  ends


appendevent EVENT_ANIMATESPRITES

ifactor APLAYER
{
  gettspr[].tsprcstat tsprite_temp
    gettspr[].tsprpal tsprite_temp2
  ifn tsprite_temp2 4
   ifand tsprite_temp 2
      xorvar tsprite_temp 2
  settspr[].tsprcstat tsprite_temp

  ifg INVINC 0 ifn tsprite_temp2 4 settspr[].tsprpal 121

  ifmultiplayer nullop
  else
  {
	  ife CHAR 0 // If the player's James, make him the default colour
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		ifn tsprite_temp2 0 nullop else settspr[].tsprpal 0
		}
	  }
	  ife CHAR 1 // If the player's Zaxtor, make him the default colour
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		ifn tsprite_temp2 0 nullop else settspr[].tsprpal 21
		}
	  }
  	ife CHAR 2 // If the player's Merlijn and is the default colour, make him red
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		  ifn tsprite_temp2 0 nullop else settspr[].tsprpal 21
		}
	  }
	  ife CHAR 3 // If the player's Highwire and is the default colour, make him green
	  ifand CHAR_APP 16
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		  ifn tsprite_temp2 0 nullop else settspr[].tsprpal 11
		}
	  }
	  ife CHAR 4 // If the player's Sang and is the default colour, make him red
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		  ifn tsprite_temp2 0 nullop else settspr[].tsprpal 21
		}
	  }
	  ife CHAR 5 // If the player's Rusty, make him the default colour
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		ifn tsprite_temp2 0 nullop else settspr[].tsprpal 12
		}
	  }
	  ife CHAR 6 // If the player's Geoffrey, make him the default colour
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		 ifn tsprite_temp2 0 nullop else settspr[].tsprpal 21
		}
	  }
	  ife CHAR 7 // If the player's Mikko, make him the default colour
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		ifn tsprite_temp2 0 nullop else settspr[].tsprpal 11
		}
	  }
	  ife CHAR 12 // If the player's Jane, make her the default colour
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		ifn tsprite_temp2 0 nullop else settspr[].tsprpal 3
		}
	  }
	  ife CHAR 13 // If the player's Micky, make him the default colour
	  {
	  gettspr[].tsprpal tsprite_temp2
	  ifn tsprite_temp2 4
		{
		ifn tsprite_temp2 0 nullop else settspr[].tsprpal 3
		}
	  }
  }

ifn CUSTOMKEYCARDPOS 0
	{
	set shield_up 0
	set merl_shieldup 0
	}

ifp pshrunk nullop else
{
		  geta[].htdispicnum tsprite_temp
		  ifg tsprite_temp 27391 // If the player's James, size the player sprite down
		  ifl tsprite_temp 27526
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 5244 // If the player's James, size the player sprite down
		  ifl tsprite_temp 5359
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 25629 // If the player's James, size the player sprite down
		  ifl tsprite_temp 25731
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 5500 // If the player's Zaxtor, size the player sprite down
		  ifl tsprite_temp 5616
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 6012 // If the player's Highwire, size the player sprite down
		  ifl tsprite_temp 6127
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 9269 // If the player's Highwire, size the player sprite down
		  ifl tsprite_temp 9280
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifge tsprite_temp 31744 // If the player's Highwire, size the player sprite down
		  ifle tsprite_temp 31838
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifge tsprite_temp 30121 // If the player's Highwire, size the player sprite down
		  ifle tsprite_temp 30125
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 6335 // If the player's Sang, size the player sprite down
		  ifl tsprite_temp 6364
		  {
		  settspr[].tsprxrepeat 25
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 25
			}
		  }
		  else
		  ifg tsprite_temp 10281 // If the player's Sang, size the player sprite down
		  ifl tsprite_temp 10292
		  {
		  settspr[].tsprxrepeat 25
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 25
			}
		  }
		  else
		  ifg tsprite_temp 17554 // If the player's Sang, size the player sprite down
		  ifl tsprite_temp 17590
		  {
		  settspr[].tsprxrepeat 25
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 25
			}
		  }
		  else
		  ifg tsprite_temp 23807 // If the player's Sang, size the player sprite down
		  ifl tsprite_temp 23834
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 23965 // If the player's Sang, size the player sprite down
		  ifl tsprite_temp 24011
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 6680 // If the player's Geoffrey, size the player sprite down
		  ifl tsprite_temp 6686
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 6655 // If the player's Rusty, size the player sprite down
		  ifl tsprite_temp 6755
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 27863 // If the player's Rusty, size the player sprite down
		  ifl tsprite_temp 27954
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 11131 // If the player's Geoffrey, size the player sprite down
		  ifl tsprite_temp 11142
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 6399 // If the player's Merlijn, size the player sprite down
		  ifl tsprite_temp 6430
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 9224 // If the player's Merlijn, size the player sprite down
		  ifl tsprite_temp 9270
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 10479 // If the player's Merlijn, size the player sprite down
		  ifl tsprite_temp 10495
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 26446 // If the player's Merlijn, size the player sprite down
		  ifl tsprite_temp 26552
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 6429 // If the player's Geoffrey, size the player sprite down
		  ifl tsprite_temp 6461
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 6584 // If the player's Geoffrey, size the player sprite down (more tiles)
		  ifl tsprite_temp 6619
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 11131 // If the player's Geoffrey, size the player sprite down (more tiles)
		  ifl tsprite_temp 11142
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 6911 // If the player's Mikko, size the player sprite down
		  ifl tsprite_temp 6957
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 20073 // If the player's Mikko, size the player sprite down
		  ifl tsprite_temp 20079
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 6982 // If the player's Mikko, size the player sprite down
		  ifl tsprite_temp 6989
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 7138 // If the player's Mikko crouching, size the player sprite down
		  ifl tsprite_temp 7159
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 14398 // If the player's Mikko swimming, size the player sprite down
		  ifl tsprite_temp 14419
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 11120 // If the player's Mikko kicking, size the player sprite down
		  ifl tsprite_temp 11131
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 7679 // If the player's the cultist, size the player sprite down
		  ifl tsprite_temp 7783
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 15229 // If the player's the cultist, size the player sprite down
		  ifl tsprite_temp 15260
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifge tsprite_temp 14075 // If the player's Bombshell, size the player sprite down
		  ifle tsprite_temp 14079
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifge tsprite_temp 11141 // If the player's Bombshell, size the player sprite down
		  ifle tsprite_temp 11152
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 9902 // If the player's Bombshell, size the player sprite down
		  ifl tsprite_temp 9948
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifge tsprite_temp 10365 // If the player's Bombshell, size the player sprite down
		  ifle tsprite_temp 10384
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 26279 // If the player's Maarten, size the player sprite down
		  ifl tsprite_temp 26401
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 14463 // If the player's JANE, size the player sprite down
		  ifl tsprite_temp 14484
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifge tsprite_temp 13676 // If the player's JANE, size the player sprite down
		  ifle tsprite_temp 13685
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifge tsprite_temp 12954 // If the player's JANE, size the player sprite down
		  ifle tsprite_temp 12958
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 12800 // If the player's JANE, size the player sprite down
		  ifl tsprite_temp 12877
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 12943 // If the player's JANE, size the player sprite down
		  ifl tsprite_temp 12954
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifge tsprite_temp 26701 // If the player's Micky, size the player sprite down
		  ifle tsprite_temp 26824
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 16383 // If the player's Micky, size the player sprite down
		  ifl tsprite_temp 16430
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 16584 // If the player's Micky, size the player sprite down
		  ifl tsprite_temp 16590
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 17514 // If the player's Micky, size the player sprite down
		  ifl tsprite_temp 17555
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 18526 // If the player's Micky, size the player sprite down
		  ifl tsprite_temp 18532
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 19128 // If the player's suitless Micky, size the player sprite down
		  ifl tsprite_temp 19154
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 20735 // If the player's Snowfall, size the player sprite down
		  ifl tsprite_temp 20776
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 20887 // If the player's Snowfall, size the player sprite down
		  ifl tsprite_temp 20950
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 27136 // If the player's Kagura, size the player sprite down
		  ifl tsprite_temp 27269
		  {
		  settspr[].tsprxrepeat 23
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 23
			}
		  }
		  else
		  ifg tsprite_temp 17924 // If the player's Cassandra, size the player sprite down
		  ifl tsprite_temp 17973
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 15399 // If the player's human snowfall, size the player sprite down
		  ifl tsprite_temp 15604
		  {
		  settspr[].tsprxrepeat 21
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tsprpal 49
			  settspr[].tspryrepeat 21
			}
		  }
		  else
		  ifg tsprite_temp 17444 // If the player's on a bike, size the player sprite down
		  ifl tsprite_temp 17450
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17499 // If the player's on a bike, size the player sprite down
		  ifl tsprite_temp 17505
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17454 // If the player's James on a bike, size the player sprite down
		  ifl tsprite_temp 17460
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17459 // If the player's Sang on a bike, size the player sprite down
		  ifl tsprite_temp 17465
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17464 // If the player's on a bike, size the player sprite down
		  ifl tsprite_temp 17470
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17469 // If the player's on a bike, size the player sprite down
		  ifl tsprite_temp 17480
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17479 // If the player's on a bike, size the player sprite down
		  ifl tsprite_temp 17490
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17489 // If the player's on a bike, size the player sprite down
		  ifl tsprite_temp 17495
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 17494 // If the player's on a bike, size the player sprite down
		  ifl tsprite_temp 17500
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 13676 // If the player's in the envirosuit, size the player sprite down
		  ifl tsprite_temp 13758
		  {
		  settspr[].tsprxrepeat 24
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 24
			}
		  }
		  else
		  ifg tsprite_temp 23044 // If the player's in a spacesuit
		  ifl tsprite_temp 23113
		  {
		  settspr[].tsprxrepeat 22
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 22
			}
		  }
		  else
		  ifg tsprite_temp 23921 // If the player's in the juggernaut suit, size the player sprite down
		  ifl tsprite_temp 23957
		  {
		  settspr[].tsprxrepeat 19
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 19
			}
		  }
		  else
		  {
		  settspr[].tsprxrepeat 34
		  gettspr[].tsprpal tsprite_temp2
		  ifn tsprite_temp2 4
			{
			  settspr[].tspryrepeat 34
			}
		  }
	}

  ifn player_using_submarine -1
  {
  geta[player_using_submarine].z tsprite_temp
  settspr[].tsprz tsprite_temp
  settspr[].tsprxrepeat 80
  settspr[].tspryrepeat 80
  }

  ifn player_using_fighter -1
  {
  geta[player_using_fighter].z tsprite_temp
  settspr[].tsprz tsprite_temp
  settspr[].tsprxrepeat 80
  settspr[].tspryrepeat 80
  }

  ifn player_using_hovertank -1
  {
  geta[player_using_hovertank].z tsprite_temp
  settspr[].tsprz tsprite_temp
  settspr[].tsprshade sprite[player_using_hovertank].shade
  settspr[].tsprpal sprite[player_using_hovertank].pal
  settspr[].tsprxrepeat 64
  settspr[].tspryrepeat 64
  }

  ifn player_using_VR_tank -1
  {
  geta[player_using_VR_tank].z tsprite_temp
  settspr[].tsprz tsprite_temp
  settspr[].tsprshade sprite[player_using_VR_tank].shade
  settspr[].tsprpal sprite[player_using_VR_tank].pal
  settspr[].tsprxrepeat 64
  settspr[].tspryrepeat 64
  }

}
endevent

defstate FIRE_RING
		spawn 3296
		set temp 0
		espawn 3296 add temp 128 seta[RETURN].ang temp
		espawn 3296 add temp 256 seta[RETURN].ang temp
		espawn 3296 add temp 384 seta[RETURN].ang temp
		espawn 3296 add temp 512 seta[RETURN].ang temp
		espawn 3296 add temp 640 seta[RETURN].ang temp
		espawn 3296 add temp 768 seta[RETURN].ang temp
		espawn 3296 add temp 896 seta[RETURN].ang temp
		espawn 3296 add temp 1024 seta[RETURN].ang temp
		espawn 3296 add temp 1152 seta[RETURN].ang temp
		espawn 3296 add temp 1280 seta[RETURN].ang temp
		espawn 3296 add temp 1408 seta[RETURN].ang temp
		espawn 3296 add temp 1536 seta[RETURN].ang temp
		espawn 3296 add temp 1664 seta[RETURN].ang temp
		espawn 3296 add temp 1792 seta[RETURN].ang temp
		espawn 3296 add temp 1920 seta[RETURN].ang temp
ends

defstate SPLASH_RING
		espawn 18138
		setav[RETURN].temp 1
		set temp 0
		espawn 18138 setav[RETURN].temp 1 add temp 128 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 256 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 384 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 512 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 640 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 768 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 896 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1024 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1152 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1280 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1408 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1536 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1664 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1792 seta[RETURN].ang temp
		espawn 18138 setav[RETURN].temp 1 add temp 1920 seta[RETURN].ang temp
ends

defstate dry_fire // controls the dry fire click
// dummy
ife kickbackpic 0
 ife player[].weapon_pos 0
    {
    ifsound DRY_FIRE nullop else
        {
        soundonce DRY_FIRE
        set gun_pushb_disp 2
        }
    }
ends

// code for blocking bullets
defstate player_block_sword
ifn SWORD_BLOCK 0
{
ifvarvarn SWORD_BLOCK temp_weap set SWORD_BLOCK 0
	ifg HIT_DAMAGE 0
	{
	getp[].ang temp2
	add temp2 1024
	getincangle temp4 sprite[].htang temp2
	ifand temp4 2147483648
		{
		  xorvar temp4 -1  // bitfield: 4294967295
		  	add temp4 1
		}
	ifl temp4 150 // is angle between them less than 150?
		switch sprite[].htpicnum
			case ENEMY_BULLET
			case ENEMY_SHOTGUN
			case SHOTSPARK1
			case NINEMM_CALIBRE
			case CHAINGUN
				ifrnd 128 sound DEFLECT_BUL1 else sound DEFLECT_BUL2
				sub p_stamina 20
				sound PISTOL_RICOCHET
				shoot ENEMY_BULLET
				shoot SPARK
				seta[].htextra -1
			break
			case 3789
				sub p_stamina 20
				sound PISTOL_RICOCHET
				shoot 3789
				shoot SPARK
				seta[].htextra -1
			break
			case 14970
				sub p_stamina 20
				sound PISTOL_RICOCHET
				shoot 14970
				shoot SPARK
				seta[].htextra -1
			break
		endswitch
	}
}
ends


// PLAYER CODE FILES

include CODE/PLAYER/JAMES.CON
include CODE/PLAYER/ZAXTOR.CON
include CODE/PLAYER/MERLIJN.CON
include CODE/PLAYER/HIGHWIRE.CON
include CODE/PLAYER/SANG.CON
include CODE/PLAYER/RUSTY.CON
include CODE/PLAYER/GEOFFREY.CON
include CODE/PLAYER/MIKKO.CON
include CODE/PLAYER/MICKY.CON
include CODE/PLAYER/SNOWFALL.CON
include CODE/PLAYER/KAGURA.CON

include CODE/PLAYER/CULTIST.CON
include CODE/PLAYER/BOMBSHELL.CON
include CODE/PLAYER/JANE.CON
include CODE/PLAYER/MAARTEN.CON


defstate PLAYERANIMS
ife FIRE_SUIT 1 ifn CHAR 12 state ENVIRO_SUIT_ANIMS
else ife SPACE_SUIT 1 ifn CHAR 12 ifn CHAR 13 ifn CHAR 14 state SPACE_SUIT_ANIMS
else ife JUGGERN_SUIT 1 ifn CHAR 12 ifn CHAR 13 ifn CHAR 14 state JUGGERN_SUIT_ANIMS
else
{
ife CHAR -1 action ZERO
ife CHAR 0
	{
	ifand CHAR_APP 64 state JAMES3_ANIMS else
	ifand CHAR_APP 1 state JAMES2_ANIMS else
	state JAMES_ANIMS
	}
ife CHAR 1 state ZAXTOR_ANIMS
ife CHAR 2
	{
	ifand CHAR_APP 4 state MERLIJN2_ANIMS else
	state MERLIJN_ANIMS
	}
ife CHAR 3
	{
	ifand CHAR_APP 16 state HIGHWIRE_SMART_ANIMS else
	state HIGHWIRE_ANIMS
	}
ife CHAR 4
	{
	ifand CHAR_APP 2 state SANG2_ANIMS else
	state SANG_ANIMS
	}
ife CHAR 5
	{
	ife TIMEZONE 21 state RUSTY_ANIMS else // flashback stuff
	ifand CHAR_APP 32 state RUSTY2_ANIMS else
	state RUSTY_ANIMS
	}
ife CHAR 6 state GEOFFREY_ANIMS
ife CHAR 7 state MIKKO_ANIMS
ife CHAR 8 action ZERO
ife CHAR 9 state PCULTIST_ANIMS
ife CHAR 10 state SHELLY_ANIMS
ife CHAR 11 state MAARTEN_ANIMS
ife CHAR 12 state JANE_ANIMS
ife CHAR 13 state MICKY_ANIMS
ife CHAR 14
	{
	ife TIMEZONE 6 state CIVILIAN_ANIMS else
	state SNOWFALL_ANIMS
	}
ife CHAR 15 state MICKY_NO_SUIT_ANIMS
ife CHAR 17 state KAGURA_ANIMS
ife CHAR 20 state CASSANDRA_ANIMS
}
ends

defstate PS_ANONYMOUS
{
set P_GENDER FEMALE
set CKNEE 1406
setp[].knuckle_incs 0
state reset_PDA
set IN_DREAM 1
}
ends

defstate PLAYERSTATS

// default select sounds
// set WEAPON0_SELECTSOUND SELECT_WEAPON
set WEAPON1_SELECTSOUND 4
set WEAPON2_SELECTSOUND 4
set WEAPON3_SELECTSOUND SELECT_WEAPON
set WEAPON4_SELECTSOUND SELECT_WEAPON
set WEAPON5_SELECTSOUND SELECT_MISC
set WEAPON6_SELECTSOUND SELECT_WEAPON
set WEAPON7_SELECTSOUND SELECT_WEAPON
set WEAPON8_SELECTSOUND SELECT_MISC
set WEAPON9_SELECTSOUND SELECT_WEAPON
set WEAPON10_SELECTSOUND SELECT_MISC
set WEAPON11_SELECTSOUND SELECT_WEAPON

ife CHAR -1
{
set WEAPON1_RELOADSOUND1 4
set WEAPON1_RELOADSOUND2 4
setp[].knuckle_incs 0
state lower_weapon
setp[].reloading 0
}
else
// **************************************J A M E S    S T A N F I E L D******************************************************
ife CHAR 0 // JAMES
    state PS_JAMES
// **************************************Z A X T O R******************************************************
else ife CHAR 1
    state PS_ZAXTOR
// **************************************M E R L I J N      O O S T R U M******************************************************
else ife CHAR 2 // MERLIJN
    state PS_MERLIJN
// **************************************H I G H W I R E******************************************************
else ife CHAR 3
    state PS_HIGHWIRE
// **************************************S A N G L U S S   W A R L O C K******************************************************
else ife CHAR 4
    state PS_SANGLUSS
// **************************************R U S T Y    N A I L S******************************************************
else ife CHAR 5
    state PS_RUSTY
// **************************************G E O F F R E Y******************************************************
else ife CHAR 6
    state PS_GEOFFREY
// **************************************M I K K O******************************************************
else ife CHAR 7
    state PS_MIKKO
else
// **************************************C U L T I S T******************************************************
ife CHAR 9 // CULTIST
    state PS_CULTIST
else
// **************************************B O M B S H E L L******************************************************
ife CHAR 10 // BOMBSHELL
    state PS_BOMBSHELL
// **************************************M A A R T E N    O O S T R U M******************************************************
else
ife CHAR 11 // MAARTEN
    state PS_MAARTEN
else
// **************************************J A N E  A S H F O R D*****************************************************
ife CHAR 12
    state PS_JANE
else
// **************************************M I C K Y*****************************************************
ife CHAR 13
    state PS_MICKY
else
// **************************************S N O W F A L L*****************************************************
ife CHAR 14
    state PS_SNOWFALL
else
// **************************************M I C K Y  NO SUIT*****************************************************
ife CHAR 15
    state PS_MICKY_NOSUIT
else
// **************************************KAGURA*****************************************************
ife CHAR 17
    state PS_KAGURA
else
// ==========================================CUTSCENE CHAR==========================
ife CHAR 20
	state PS_ANONYMOUS

// cannot use negative xoffsets without it going out of the viewable screen -- needs engine support
ifl userdef[].userquote_xoffset 0
    setu[].userquote_xoffset 0

// this is awful -- fixes turret going into single-fire
ifn using_turret -1
{
    set temp WEAPON0_FLAGS
    and temp -16385
    set WEAPON0_FLAGS temp

    set temp WEAPON1_FLAGS
    and temp -16385
    set WEAPON1_FLAGS temp

    set temp WEAPON2_FLAGS
    and temp -16385
    set WEAPON2_FLAGS temp

    set temp WEAPON3_FLAGS
    and temp -16385
    set WEAPON3_FLAGS temp

    set temp WEAPON4_FLAGS
    and temp -16385
    set WEAPON4_FLAGS temp

    set temp WEAPON5_FLAGS
    and temp -16385
    set WEAPON5_FLAGS temp

    set temp WEAPON6_FLAGS
    and temp -16385
    set WEAPON6_FLAGS temp

    set temp WEAPON7_FLAGS
    and temp -16385
    set WEAPON7_FLAGS temp

    set temp WEAPON8_FLAGS
    and temp -16385
    set WEAPON8_FLAGS temp

    set temp WEAPON9_FLAGS
    and temp -16385
    set WEAPON9_FLAGS temp

    set temp WEAPON10_FLAGS
    and temp -16385
    set WEAPON10_FLAGS temp

    set temp WEAPON11_FLAGS
    and temp -16385
    set WEAPON11_FLAGS temp
}

ifn player_in_vehicle 0
{
ifg player_using_horse 0 nullop else
ifg player_bike 0 nullop else
	{
    set temp WEAPON0_FLAGS
    and temp -16385
    set WEAPON0_FLAGS temp

    set temp WEAPON1_FLAGS
    and temp -16385
    set WEAPON1_FLAGS temp

    set temp WEAPON2_FLAGS
    and temp -16385
    set WEAPON2_FLAGS temp

    set temp WEAPON3_FLAGS
    and temp -16385
    set WEAPON3_FLAGS temp

    set temp WEAPON4_FLAGS
    and temp -16385
    set WEAPON4_FLAGS temp

    set temp WEAPON5_FLAGS
    and temp -16385
    set WEAPON5_FLAGS temp

    set temp WEAPON6_FLAGS
    and temp -16385
    set WEAPON6_FLAGS temp

    set temp WEAPON7_FLAGS
    and temp -16385
    set WEAPON7_FLAGS temp

    set temp WEAPON8_FLAGS
    and temp -16385
    set WEAPON8_FLAGS temp

    set temp WEAPON9_FLAGS
    and temp -16385
    set WEAPON9_FLAGS temp

    set temp WEAPON10_FLAGS
    and temp -16385
    set WEAPON10_FLAGS temp

    set temp WEAPON11_FLAGS
    and temp -16385
    set WEAPON11_FLAGS temp
	}
}

// if using PDU disable all weapon flags
ife MISSION_UP 1 ife MISSIONSCREEN 5
{
	set WEAPON0_FLAGS 0
	set WEAPON1_FLAGS 0
	set WEAPON2_FLAGS 0
	set WEAPON3_FLAGS 0
	set WEAPON4_FLAGS 0
	set WEAPON5_FLAGS 0
	set WEAPON6_FLAGS 0
	set WEAPON7_FLAGS 0
	set WEAPON8_FLAGS 0
	set WEAPON9_FLAGS 0
	set WEAPON10_FLAGS 0
	set WEAPON11_FLAGS 0
}

ife cur_weap throw_key
 ifn throwing -1
	{
	ifand EXTBITS_PRESS 64
		{
		ifg player[].kickback_pic 5
		ifl player[].kickback_pic 8
		setp[].kickback_pic 6
		 ifl bomb_throw_power 256 add bomb_throw_power 4
		}

	ife kickbackpic 0
		{
		setplayer[].curr_weapon throwing
		set throwing -1
		}
	}

ife SPACE_SUIT 1
 ifn CHAR 12
  ifn CHAR 13
   ifn CHAR 14
	{
	set C_ARM_1 20970
	set C_ARM_2 23089
	}


ifg riot_shield 0
{
ife CHAR 2 set merl_shieldup 0
ife CHAR 11 set merl_shieldup 0
	ifg shield_up 0
	  set HANDS_DRAW 1

ifg player_in_vehicle 0 set shield_up 0
else ife GUN_HANDS 1 { ife shield_up 1 sound RIOTSHIELD_UP ifl shield_up 10 add shield_up 1 }
else ife GUN_HANDS 2 { ife shield_up 9 sound RIOTSHIELD_UP ifg shield_up 0 sub shield_up 1  }

}

ifn PCINTER 0 // disable weapon select sounds when using interfaces
	{
	set WEAPON1_SELECTSOUND 4
	set WEAPON2_SELECTSOUND 4
	set WEAPON3_SELECTSOUND 4
	set WEAPON4_SELECTSOUND 4
	set WEAPON5_SELECTSOUND 4
	set WEAPON6_SELECTSOUND 4
	set WEAPON7_SELECTSOUND 4
	set WEAPON8_SELECTSOUND 4
	set WEAPON9_SELECTSOUND 4
	set WEAPON10_SELECTSOUND 4
	set WEAPON11_SELECTSOUND 4
	}

ends

// BLANK CHAR==================================================================================================================

// SPAWNPOINT ACTOR============================================================================================================


useractor notenemy 3712
    fall

    ifaction 0
    {
        cstat 32768
        set CHARSTART 1

        for i range MAXCHARS
        {
            ife sprite[THISACTOR].pal i
            {
                setarray player_spawnpoint[i] THISACTOR
                exit
            }
        }
        action ZERO
    }

    // mikko can breathe in his spawning tank
    ife CHAR 7 ifinwater ifpdistl 2048 { setp[].airleft 390 }

enda

// SANG'S BAT===============================================================================================================

move BATS_FLY 160 10
move BATS_FLY_FAST 240 10

useractor notenemy 6204
ifaction 0
	{
	sizeat 10 10
	spritepal 2
	spawn FRAMEEFFECT1
	move BATS_FLY_FAST geth faceplayerslow
	ifcount 150 killit
	ifnotmoving killit
	ifpdistl 512
		{
		set CUS_WACK 3
		palfrom 10 64 0 0
		addphealth -2
		killit
		sound RIPPER_SCRATCH
		}
	}
enda

spriteshadow 6200
useractor notenemy 6200

ifspawnedby TRENTON_SOLARI
{
sizeat 8 8
	spritepal 2
	move BATS_FLY getv geth
	ifnotmoving killit
}
else
{
sizeat 4 4
	ifspawnedby APLAYER
	{
	getp[].posx temp
	getp[].posy temp2
	getp[].posz temp8
	sub temp8 1754
	seta[].z temp8
	ifand CHAR_APP 2 { spawn SKULLEXPLOSION killit }
	ifn CHAR 4 killit
	}
	else
	ifspawnedby 1404
	{
	geta[myowner].x temp
	geta[myowner].y temp2
	geta[myowner].z temp8
	sub temp8 11313
	seta[].z temp8
	ifand CHAR_APP 2 { spawn SKULLEXPLOSION killit }
	ife HITAGSAVED 1 { ifn camerasprite -1 cstat 0 else cstat 32768 }
	}
	else
	ifspawnedby 13207
	{
	geta[myowner].x temp
	geta[myowner].y temp2
	geta[myowner].z temp8
	ifand sprite[myowner].cstat 8
	{ cstator 8 add temp8 6096 } else
	sub temp8 11813
	seta[].z temp8
	ifand CHAR_APP 2 { spawn SKULLEXPLOSION killit }
	ife HITAGSAVED 1 { ifn camerasprite -1 cstat 0 else cstat 32768 }
	}
	else
	ifspawnedby FORCE_CHARACTER
	{
	getp[].posx temp
	getp[].posy temp2
	getp[].posz temp8
	sub temp8 1754
	seta[].z temp8
	ifn CHAR 4 killit
	}

	set temp3 temp
	add temp3 256

	rotatepoint temp temp2 temp3 temp2 temp4 temp5 temp6

	ifg temp4 2048 sub temp4 2048

	seta[].x temp5
	seta[].y temp6


	ifcount 1 { add temp4 32 resetcount }
}

enda

// MAP LOCATION==========================================================================================================

useractor notenemy 3831 cstat 32768

ifn HITAGSAVED 0
{
	checkactivatormotion HITAGSAVED
	ife RETURN 1
		{
		set LOCATION LOTAGSAVED
		}
	}


 enda

// FORCE PLAYER==========================================================================================================
// LOADOUT STUFF
defstate getplayerhealth
getp[].i temp
geta[temp].extra temp2
ends

defstate give_assigned_weapon
ifn CHAR -1
 ifg AMC_BUDGET 0
	{
		readarrayfromfile MELEE_WEAPON_LOADOUT F_MELEE_LOADOUT_AMCTC
		set GOT_KNIFE MELEE_WEAPON_LOADOUT[CHAR]

		readarrayfromfile EQUIPMENT_LOADOUT F_EQUIP_LOADOUT_AMCTC
		readarrayfromfile CHEST_LOADOUT F_CHEST_LOADOUT_AMCTC
		readarrayfromfile BELT_LOADOUT F_BELT_LOADOUT_AMCTC
		readarrayfromfile HELMET_LOADOUT F_HELMET_LOADOUT_AMCTC
		readarrayfromfile BOOTS_LOADOUT F_BOOTS_LOADOUT_AMCTC

		// energy shield rules

		ife CHAR 14 nullop else set P_HAS_SHIELD 0

		ifg amcbase_volume 3 // from volume 4 onwards, everyone has a basic shield
			{
			ifn CHAR 0 set P_HAS_SHIELD 1 // James won't get shield since he's in hell
			}

		ife MEAL_BUFF[CHAR] 4 set P_SPIRIT_ARMOUR 25

		ife CHEST_LOADOUT[CHAR] 1 setp[].shield_amount 100
		else ife CHEST_LOADOUT[CHAR] 4 set P_SPIRIT_ARMOUR 100
		else ife CHEST_LOADOUT[CHAR] 5 set P_HAS_SHIELD 1

		ife EQUIPMENT_LOADOUT[CHAR] 2 setp[].firstaid_amount 100
		ife EQUIPMENT_LOADOUT[CHAR] 3 set riot_shield 150
		ife CHAR 1 ife EQUIPMENT_LOADOUT[1] 5 setp[].holoduke_amount 2400 // Zaxtor's hologram
		ife CHAR 2 ife EQUIPMENT_LOADOUT[2] 4 setp[].holoduke_amount 2400 // Merlijn's heavy shield
		ife CHAR 3 ife EQUIPMENT_LOADOUT[3] 6 setp[].holoduke_amount 2400 // Highwire's radio
		ife CHAR 4 ife EQUIPMENT_LOADOUT[4] 7 setp[].holoduke_amount 600 // Sang's mirror orb
		ife CHAR 7 ife EQUIPMENT_LOADOUT[7] 8 setp[].holoduke_amount 2400 // Mikko's backpack
		ife CHAR 9 ife EQUIPMENT_LOADOUT[9] 7 setp[].holoduke_amount 600 // Cultist's mirror orb
		ife CHAR 11 ife EQUIPMENT_LOADOUT[11] 12 setp[].holoduke_amount 2400 // Maarten's book of conjuration
		ife CHAR 12 ife EQUIPMENT_LOADOUT[12] 11 setp[].holoduke_amount 2400 // Jane's beam sabre
		ife CHAR 13 ife EQUIPMENT_LOADOUT[13] 9 setp[].holoduke_amount 2400 // Micky's turret
		ife CHAR 14 ife EQUIPMENT_LOADOUT[14] 10 setp[].holoduke_amount 2400 // Snowfall's Vajra device

		ife CHAR 6 ife HELMET_LOADOUT[6] 6 setp[].holoduke_amount 300 // Geoffrey's bandana
		ife HELMET_LOADOUT[CHAR] 2 { setp[].heat_amount HEAT_AMOUNT set HEAT_GOGGLES 1 }
		ife HELMET_LOADOUT[CHAR] 3 setp[].heat_amount HEAT_AMOUNT
		ife HELMET_LOADOUT[CHAR] 4 setp[].heat_amount HEAT_AMOUNT

		ife BOOTS_LOADOUT[CHAR] 1 setp[].boot_amount BOOT_AMOUNT
		ife BOOTS_LOADOUT[CHAR] 2 set GOT_FLIPPER 1

		ife CHAR 5 ife BELT_LOADOUT[5] 1 setp[].holoduke_amount 2400 // Rusty's throwing star belt
		ife CHAR 0 ife BELT_LOADOUT[0] 2 setp[].holoduke_amount 900 // James' forcefield belt
		ife CHAR 10 ife BELT_LOADOUT[10] 2 setp[].holoduke_amount 2400 // Bombshell's forcefield belt

		readarrayfromfile ARTIFACTS_LOADOUT F_ARTIFACTS_LOADOUT_AMCTC

		readarrayfromfile SPECIALIST_EQUIPMENT F_SPECIAL_LOADOUT_AMCTC

		readarrayfromfile AMMO_LOADOUT F_AMMO_LOADOUT_AMCTC
		ife AMMO_LOADOUT[CHAR] 1 set explosive_shells 10
		else ife AMMO_LOADOUT[CHAR] 2 set flechete_shells 10
		else ife AMMO_LOADOUT[CHAR] 3 set silver_ammo 100
		else ife AMMO_LOADOUT[CHAR] 4 set tesla_ammo 75
		else ife AMMO_LOADOUT[CHAR] 5 set silver_bolts 10
		else ife AMMO_LOADOUT[CHAR] 6 set micro_torpedo 10
		else ife AMMO_LOADOUT[CHAR] 7 set magnum_shells 10
		else ife AMMO_LOADOUT[CHAR] 8 { ife PERSONNEL_RESEARCH[15] 2 set heat_seek_card 10 else set heat_seek_card 5 }
		else ife AMMO_LOADOUT[CHAR] 9 set atomic_bomb 1
		else ife AMMO_LOADOUT[CHAR] 10 set DUP_missile_ammo 5
		else ife AMMO_LOADOUT[CHAR] 11 set fortymm_grenades 5
		else ife AMMO_LOADOUT[CHAR] 12 set fortymm_caseless 5
		else ife AMMO_LOADOUT[CHAR] 13 set fortymm_shells 5
		else ife AMMO_LOADOUT[CHAR] 14 set fortymm_MIA_shells 5
		else ife AMMO_LOADOUT[CHAR] 15 set fortymm_plasma 5
		else ife AMMO_LOADOUT[CHAR] 16 set fortymm_slug 5
		else ife AMMO_LOADOUT[CHAR] 19 set HEAT_SINKS 20
		else ife AMMO_LOADOUT[CHAR] 20 set dragon_shells 10
		else ife AMMO_LOADOUT[CHAR] 21 set fortymm_electro 5
		else ife AMMO_LOADOUT[CHAR] 22 set fortymm_cryo 5
		else ife AMMO_LOADOUT[CHAR] 23 set incend_ammo 75
		else ife AMMO_LOADOUT[CHAR] 24 set p_blue_mana 50
		else ife AMMO_LOADOUT[CHAR] 25 set p_green_mana 25
		else ife AMMO_LOADOUT[CHAR] 26 set p_orange_mana 10
		else ife AMMO_LOADOUT[CHAR] 27 set p_purple_mana 2

		readarrayfromfile temp_WEAPON_LOADOUT F_TEMPW_LOADOUT_AMCTC
		set temp_weap temp_WEAPON_LOADOUT[CHAR]
		ife temp_WEAPON_LOADOUT[CHAR] 1 setp[].ammo_amount 0 10
		else ife temp_WEAPON_LOADOUT[CHAR] 2 setp[].ammo_amount 0 10
		else ife temp_WEAPON_LOADOUT[CHAR] 3 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 4 setp[].ammo_amount 0 75
		else ife temp_WEAPON_LOADOUT[CHAR] 5 setp[].ammo_amount 0 200
		else ife temp_WEAPON_LOADOUT[CHAR] 6 setp[].ammo_amount 0 25
		else ife temp_WEAPON_LOADOUT[CHAR] 7 setp[].ammo_amount 0 40
		else ife temp_WEAPON_LOADOUT[CHAR] 8 setp[].ammo_amount 0 30
		else ife temp_WEAPON_LOADOUT[CHAR] 9 setp[].ammo_amount 0 10
		else ife temp_WEAPON_LOADOUT[CHAR] 10 setp[].ammo_amount 0 20
		else ife temp_WEAPON_LOADOUT[CHAR] 11 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 12 setp[].ammo_amount 0 24
		else ife temp_WEAPON_LOADOUT[CHAR] 13 setp[].ammo_amount 0 20
		else ife temp_WEAPON_LOADOUT[CHAR] 14 setp[].ammo_amount 0 10
		else ife temp_WEAPON_LOADOUT[CHAR] 15 setp[].ammo_amount 0 20
		else ife temp_WEAPON_LOADOUT[CHAR] 16 setp[].ammo_amount 0 10
		else ife temp_WEAPON_LOADOUT[CHAR] 17 setp[].ammo_amount 0 1
		else ife temp_WEAPON_LOADOUT[CHAR] 18 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 19 setp[].ammo_amount 0 1
		else ife temp_WEAPON_LOADOUT[CHAR] 21 setp[].ammo_amount 0 80
		else ife temp_WEAPON_LOADOUT[CHAR] 22 setp[].ammo_amount 0 200
		else ife temp_WEAPON_LOADOUT[CHAR] 23 setp[].ammo_amount 0 80
		else ife temp_WEAPON_LOADOUT[CHAR] 24 setp[].ammo_amount 0 200
		else ife temp_WEAPON_LOADOUT[CHAR] 25 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 26 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 27 setp[].ammo_amount 0 300
		else ife temp_WEAPON_LOADOUT[CHAR] 28 setp[].ammo_amount 0 100
		else ife temp_WEAPON_LOADOUT[CHAR] 29 setp[].ammo_amount 0 16
		else ife temp_WEAPON_LOADOUT[CHAR] 30 setp[].ammo_amount 0 100
		else ife temp_WEAPON_LOADOUT[CHAR] 31 setp[].ammo_amount 0 100
		else ife temp_WEAPON_LOADOUT[CHAR] 32 setp[].ammo_amount 0 10
		else ife temp_WEAPON_LOADOUT[CHAR] 33 setp[].ammo_amount 0 100
		else ife temp_WEAPON_LOADOUT[CHAR] 34 setp[].ammo_amount 0 300
		else ife temp_WEAPON_LOADOUT[CHAR] 35 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 37 setp[].ammo_amount 0 1
		else ife temp_WEAPON_LOADOUT[CHAR] 38 setp[].ammo_amount 0 3
		else ife temp_WEAPON_LOADOUT[CHAR] 39 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 40 setp[].ammo_amount 0 10
		else ife temp_WEAPON_LOADOUT[CHAR] 41 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 45 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 47 setp[].ammo_amount 0 140
		else ife temp_WEAPON_LOADOUT[CHAR] 50 setp[].ammo_amount 0 20
		else ife temp_WEAPON_LOADOUT[CHAR] 52 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 53 setp[].ammo_amount 0 36
		else ife temp_WEAPON_LOADOUT[CHAR] 54 setp[].ammo_amount 0 300
		else ife temp_WEAPON_LOADOUT[CHAR] 55 setp[].ammo_amount 0 150
		else ife temp_WEAPON_LOADOUT[CHAR] 56 setp[].ammo_amount 0 25
		set normal_ammo player[].ammo_amount 0
		ife CHAR 0
			{
			readgamevar JAMES_1911
			readgamevar JAMES_JACKH
			}

		readarrayfromfile EQUIPMENT_LOADOUT_COST F_EQUIPMENT_L_COST_AMCTC
		readarrayfromfile MELEE_LOADOUT_COST F_MELEE_L_COST_AMCTC
		readarrayfromfile temp_WEAPON_LOADOUT_COST F_TWEAP_L_COST_AMCTC
		readarrayfromfile AMMO_LOADOUT_COST F_AMMO_L_COST_AMCTC
		// readarrayfromfile SPECIALIST_LOADOUT_COST F_SPECIAL_L_COST_AMCTC // UNUSED
		readarrayfromfile CHEST_LOADOUT_COST F_CHEST_L_COST_AMCTC
		readarrayfromfile BELT_LOADOUT_COST F_BELT_L_COST_AMCTC
		readarrayfromfile HELMET_LOADOUT_COST F_HELMET_L_COST_AMCTC
		readarrayfromfile BOOT_LOADOUT_COST F_BOOT_LOADOUT_COST_AMCTC

		set LOADOUT_COST 0
		add LOADOUT_COST EQUIPMENT_LOADOUT_COST[CHAR]
		add LOADOUT_COST MELEE_LOADOUT_COST[CHAR]
		add LOADOUT_COST temp_WEAPON_LOADOUT_COST[CHAR]
		add LOADOUT_COST AMMO_LOADOUT_COST[CHAR]
		// add LOADOUT_COST SPECIALIST_LOADOUT_COST[CHAR] // UNUSED
		add LOADOUT_COST CHEST_LOADOUT_COST[CHAR]
		add LOADOUT_COST BELT_LOADOUT_COST[CHAR]
		add LOADOUT_COST HELMET_LOADOUT_COST[CHAR]
		add LOADOUT_COST BOOT_LOADOUT_COST[CHAR]
		al LOADOUT_COST

		ife BASE_RESEARCH[6] 1 // player built workshop?
		{
		set temp2 LOADOUT_COST
		mulvar temp2 10
		divvar temp2 12
		set LOADOUT_COST temp2
		mulvar LOADOUT_COST 10
		divvar LOADOUT_COST 12
		}

		ife player[].gotweapon 1 0
			{
			setp[].gotweapon 1 1
			setp[].ammo_amount 1 48
			}

		ife P_HAS_SHIELD 1 sound ESHEILD_CHARGING

	}
ends

// force character

defstate force_char
set just_changed 1
set jib_quote_track 0
set pickup_quote_track 0
getp[].i temp
set shield_up 0

setp[].curr_weapon 0
set pickup_quote_track 0
setp[].kickback_pic 30

			for temp range gun_mags_arr_count
			{
				setarray gun_mags[temp] -1
			}

			for temp range gun_mags_arr_count
			{
				setarray gun_ammopools[temp] -1
			}

		readarrayfromfile SPECIALIST_EQUIPMENT F_SPECIAL_LOADOUT_AMCTC
		readarrayfromfile PERSONNEL_RESEARCH F_PERSONNEL_AMCTC
			ifspritepal 0
			{
				set CHAR 0
				{
				setp[].max_player_health 100
				seta[temp].extra 100
				}
			}
				ifspritepal 1
			{ set CHAR 1 setp[].max_player_health 255 seta[temp].extra 255 }
				ifspritepal 2
			{ set CHAR 2 setp[].max_player_health 200 seta[temp].extra 200 }
				ifspritepal 3
			{ state highwire_initgunmags set CHAR 3 setp[].max_player_health 100 seta[temp].extra 100 }
				ifspritepal 4
				{
				set CHAR 4
				ife PERSONNEL_RESEARCH[10] 2
					{
					setp[].max_player_health 100
					seta[temp].extra 100
					}
				else
					{
					setp[].max_player_health 75
					seta[temp].extra 75
					}
				state spawn_bat
				}
				ifspritepal 5
					{
					set CHAR 5 ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 140 seta[temp].extra 140 }
					else { setp[].max_player_health 120 seta[temp].extra 120 }
					}
				ifspritepal 6
					{ set CHAR 6 setp[].max_player_health 120 seta[temp].extra 120 }

	ifspritepal 7 // Mikko
	{
	set CHAR 7
	ifand CHAR_APP 8 set P_HAS_SHIELD 1
			ife PERSONNEL_RESEARCH[6] 2 // Both
			 ife PERSONNEL_RESEARCH[9] 2
			 {
			 setp[].max_player_health 200
			seta[temp].extra 200
			 }
			 else
			 ifn PERSONNEL_RESEARCH[9] 2
			ife PERSONNEL_RESEARCH[6] 2 // Cybertour sheathing
			{
				setp[].max_player_health 170
				seta[temp].extra 170
			}
			else
			ifn PERSONNEL_RESEARCH[6] 2
			ife PERSONNEL_RESEARCH[9] 2 // MS Corp ceramic plating
			{
				setp[].max_player_health 180
				seta[temp].extra 180
			}
			else
			 {
			setp[].max_player_health 150
			seta[temp].extra 150
			}
	}


	ifspritepal 8
		{ set CHAR -1 }
	ifspritepal 9 // Cultist
		{ set CHAR 9 setp[].max_player_health 100 seta[temp].extra 100 set P_HAS_SHIELD 0 }
	ifspritepal 10 // Bombshell
		{ set CHAR 10 setp[].max_player_health 100 seta[temp].extra 100 set P_HAS_SHIELD 0 }
	ifspritepal 11 // Maarten
		{ set CHAR 11 setp[].max_player_health 150 seta[temp].extra 150 set P_HAS_SHIELD 0 }
	ifspritepal 12 // Jane
		{ set CHAR 12 setp[].max_player_health 100 seta[temp].extra 100 set P_HAS_SHIELD 0 }
	ifspritepal 13 // Micky
		{ set CHAR 13 ifand CHAR_APP 256 set P_HAS_SHIELD 1 setp[].max_player_health 100 seta[temp].extra 100 }
	ifspritepal 14 // Snowfall
		{
		set CHAR 14 set P_HAS_SHIELD 1 ife PERSONNEL_RESEARCH[10] 2 { setp[].max_player_health 75 seta[temp].extra 85 }
		else { setp[].max_player_health 50 seta[temp].extra 50 }
		}
	ifspritepal 15 // Suitless Micky
		{ set CHAR 15 setp[].max_player_health 75 seta[temp].extra 75 }
	ifspritepal 17 // Kagura
		{
		set CHAR 17 ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 120 seta[temp].extra 120 }
		else { setp[].max_player_health 120 seta[temp].extra 120 }
		}
	ifspritepal 8 ifn CHAR 2 { setp[].ammo_amount 1 48 }
	ifspritepal 20 // Cassandra
{ set CHAR 20 setp[].max_player_health 200 seta[temp].extra 200 }

	getp[].max_player_health pmax_health
	ifn CHAR -1
	ife ARTIFACTS_LOADOUT[CHAR] 11
		{
		add pmax_health 20
		seta[].extra pmax_health
		setp[].max_player_health pmax_health
		}

	state set_max_ally

	ifspritepal 30
		{
		set CHAR -1
		set CHARSELECT 1
		}
	else set CHARSELECT 0


ifn LOTAGSAVED 0
{
set just_changed 1
		ife CHAR 0
		{
		set temp_weap James_equip[43]
		setp[].ammo_amount 0 James_equip[1]
		setp[].gotweapon 1 James_equip[2]
		setp[].ammo_amount 1 James_equip[3]
		setp[].gotweapon 2 James_equip[4]
		setp[].ammo_amount 2 James_equip[5]
		setp[].gotweapon 3 James_equip[6]
		setp[].ammo_amount 3 James_equip[7]
		setp[].gotweapon 4 James_equip[8] // RPG
		setp[].ammo_amount 4 James_equip[9]
		setp[].ammo_amount 5 James_equip[10] // Pipebomb
		setp[].gotweapon 6 James_equip[11] // Shrinker
		setp[].ammo_amount 6 James_equip[12]
		setp[].gotweapon 7 James_equip[13] // Devistator
		setp[].ammo_amount 7 James_equip[14]
		setp[].ammo_amount 8 James_equip[15] // Tripbomb
		setp[].gotweapon 9 James_equip[16] // Freezer
		setp[].ammo_amount 9 James_equip[17]
		setp[].gotweapon 11 James_equip[18] // Expander
		setp[].ammo_amount 11 James_equip[19]

		getp[].i temp7
		ife James_equip[20] 0 setarray James_equip[20] 100
		seta[temp7].extra James_equip[20]
		ife James_equip[21] 0 setarray James_equip[21] 100
		setp[].max_player_health James_equip[21]
		setp[].shield_amount James_equip[22]
		set P_SPIRIT_ARMOUR James_equip[23]
		set P_FIRE_ARMOUR James_equip[53]
		set JAMES_UPGRADE James_equip[24]
		set gun_firemode James_equip[25]
		set guns_akimbo James_equip[26]
		set GOT_EXPLOSIVE James_equip[27]
		set AIR_FILTER James_equip[28]
		set PISTOLMAG James_equip[29]
		set MGUNMAG James_equip[30]
		set RUNEKEYS James_equip[31]
		set ACCESSKEY2 James_equip[32]
		set PLUGKEY James_equip[33]
		set HELLGKEYS James_equip[34]
		set OLDKEYS James_equip[35]
		set GENERIC_KEYS James_equip[45]
		setp[].got_access James_equip[44]
		setp[].boot_amount James_equip[36]
		setp[].heat_amount James_equip[37]
		setp[].holoduke_amount James_equip[38]
		setp[].jetpack_amount James_equip[39]
		setp[].scuba_amount James_equip[40]
		setp[].firstaid_amount James_equip[41]
		setp[].steroids_amount James_equip[42]
		set silver_ammo James_equip[46]
		set explosive_shells James_equip[47]
		set FIRE_SUIT James_equip[48]
		set GAS_MASK James_equip[49]
		set tesla_ammo James_equip[50]
		set SCARABKEYS James_equip[51]
		set COGS James_equip[52]
		set TOOLBOX James_equip[54]
		set flechete_shells James_equip[55]
		set silver_bolts James_equip[56]
		set NORMAL_KEYS James_equip[57]
		set micro_torpedo James_equip[58]
		set magnum_shells James_equip[59]
		set heat_seek_card James_equip[60]
		set atomic_bomb James_equip[61]
		set DUP_missile_ammo James_equip[62]
		set SW_KEYS James_equip[63]
		set fortymm_grenades James_equip[64]
		set fortymm_shells James_equip[65]
		set fortymm_MIA_shells James_equip[66]
		set fortymm_plasma James_equip[67]
		set fortymm_caseless James_equip[68]
		set fortymm_electro James_equip[69]
		set fortymm_slug James_equip[70]
		set fortymm_cryo James_equip[71]
		set ROPE James_equip[72]
		set SHOTGUNMAG James_equip[73]
		set SHOTGUNBOXMAG James_equip[74]
		set dragon_shells James_equip[75]
		set GOT_KNIFE James_equip[76]
		set riot_shield James_equip[77]
		set gun_firemode_two James_equip[78]
		set P_HAS_SHIELD James_equip[79]
		}
	ife CHAR 1
		{
		set temp_weap Zaxtor_equip[43]
		setp[].ammo_amount 0 Zaxtor_equip[1]
		setp[].gotweapon 1 Zaxtor_equip[2]
		setp[].ammo_amount 1 Zaxtor_equip[3]
		setp[].gotweapon 2 Zaxtor_equip[4]
		setp[].ammo_amount 2 Zaxtor_equip[5]
		setp[].gotweapon 3 Zaxtor_equip[6]
		setp[].ammo_amount 3 Zaxtor_equip[7]
		setp[].gotweapon 4 Zaxtor_equip[8] // RPG
		setp[].ammo_amount 4 Zaxtor_equip[9]
		setp[].ammo_amount 5 Zaxtor_equip[10] // Pipebomb
		setp[].gotweapon 6 Zaxtor_equip[11] // Shrinker
		setp[].ammo_amount 6 Zaxtor_equip[12]
		setp[].gotweapon 7 Zaxtor_equip[13] // Devistator
		setp[].ammo_amount 7 Zaxtor_equip[14]
		setp[].ammo_amount 8 Zaxtor_equip[15] // Tripbomb
		setp[].gotweapon 9 Zaxtor_equip[16] // Freezer
		setp[].ammo_amount 9 Zaxtor_equip[17]
		setp[].gotweapon 11 Zaxtor_equip[18] // Expander
		setp[].ammo_amount 11 Zaxtor_equip[19]

		getp[].i temp7
		ife Zaxtor_equip[20] 0 setarray Zaxtor_equip[20] 255
		seta[temp7].extra Zaxtor_equip[20]
		ife Zaxtor_equip[21] 0 setarray Zaxtor_equip[21] 255
		setp[].max_player_health Zaxtor_equip[21]

		setp[].shield_amount Zaxtor_equip[22]
		set P_SPIRIT_ARMOUR Zaxtor_equip[23]
		set P_FIRE_ARMOUR Zaxtor_equip[53]
		set ZAXTOR_UPGRADE Zaxtor_equip[24]
		set gun_firemode Zaxtor_equip[25]
		set guns_akimbo Zaxtor_equip[26]
		set GOT_EXPLOSIVE Zaxtor_equip[27]
		set AIR_FILTER Zaxtor_equip[28]
		set PISTOLMAG Zaxtor_equip[29]
		set MGUNMAG Zaxtor_equip[30]
		set RUNEKEYS Zaxtor_equip[31]
		set ACCESSKEY2 Zaxtor_equip[32]
		set PLUGKEY Zaxtor_equip[33]
		set HELLGKEYS Zaxtor_equip[34]
		set OLDKEYS Zaxtor_equip[35]
		set GENERIC_KEYS Zaxtor_equip[45]
		setp[].got_access Zaxtor_equip[44]
		setp[].boot_amount Zaxtor_equip[36]
		setp[].heat_amount Zaxtor_equip[37]
		setp[].holoduke_amount Zaxtor_equip[38]
		setp[].jetpack_amount Zaxtor_equip[39]
		setp[].scuba_amount Zaxtor_equip[40]
		setp[].firstaid_amount Zaxtor_equip[41]
		setp[].steroids_amount Zaxtor_equip[42]
		set silver_ammo Zaxtor_equip[46]
		set explosive_shells Zaxtor_equip[47]
		set flechete_shells Zaxtor_equip[55]
		set FIRE_SUIT Zaxtor_equip[48]
		set GAS_MASK Zaxtor_equip[49]
		set tesla_ammo Zaxtor_equip[50]
		set SCARABKEYS Zaxtor_equip[51]
		set COGS Zaxtor_equip[52]
		set TOOLBOX Zaxtor_equip[54]
		set silver_bolts Zaxtor_equip[56]
		set NORMAL_KEYS Zaxtor_equip[57]
		set micro_torpedo Zaxtor_equip[58]
		set magnum_shells Zaxtor_equip[59]
		set heat_seek_card Zaxtor_equip[60]
		set atomic_bomb Zaxtor_equip[61]
		set DUP_missile_ammo Zaxtor_equip[62]
		set SW_KEYS Zaxtor_equip[63]
		set fortymm_grenades Zaxtor_equip[64]
		set fortymm_shells Zaxtor_equip[65]
		set fortymm_MIA_shells Zaxtor_equip[66]
		set fortymm_plasma Zaxtor_equip[67]
		set fortymm_caseless Zaxtor_equip[68]
		set fortymm_electro Zaxtor_equip[69]
		set fortymm_slug Zaxtor_equip[70]
		set fortymm_cryo Zaxtor_equip[71]
		set ROPE Zaxtor_equip[72]
		set SHOTGUNMAG Zaxtor_equip[73]
		set SHOTGUNBOXMAG Zaxtor_equip[74]
		set dragon_shells Zaxtor_equip[75]
		set GOT_KNIFE Zaxtor_equip[76]
		set riot_shield Zaxtor_equip[77]
		set gun_firemode_two Zaxtor_equip[78]
		set P_HAS_SHIELD Zaxtor_equip[79]
		}
	ife CHAR 2
		{
		set temp_weap Merlijn_equip[43]
		setp[].ammo_amount 0 Merlijn_equip[1]
		setp[].gotweapon 1 Merlijn_equip[2]
		setp[].ammo_amount 1 Merlijn_equip[3]
		setp[].gotweapon 2 Merlijn_equip[4]
		setp[].ammo_amount 2 Merlijn_equip[5]
		setp[].gotweapon 3 Merlijn_equip[6]
		setp[].ammo_amount 3 Merlijn_equip[7]
		setp[].gotweapon 4 Merlijn_equip[8] // RPG
		setp[].ammo_amount 4 Merlijn_equip[9]
		setp[].ammo_amount 5 Merlijn_equip[10] // Pipebomb
		setp[].gotweapon 6 Merlijn_equip[11] // Shrinker
		setp[].ammo_amount 6 Merlijn_equip[12]
		setp[].gotweapon 7 Merlijn_equip[13] // Devistator
		setp[].ammo_amount 7 Merlijn_equip[14]
		setp[].ammo_amount 8 Merlijn_equip[15] // Tripbomb
		setp[].gotweapon 9 Merlijn_equip[16] // Freezer
		setp[].ammo_amount 9 Merlijn_equip[17]
		setp[].gotweapon 11 Merlijn_equip[18] // Expander
		setp[].ammo_amount 11 Merlijn_equip[19]

		getp[].i temp7
		ife Merlijn_equip[20] 0 setarray Merlijn_equip[20] 200
		seta[temp7].extra Merlijn_equip[20]
		ife Merlijn_equip[21] 0 setarray Merlijn_equip[21] 200
		setp[].max_player_health Merlijn_equip[21]

		setp[].shield_amount Merlijn_equip[22]
		set P_SPIRIT_ARMOUR Merlijn_equip[23]
		set P_FIRE_ARMOUR Merlijn_equip[53]
		set MERLIJN_UPGRADE Merlijn_equip[24]
		set gun_firemode Merlijn_equip[25]
		set guns_akimbo Merlijn_equip[26]
		set GOT_EXPLOSIVE Merlijn_equip[27]
		set AIR_FILTER Merlijn_equip[28]
		set PISTOLMAG Merlijn_equip[29]
		set MGUNMAG Merlijn_equip[30]
		set RUNEKEYS Merlijn_equip[31]
		set ACCESSKEY2 Merlijn_equip[32]
		set PLUGKEY Merlijn_equip[33]
		set HELLGKEYS Merlijn_equip[34]
		set OLDKEYS Merlijn_equip[35]
		set GENERIC_KEYS Merlijn_equip[45]
		setp[].got_access Merlijn_equip[44]
		setp[].boot_amount Merlijn_equip[36]
		setp[].heat_amount Merlijn_equip[37]
		setp[].holoduke_amount Merlijn_equip[38]
		setp[].jetpack_amount Merlijn_equip[39]
		setp[].scuba_amount Merlijn_equip[40]
		setp[].firstaid_amount Merlijn_equip[41]
		setp[].steroids_amount Merlijn_equip[42]
		set silver_ammo Merlijn_equip[46]
		set explosive_shells Merlijn_equip[47]
		set FIRE_SUIT Merlijn_equip[48]
		set GAS_MASK Merlijn_equip[49]
		set tesla_ammo Merlijn_equip[50]
		set SCARABKEYS Merlijn_equip[51]
		set COGS Merlijn_equip[52]
		set TOOLBOX Merlijn_equip[54]
		set flechete_shells Merlijn_equip[55]
		set silver_bolts Merlijn_equip[56]
		set NORMAL_KEYS Merlijn_equip[57]
		set micro_torpedo Merlijn_equip[58]
		set magnum_shells Merlijn_equip[59]
		set heat_seek_card Merlijn_equip[60]
		set atomic_bomb Merlijn_equip[61]
		set DUP_missile_ammo Merlijn_equip[62]
		set SW_KEYS Merlijn_equip[63]
		set fortymm_grenades Merlijn_equip[64]
		set fortymm_shells Merlijn_equip[65]
		set fortymm_MIA_shells Merlijn_equip[66]
		set fortymm_plasma Merlijn_equip[67]
		set fortymm_caseless Merlijn_equip[68]
		set fortymm_electro Merlijn_equip[69]
		set fortymm_slug Merlijn_equip[70]
		set fortymm_cryo Merlijn_equip[71]
		set ROPE Merlijn_equip[72]
		set SHOTGUNMAG Merlijn_equip[73]
		set SHOTGUNBOXMAG Merlijn_equip[74]
		set dragon_shells Merlijn_equip[75]
		set GOT_KNIFE Merlijn_equip[76]
		set riot_shield Merlijn_equip[77]
		set gun_firemode_two Merlijn_equip[78]
		set P_HAS_SHIELD Merlijn_equip[79]
		}
	ife CHAR 3
		{
		set temp_weap Highwire_equip[43]
		setp[].ammo_amount 0 Highwire_equip[1]
		setp[].gotweapon 1 Highwire_equip[2]
		setp[].ammo_amount 1 Highwire_equip[3]
		setp[].gotweapon 2 Highwire_equip[4]
		setp[].ammo_amount 2 Highwire_equip[5]
		setp[].gotweapon 3 Highwire_equip[6]
		setp[].ammo_amount 3 Highwire_equip[7]
		setp[].gotweapon 4 Highwire_equip[8] // RPG
		setp[].ammo_amount 4 Highwire_equip[9]
		setp[].ammo_amount 5 Highwire_equip[10] // Pipebomb
		setp[].gotweapon 6 Highwire_equip[11] // Shrinker
		setp[].ammo_amount 6 Highwire_equip[12]
		setp[].gotweapon 7 Highwire_equip[13] // Devistator
		setp[].ammo_amount 7 Highwire_equip[14]
		setp[].ammo_amount 8 Highwire_equip[15] // Tripbomb
		setp[].gotweapon 9 Highwire_equip[16] // Freezer
		setp[].ammo_amount 9 Highwire_equip[17]
		setp[].gotweapon 11 Highwire_equip[18] // Expander
		setp[].ammo_amount 11 Highwire_equip[19]

		getp[].i temp7
		ife Highwire_equip[20] 0 setarray Highwire_equip[20] 100
		seta[temp7].extra Highwire_equip[20]
		ife Highwire_equip[21] 0 setarray Highwire_equip[21] 100
		setp[].max_player_health Highwire_equip[21]

		setp[].shield_amount Highwire_equip[22]
		set P_SPIRIT_ARMOUR Highwire_equip[23]
		set P_FIRE_ARMOUR Highwire_equip[53]
		set HIGHWIRE_UPGRADE Highwire_equip[24]
		set gun_firemode Highwire_equip[25]
		set guns_akimbo Highwire_equip[26]
		set GOT_EXPLOSIVE Highwire_equip[27]
		set AIR_FILTER Highwire_equip[28]
		set PISTOLMAG Highwire_equip[29]
		set MGUNMAG Highwire_equip[30]
		set RUNEKEYS Highwire_equip[31]
		set ACCESSKEY2 Highwire_equip[32]
		set PLUGKEY Highwire_equip[33]
		set HELLGKEYS Highwire_equip[34]
		set OLDKEYS Highwire_equip[35]
		set GENERIC_KEYS Highwire_equip[45]
		setp[].got_access Highwire_equip[44]
		setp[].boot_amount Highwire_equip[36]
		setp[].heat_amount Highwire_equip[37]
		setp[].holoduke_amount Highwire_equip[38]
		setp[].jetpack_amount Highwire_equip[39]
		setp[].scuba_amount Highwire_equip[40]
		setp[].firstaid_amount Highwire_equip[41]
		setp[].steroids_amount Highwire_equip[42]
		set silver_ammo Highwire_equip[46]
		set explosive_shells Highwire_equip[47]
		set FIRE_SUIT Highwire_equip[48]
		set GAS_MASK Highwire_equip[49]
		set tesla_ammo Highwire_equip[50]
		set SCARABKEYS Highwire_equip[51]
		set COGS Highwire_equip[52]
		set TOOLBOX Highwire_equip[54]
		set flechete_shells Highwire_equip[55]
		set silver_bolts Highwire_equip[56]
		set NORMAL_KEYS Highwire_equip[57]
		set micro_torpedo Highwire_equip[58]
		set magnum_shells Highwire_equip[59]
		set heat_seek_card Highwire_equip[60]
		set atomic_bomb Highwire_equip[61]
		set DUP_missile_ammo Highwire_equip[62]
		set SW_KEYS Highwire_equip[63]
		set fortymm_grenades Highwire_equip[64]
		set fortymm_shells Highwire_equip[65]
		set fortymm_MIA_shells Highwire_equip[66]
		set fortymm_plasma Highwire_equip[67]
		set fortymm_caseless Highwire_equip[68]
		set fortymm_electro Highwire_equip[69]
		set fortymm_slug Highwire_equip[70]
		set fortymm_cryo Highwire_equip[71]
		set ROPE Highwire_equip[72]
		set SHOTGUNMAG Highwire_equip[73]
		set SHOTGUNBOXMAG Highwire_equip[74]
		set dragon_shells Highwire_equip[75]
		set GOT_KNIFE Highwire_equip[76]
		set riot_shield Highwire_equip[77]
		set gun_firemode_two Highwire_equip[78]
		set P_HAS_SHIELD Highwire_equip[79]
		}
	ife CHAR 4
		{
		set temp_weap Sang_equip[43]
		setp[].ammo_amount 0 Sang_equip[1]
		setp[].gotweapon 1 Sang_equip[2]
		setp[].ammo_amount 1 Sang_equip[3]
		setp[].gotweapon 2 Sang_equip[4]
		setp[].ammo_amount 2 Sang_equip[5]
		setp[].gotweapon 3 Sang_equip[6]
		setp[].ammo_amount 3 Sang_equip[7]
		setp[].gotweapon 4 Sang_equip[8] // RPG
		setp[].ammo_amount 4 Sang_equip[9]
		setp[].ammo_amount 5 Sang_equip[10] // Pipebomb
		setp[].gotweapon 6 Sang_equip[11] // Shrinker
		setp[].ammo_amount 6 Sang_equip[12]
		setp[].gotweapon 7 Sang_equip[13] // Devistator
		setp[].ammo_amount 7 Sang_equip[14]
		setp[].ammo_amount 8 Sang_equip[15] // Tripbomb
		setp[].gotweapon 9 Sang_equip[16] // Freezer
		setp[].ammo_amount 9 Sang_equip[17]
		setp[].gotweapon 11 Sang_equip[18] // Expander
		setp[].ammo_amount 11 Sang_equip[19]

		getp[].i temp7
		ife Sang_equip[20] 0 setarray Sang_equip[20] 75
		seta[temp7].extra Sang_equip[20]
		ife Sang_equip[21] 0 setarray Sang_equip[21] 75
		setp[].max_player_health Sang_equip[21]

		setp[].shield_amount Sang_equip[22]
		set P_SPIRIT_ARMOUR Sang_equip[23]
		set P_FIRE_ARMOUR Sang_equip[53]
		set SANG_UPGRADE Sang_equip[24]
		set gun_firemode Sang_equip[25]
		set guns_akimbo Sang_equip[26]
		set GOT_EXPLOSIVE Sang_equip[27]
		set AIR_FILTER Sang_equip[28]
		set PISTOLMAG Sang_equip[29]
		set MGUNMAG Sang_equip[30]
		set RUNEKEYS Sang_equip[31]
		set ACCESSKEY2 Sang_equip[32]
		set PLUGKEY Sang_equip[33]
		set HELLGKEYS Sang_equip[34]
		set OLDKEYS Sang_equip[35]
		set GENERIC_KEYS Sang_equip[45]
		setp[].got_access Sang_equip[44]
		setp[].boot_amount Sang_equip[36]
		setp[].heat_amount Sang_equip[37]
		setp[].holoduke_amount Sang_equip[38]
		setp[].jetpack_amount Sang_equip[39]
		setp[].scuba_amount Sang_equip[40]
		setp[].firstaid_amount Sang_equip[41]
		setp[].steroids_amount Sang_equip[42]
		set silver_ammo Sang_equip[46]
		set explosive_shells Sang_equip[47]
		set FIRE_SUIT Sang_equip[48]
		set GAS_MASK Sang_equip[49]
		set tesla_ammo Sang_equip[50]
		set SCARABKEYS Sang_equip[51]
		set COGS Sang_equip[52]
		set TOOLBOX Sang_equip[54]
		set flechete_shells Sang_equip[55]
		set silver_bolts Sang_equip[56]
		set NORMAL_KEYS Sang_equip[57]
		set micro_torpedo Sang_equip[58]
		set magnum_shells Sang_equip[59]
		set heat_seek_card Sang_equip[60]
		set atomic_bomb Sang_equip[61]
		set DUP_missile_ammo Sang_equip[62]
		set SW_KEYS Sang_equip[63]
		set fortymm_grenades Sang_equip[64]
		set fortymm_shells Sang_equip[65]
		set fortymm_MIA_shells Sang_equip[66]
		set fortymm_plasma Sang_equip[67]
		set fortymm_caseless Sang_equip[68]
		set fortymm_electro Sang_equip[69]
		set fortymm_slug Sang_equip[70]
		set fortymm_cryo Sang_equip[71]
		set ROPE Sang_equip[72]
		set SHOTGUNMAG Sang_equip[73]
		set SHOTGUNBOXMAG Sang_equip[74]
		set dragon_shells Sang_equip[75]
		set GOT_KNIFE Sang_equip[76]
		set riot_shield Sang_equip[77]
		set gun_firemode_two Sang_equip[78]
		set P_HAS_SHIELD Sang_equip[79]
		}
	ife CHAR 5
		{
		set temp_weap Rusty_equip[43]
		setp[].ammo_amount 0 Rusty_equip[1]
		setp[].gotweapon 1 Rusty_equip[2]
		setp[].ammo_amount 1 Rusty_equip[3]
		setp[].gotweapon 2 Rusty_equip[4]
		setp[].ammo_amount 2 Rusty_equip[5]
		setp[].gotweapon 3 Rusty_equip[6]
		setp[].ammo_amount 3 Rusty_equip[7]
		setp[].gotweapon 4 Rusty_equip[8] // RPG
		setp[].ammo_amount 4 Rusty_equip[9]
		setp[].ammo_amount 5 Rusty_equip[10] // Pipebomb
		setp[].gotweapon 6 Rusty_equip[11] // Shrinker
		setp[].ammo_amount 6 Rusty_equip[12]
		setp[].gotweapon 7 Rusty_equip[13] // Devistator
		setp[].ammo_amount 7 Rusty_equip[14]
		setp[].ammo_amount 8 Rusty_equip[15] // Tripbomb
		setp[].gotweapon 9 Rusty_equip[16] // Freezer
		setp[].ammo_amount 9 Rusty_equip[17]
		setp[].gotweapon 11 Rusty_equip[18] // Expander
		setp[].ammo_amount 11 Rusty_equip[19]

		getp[].i temp7
		ife Rusty_equip[20] 0 setarray Rusty_equip[20] 125
		seta[temp7].extra Rusty_equip[20]
		ife Rusty_equip[21] 0 setarray Rusty_equip[21] 125
		setp[].max_player_health Rusty_equip[21]

		setp[].shield_amount Rusty_equip[22]
		set P_SPIRIT_ARMOUR Rusty_equip[23]
		set P_FIRE_ARMOUR Rusty_equip[53]
		set RUSTY_UPGRADE Rusty_equip[24]
		set gun_firemode Rusty_equip[25]
		set guns_akimbo Rusty_equip[26]
		set GOT_EXPLOSIVE Rusty_equip[27]
		set AIR_FILTER Rusty_equip[28]
		set PISTOLMAG Rusty_equip[29]
		set MGUNMAG Rusty_equip[30]
		set RUNEKEYS Rusty_equip[31]
		set ACCESSKEY2 Rusty_equip[32]
		set PLUGKEY Rusty_equip[33]
		set HELLGKEYS Rusty_equip[34]
		set OLDKEYS Rusty_equip[35]
		set GENERIC_KEYS Rusty_equip[45]
		setp[].got_access Rusty_equip[44]
		setp[].boot_amount Rusty_equip[36]
		setp[].heat_amount Rusty_equip[37]
		setp[].holoduke_amount Rusty_equip[38]
		setp[].jetpack_amount Rusty_equip[39]
		setp[].scuba_amount Rusty_equip[40]
		setp[].firstaid_amount Rusty_equip[41]
		setp[].steroids_amount Rusty_equip[42]
		set silver_ammo Rusty_equip[46]
		set explosive_shells Rusty_equip[47]
		set FIRE_SUIT Rusty_equip[48]
		set GAS_MASK Rusty_equip[49]
		set tesla_ammo Rusty_equip[50]
		set SCARABKEYS Rusty_equip[51]
		set COGS Rusty_equip[52]
		set TOOLBOX Rusty_equip[54]
		set flechete_shells Rusty_equip[55]
		set silver_bolts Rusty_equip[56]
		set NORMAL_KEYS Rusty_equip[57]
		set micro_torpedo Rusty_equip[58]
		set magnum_shells Rusty_equip[59]
		set heat_seek_card Rusty_equip[60]
		set atomic_bomb Rusty_equip[61]
		set DUP_missile_ammo Rusty_equip[62]
		set SW_KEYS Rusty_equip[63]
		set fortymm_grenades Rusty_equip[64]
		set fortymm_shells Rusty_equip[65]
		set fortymm_MIA_shells Rusty_equip[66]
		set fortymm_plasma Rusty_equip[67]
		set fortymm_caseless Rusty_equip[68]
		set fortymm_electro Rusty_equip[69]
		set fortymm_slug Rusty_equip[70]
		set fortymm_cryo Rusty_equip[71]
		set ROPE Rusty_equip[72]
		set SHOTGUNMAG Rusty_equip[73]
		set SHOTGUNBOXMAG Rusty_equip[74]
		set dragon_shells Rusty_equip[75]
		set GOT_KNIFE Rusty_equip[76]
		set riot_shield Rusty_equip[77]
		set gun_firemode_two Rusty_equip[78]
		set P_HAS_SHIELD Rusty_equip[79]
		}
	ife CHAR 6
		{
		set temp_weap Geoffrey_equip[43]
		setp[].ammo_amount 0 Geoffrey_equip[1]
		setp[].gotweapon 1 Geoffrey_equip[2]
		setp[].ammo_amount 1 Geoffrey_equip[3]
		setp[].gotweapon 2 Geoffrey_equip[4]
		setp[].ammo_amount 2 Geoffrey_equip[5]
		setp[].gotweapon 3 Geoffrey_equip[6]
		setp[].ammo_amount 3 Geoffrey_equip[7]
		setp[].gotweapon 4 Geoffrey_equip[8] // RPG
		setp[].ammo_amount 4 Geoffrey_equip[9]
		setp[].ammo_amount 5 Geoffrey_equip[10] // Pipebomb
		setp[].gotweapon 6 Geoffrey_equip[11] // Shrinker
		setp[].ammo_amount 6 Geoffrey_equip[12]
		setp[].gotweapon 7 Geoffrey_equip[13] // Devistator
		setp[].ammo_amount 7 Geoffrey_equip[14]
		setp[].ammo_amount 8 Geoffrey_equip[15] // Tripbomb
		setp[].gotweapon 9 Geoffrey_equip[16] // Freezer
		setp[].ammo_amount 9 Geoffrey_equip[17]
		setp[].gotweapon 11 Geoffrey_equip[18] // Expander
		setp[].ammo_amount 11 Geoffrey_equip[19]

		getp[].i temp7
		ife Geoffrey_equip[20] 0 setarray Geoffrey_equip[20] 125
		seta[temp7].extra Geoffrey_equip[20]
		ife Geoffrey_equip[21] 0 setarray Geoffrey_equip[21] 125
		setp[].max_player_health Geoffrey_equip[21]

		setp[].shield_amount Geoffrey_equip[22]
		set P_SPIRIT_ARMOUR Geoffrey_equip[23]
		set P_FIRE_ARMOUR Geoffrey_equip[53]
		set GEOFFREY_UPGRADE Geoffrey_equip[24]
		set gun_firemode Geoffrey_equip[25]
		set guns_akimbo Geoffrey_equip[26]
		set GOT_EXPLOSIVE Geoffrey_equip[27]
		set AIR_FILTER Geoffrey_equip[28]
		set PISTOLMAG Geoffrey_equip[29]
		set MGUNMAG Geoffrey_equip[30]
		set RUNEKEYS Geoffrey_equip[31]
		set ACCESSKEY2 Geoffrey_equip[32]
		set PLUGKEY Geoffrey_equip[33]
		set HELLGKEYS Geoffrey_equip[34]
		set OLDKEYS Geoffrey_equip[35]
		set GENERIC_KEYS Geoffrey_equip[45]
		setp[].got_access Geoffrey_equip[44]
		setp[].boot_amount Geoffrey_equip[36]
		setp[].heat_amount Geoffrey_equip[37]
		setp[].holoduke_amount Geoffrey_equip[38]
		setp[].jetpack_amount Geoffrey_equip[39]
		setp[].scuba_amount Geoffrey_equip[40]
		setp[].firstaid_amount Geoffrey_equip[41]
		setp[].steroids_amount Geoffrey_equip[42]
		set silver_ammo Geoffrey_equip[46]
		set explosive_shells Geoffrey_equip[47]
		set FIRE_SUIT Geoffrey_equip[48]
		set GAS_MASK Geoffrey_equip[49]
		set tesla_ammo Geoffrey_equip[50]
		set SCARABKEYS Geoffrey_equip[51]
		set COGS Geoffrey_equip[52]
		set TOOLBOX Geoffrey_equip[54]
		set flechete_shells Geoffrey_equip[55]
		set silver_bolts Geoffrey_equip[56]
		set NORMAL_KEYS Geoffrey_equip[57]
		set micro_torpedo Geoffrey_equip[58]
		set magnum_shells Geoffrey_equip[59]
		set heat_seek_card Geoffrey_equip[60]
		set atomic_bomb Geoffrey_equip[61]
		set DUP_missile_ammo Geoffrey_equip[62]
		set SW_KEYS Geoffrey_equip[63]
		set fortymm_grenades Geoffrey_equip[64]
		set fortymm_shells Geoffrey_equip[65]
		set fortymm_MIA_shells Geoffrey_equip[66]
		set fortymm_plasma Geoffrey_equip[67]
		set fortymm_caseless Geoffrey_equip[68]
		set fortymm_electro Geoffrey_equip[69]
		set fortymm_slug Geoffrey_equip[70]
		set fortymm_cryo Geoffrey_equip[71]
		set ROPE Geoffrey_equip[72]
		set SHOTGUNMAG Geoffrey_equip[73]
		set SHOTGUNBOXMAG Geoffrey_equip[74]
		set dragon_shells Geoffrey_equip[75]
		set GOT_KNIFE Geoffrey_equip[76]
		set riot_shield Geoffrey_equip[77]
		set gun_firemode_two Geoffrey_equip[78]
		set P_HAS_SHIELD Geoffrey_equip[79]
		}
	ife CHAR 7
		{
		set temp_weap Mikko_equip[43]
		setp[].ammo_amount 0 Mikko_equip[1]
		setp[].gotweapon 1 Mikko_equip[2]
		setp[].ammo_amount 1 Mikko_equip[3]
		setp[].gotweapon 2 Mikko_equip[4]
		setp[].ammo_amount 2 Mikko_equip[5]
		setp[].gotweapon 3 Mikko_equip[6]
		setp[].ammo_amount 3 Mikko_equip[7]
		setp[].gotweapon 4 Mikko_equip[8] // RPG
		setp[].ammo_amount 4 Mikko_equip[9]
		setp[].ammo_amount 5 Mikko_equip[10] // Pipebomb
		setp[].gotweapon 6 Mikko_equip[11] // Shrinker
		setp[].ammo_amount 6 Mikko_equip[12]
		setp[].gotweapon 7 Mikko_equip[13] // Devistator
		setp[].ammo_amount 7 Mikko_equip[14]
		setp[].ammo_amount 8 Mikko_equip[15] // Tripbomb
		setp[].gotweapon 9 Mikko_equip[16] // Freezer
		setp[].ammo_amount 9 Mikko_equip[17]
		setp[].gotweapon 11 Mikko_equip[18] // Expander
		setp[].ammo_amount 11 Mikko_equip[19]

		getp[].i temp7
		ife Mikko_equip[20] 0 setarray Mikko_equip[20] 150
		seta[temp7].extra Mikko_equip[20]
		ife Mikko_equip[21] 0 setarray Mikko_equip[21] 150
		setp[].max_player_health Mikko_equip[21]

		setp[].shield_amount Mikko_equip[22]
		set P_SPIRIT_ARMOUR Mikko_equip[23]
		set P_FIRE_ARMOUR Mikko_equip[53]
		set MIKKO_UPGRADE Mikko_equip[24]
		set gun_firemode Mikko_equip[25]
		set guns_akimbo Mikko_equip[26]
		set GOT_EXPLOSIVE Mikko_equip[27]
		set AIR_FILTER Mikko_equip[28]
		set PISTOLMAG Mikko_equip[29]
		set MGUNMAG Mikko_equip[30]
		set RUNEKEYS Mikko_equip[31]
		set ACCESSKEY2 Mikko_equip[32]
		set PLUGKEY Mikko_equip[33]
		set HELLGKEYS Mikko_equip[34]
		set OLDKEYS Mikko_equip[35]
		set GENERIC_KEYS Mikko_equip[45]
		setp[].got_access Mikko_equip[44]
		setp[].boot_amount Mikko_equip[36]
		setp[].heat_amount Mikko_equip[37]
		setp[].holoduke_amount Mikko_equip[38]
		setp[].jetpack_amount Mikko_equip[39]
		setp[].scuba_amount Mikko_equip[40]
		setp[].firstaid_amount Mikko_equip[41]
		setp[].steroids_amount Mikko_equip[42]
		set silver_ammo Mikko_equip[46]
		set explosive_shells Mikko_equip[47]
		set FIRE_SUIT Mikko_equip[48]
		set GAS_MASK Mikko_equip[49]
		set tesla_ammo Mikko_equip[50]
		set SCARABKEYS Mikko_equip[51]
		set COGS Mikko_equip[52]
		set TOOLBOX Mikko_equip[54]
		set flechete_shells Mikko_equip[55]
		set silver_bolts Mikko_equip[56]
		set NORMAL_KEYS Mikko_equip[57]
		set micro_torpedo Mikko_equip[58]
		set magnum_shells Mikko_equip[59]
		set heat_seek_card Mikko_equip[60]
		set atomic_bomb Mikko_equip[61]
		set DUP_missile_ammo Mikko_equip[62]
		set SW_KEYS Mikko_equip[63]
		set fortymm_grenades Mikko_equip[64]
		set fortymm_shells Mikko_equip[65]
		set fortymm_MIA_shells Mikko_equip[66]
		set fortymm_plasma Mikko_equip[67]
		set fortymm_caseless Mikko_equip[68]
		set fortymm_electro Mikko_equip[69]
		set fortymm_slug Mikko_equip[70]
		set fortymm_cryo Mikko_equip[71]
		set ROPE Mikko_equip[72]
		set SHOTGUNMAG Mikko_equip[73]
		set SHOTGUNBOXMAG Mikko_equip[74]
		set dragon_shells Mikko_equip[75]
		set GOT_KNIFE Mikko_equip[76]
		set riot_shield Mikko_equip[77]
		set gun_firemode_two Mikko_equip[78]
		set P_HAS_SHIELD Mikko_equip[79]
		}
	ife CHAR 9 // Cultist
		{
		set temp_weap 0
		setp[].ammo_amount 0 0
		setp[].gotweapon 1 1
		setp[].ammo_amount 1 96
		setp[].gotweapon 2 0
		setp[].ammo_amount 2 0
		setp[].gotweapon 3 0
		setp[].ammo_amount 3 0
		setp[].gotweapon 4 0 // RPG
		setp[].ammo_amount 4 0
		setp[].ammo_amount 5 5 // Pipebomb
		setp[].gotweapon 6 0 // Shrinker
		setp[].ammo_amount 6 0
		setp[].gotweapon 7 0 // Devistator
		setp[].ammo_amount 7 0
		setp[].ammo_amount 8 0 // Tripbomb
		setp[].gotweapon 9 0 // Freezer
		setp[].ammo_amount 9 0
		setp[].gotweapon 11 0 // Expander
		setp[].ammo_amount 11 0

		getp[].i temp7
		seta[temp7].extra 100
		setp[].max_player_health 200

		whilevarn temp 16
			{
			setarray AMMO_TYPES[temp] 0
			add temp 1
			}

		setp[].shield_amount 100
		set P_SPIRIT_ARMOUR 0
		set gun_firemode 0
		set gun_firemode_two 0
		set guns_akimbo 0
		set GOT_EXPLOSIVE 0
		set AIR_FILTER 0
		set PISTOLMAG 0
		set MGUNMAG 0
		set RUNEKEYS 0
		set ACCESSKEY2 0
		set PLUGKEY 0
		set HELLGKEYS 0
		set OLDKEYS 0
		set GENERIC_KEYS 2
		setp[].got_access 0
		setp[].boot_amount 0
		setp[].heat_amount 0
		setp[].holoduke_amount 0
		setp[].jetpack_amount 0
		setp[].scuba_amount 0
		setp[].firstaid_amount 0
		setp[].steroids_amount 0
		set silver_ammo 0
		set explosive_shells 0
		set flechete_shells 0
		set dragon_shells 0
		set FIRE_SUIT 0
		set GAS_MASK 0
		set tesla_ammo 0
		set SCARABKEYS 0
		set COGS 0
		set TOOLBOX 0
		set silver_bolts 0
		}
	ife CHAR 10 // Bombshell
		{
		set temp_weap 0
		setp[].ammo_amount 0 0
		setp[].gotweapon 1 1
		setp[].ammo_amount 1 64
		setp[].gotweapon 2 0
		setp[].ammo_amount 2 0
		setp[].gotweapon 3 1
		setp[].ammo_amount 3 250
		setp[].gotweapon 4 0 // RPG
		setp[].ammo_amount 4 0
		setp[].ammo_amount 5 5 // Pipebomb
		setp[].gotweapon 6 1 // Shrinker
		setp[].ammo_amount 6 40
		setp[].gotweapon 7 0 // Devistator
		setp[].ammo_amount 7 0
		setp[].ammo_amount 8 0 // Tripbomb
		setp[].gotweapon 9 1 // Freezer
		setp[].ammo_amount 9 75
		setp[].gotweapon 11 1 // Expander
		setp[].ammo_amount 11 10

		getp[].i temp7
		seta[temp7].extra 100
		setp[].max_player_health 100

		whilevarn temp 16
			{
			setarray AMMO_TYPES[temp] 0
			add temp 1
			}

		setp[].shield_amount 100
		set P_SPIRIT_ARMOUR 0
		set gun_firemode 0
		set gun_firemode_two 0
		set guns_akimbo 0
		set GOT_EXPLOSIVE 0
		set AIR_FILTER 0
		set PISTOLMAG 0
		set MGUNMAG 0
		set RUNEKEYS 0
		set ACCESSKEY2 0
		set PLUGKEY 0
		set HELLGKEYS 0
		set OLDKEYS 0
		set GENERIC_KEYS 0
		setp[].got_access 0
		setp[].boot_amount 0
		setp[].heat_amount 0
		setp[].holoduke_amount 0
		setp[].jetpack_amount 0
		setp[].scuba_amount 0
		setp[].firstaid_amount 100
		setp[].steroids_amount 0
		set silver_ammo 0
		set explosive_shells 0
		set flechete_shells 0
		set magnum_shells 0
		set silver_bolts 0
		set fortymm_grenades 3
		set FIRE_SUIT 0
		set GAS_MASK 1
		set tesla_ammo 0
		set SCARABKEYS 0
		set COGS 0
		set TOOLBOX 1
		set silver_bolts 0
		}
	ife CHAR 11 // Maartn
		{
		set temp_weap 0
		setp[].ammo_amount 0 0
		setp[].gotweapon 1 1
		setp[].ammo_amount 1 1
		setp[].gotweapon 2 1
		setp[].ammo_amount 2 10
		setp[].gotweapon 3 0
		setp[].ammo_amount 3 0
		setp[].gotweapon 4 0 // RPG
		setp[].ammo_amount 4 0
		setp[].ammo_amount 5 5 // Pipebomb
		setp[].gotweapon 6 0 // Shrinker
		setp[].ammo_amount 6 0
		setp[].gotweapon 7 0 // Devistator
		setp[].ammo_amount 7 0
		setp[].ammo_amount 8 0 // Tripbomb
		setp[].gotweapon 9 0 // Freezer
		setp[].ammo_amount 9 0
		setp[].gotweapon 11 0 // Expander
		setp[].ammo_amount 11 0

		getp[].i temp7
		seta[temp7].extra 100
		setp[].max_player_health 200

		whilevarn temp 16
			{
			setarray AMMO_TYPES[temp] 0
			add temp 1
			}

		setp[].shield_amount 100
		set P_SPIRIT_ARMOUR 0
		set gun_firemode 0
		set gun_firemode_two 0
		set guns_akimbo 0
		set GOT_EXPLOSIVE 0
		set AIR_FILTER 0
		set PISTOLMAG 0
		set MGUNMAG 0
		set RUNEKEYS 0
		set ACCESSKEY2 0
		set PLUGKEY 0
		set HELLGKEYS 0
		set OLDKEYS 0
		set GENERIC_KEYS 2
		setp[].got_access 0
		setp[].boot_amount 0
		setp[].heat_amount 0
		setp[].holoduke_amount 0
		setp[].jetpack_amount 0
		setp[].scuba_amount 0
		setp[].firstaid_amount 0
		setp[].steroids_amount 0
		set silver_ammo 0
		set explosive_shells 0
		set flechete_shells 0
		set dragon_shells 0
		set FIRE_SUIT 0
		set GAS_MASK 0
		set tesla_ammo 0
		set SCARABKEYS 0
		set COGS 0
		set TOOLBOX 0
		set silver_bolts 0
		}
	ife CHAR 12 // JANE
		{
		set temp_weap 0
		setp[].ammo_amount 0 0
		setp[].gotweapon 1 1
		setp[].ammo_amount 1 96
		setp[].gotweapon 2 0
		setp[].ammo_amount 2 0
		setp[].gotweapon 3 0
		setp[].ammo_amount 3 0
		setp[].gotweapon 4 0 // RPG
		setp[].ammo_amount 4 0
		setp[].ammo_amount 5 5 // Pipebomb
		setp[].gotweapon 6 0 // Shrinker
		setp[].ammo_amount 6 0
		setp[].gotweapon 7 0 // Devistator
		setp[].ammo_amount 7 0
		setp[].ammo_amount 8 0 // Tripbomb
		setp[].gotweapon 9 0 // Freezer
		setp[].ammo_amount 9 0
		setp[].gotweapon 11 0 // Expander
		setp[].ammo_amount 11 0

		getp[].i temp7
		seta[temp7].extra 100
		setp[].max_player_health 100

		whilevarn temp 16
			{
			setarray AMMO_TYPES[temp] 0
			add temp 1
			}

		setp[].shield_amount 100
		set P_SPIRIT_ARMOUR 0
		set gun_firemode 0
		set gun_firemode_two 0
		set guns_akimbo 0
		set GOT_EXPLOSIVE 0
		set AIR_FILTER 0
		set PISTOLMAG 0
		set MGUNMAG 0
		set RUNEKEYS 0
		set ACCESSKEY2 0
		set PLUGKEY 0
		set HELLGKEYS 0
		set OLDKEYS 0
		set GENERIC_KEYS 0
		setp[].got_access 0
		setp[].boot_amount 0
		setp[].heat_amount 0
		setp[].holoduke_amount 0
		setp[].jetpack_amount 0
		setp[].scuba_amount 0
		setp[].firstaid_amount 0
		setp[].steroids_amount 0
		set silver_ammo 0
		set explosive_shells 0
		set flechete_shells 0
		set FIRE_SUIT 0
		set GAS_MASK 0
		set tesla_ammo 0
		set SCARABKEYS 0
		set COGS 0
		set TOOLBOX 0
		set silver_bolts 0
		}
	ife CHAR 13 // Micky
		{
		set temp_weap Micky_equip[43]
		setp[].ammo_amount 0 Micky_equip[1]
		setp[].gotweapon 1 Micky_equip[2]
		setp[].ammo_amount 1 Micky_equip[3]
		setp[].gotweapon 2 Micky_equip[4]
		setp[].ammo_amount 2 Micky_equip[5]
		setp[].gotweapon 3 Micky_equip[6]
		setp[].ammo_amount 3 Micky_equip[7]
		setp[].gotweapon 4 Micky_equip[8] // RPG
		setp[].ammo_amount 4 Micky_equip[9]
		setp[].ammo_amount 5 Micky_equip[10] // Pipebomb
		setp[].gotweapon 6 Micky_equip[11] // Shrinker
		setp[].ammo_amount 6 Micky_equip[12]
		setp[].gotweapon 7 Micky_equip[13] // Devistator
		setp[].ammo_amount 7 Micky_equip[14]
		setp[].ammo_amount 8 Micky_equip[15] // Tripbomb
		setp[].gotweapon 9 Micky_equip[16] // Freezer
		setp[].ammo_amount 9 Micky_equip[17]
		setp[].gotweapon 11 Micky_equip[18] // Expander
		setp[].ammo_amount 11 Micky_equip[19]

		getp[].i temp7
		ife Micky_equip[20] 0 setarray Micky_equip[20] 100
		seta[temp7].extra Micky_equip[20]
		ife Micky_equip[21] 0 setarray Micky_equip[21] 100
		setp[].max_player_health Micky_equip[21]

		setp[].shield_amount Micky_equip[22]
		set P_SPIRIT_ARMOUR Micky_equip[23]
		set P_FIRE_ARMOUR Micky_equip[53]
		set MICKY_UPGRADE Micky_equip[24]
		set gun_firemode Micky_equip[25]
		set guns_akimbo Micky_equip[26]
		set GOT_EXPLOSIVE Micky_equip[27]
		set AIR_FILTER Micky_equip[28]
		set PISTOLMAG Micky_equip[29]
		set MGUNMAG Micky_equip[30]
		set RUNEKEYS Micky_equip[31]
		set ACCESSKEY2 Micky_equip[32]
		set PLUGKEY Micky_equip[33]
		set HELLGKEYS Micky_equip[34]
		set OLDKEYS Micky_equip[35]
		set GENERIC_KEYS Micky_equip[45]
		setp[].got_access Micky_equip[44]
		setp[].boot_amount Micky_equip[36]
		setp[].heat_amount Micky_equip[37]
		setp[].holoduke_amount Micky_equip[38]
		setp[].jetpack_amount Micky_equip[39]
		setp[].scuba_amount Micky_equip[40]
		setp[].firstaid_amount Micky_equip[41]
		setp[].steroids_amount Micky_equip[42]
		set silver_ammo Micky_equip[46]
		set explosive_shells Micky_equip[47]
		set FIRE_SUIT Micky_equip[48]
		set GAS_MASK Micky_equip[49]
		set tesla_ammo Micky_equip[50]
		set SCARABKEYS Micky_equip[51]
		set COGS Micky_equip[52]
		set TOOLBOX Micky_equip[54]
		set flechete_shells Micky_equip[55]
		set silver_bolts Micky_equip[56]
		set NORMAL_KEYS Micky_equip[57]
		set micro_torpedo Micky_equip[58]
		set magnum_shells Micky_equip[59]
		set heat_seek_card Micky_equip[60]
		set atomic_bomb Micky_equip[61]
		set DUP_missile_ammo Micky_equip[62]
		set SW_KEYS Micky_equip[63]
		set fortymm_grenades Micky_equip[64]
		set fortymm_shells Micky_equip[65]
		set fortymm_MIA_shells Micky_equip[66]
		set fortymm_plasma Micky_equip[67]
		set fortymm_caseless Micky_equip[68]
		set fortymm_electro Micky_equip[69]
		set fortymm_slug Micky_equip[70]
		set fortymm_cryo Micky_equip[71]
		set ROPE Micky_equip[72]
		set SHOTGUNMAG Micky_equip[73]
		set SHOTGUNBOXMAG Micky_equip[74]
		set dragon_shells Micky_equip[75]
		set GOT_KNIFE Micky_equip[76]
		set riot_shield Micky_equip[77]
		set gun_firemode_two Micky_equip[78]
		set P_HAS_SHIELD Micky_equip[79]
		}
	ife CHAR 14 // Snowfall
		{
		set temp_weap Snowfall_equip[43]
		setp[].ammo_amount 0 Snowfall_equip[1]
		setp[].gotweapon 1 Snowfall_equip[2]
		setp[].ammo_amount 1 Snowfall_equip[3]
		setp[].gotweapon 2 Snowfall_equip[4]
		setp[].ammo_amount 2 Snowfall_equip[5]
		setp[].gotweapon 3 Snowfall_equip[6]
		setp[].ammo_amount 3 Snowfall_equip[7]
		setp[].gotweapon 4 Snowfall_equip[8] // RPG
		setp[].ammo_amount 4 Snowfall_equip[9]
		setp[].ammo_amount 5 Snowfall_equip[10] // Pipebomb
		setp[].gotweapon 6 Snowfall_equip[11] // Shrinker
		setp[].ammo_amount 6 Snowfall_equip[12]
		setp[].gotweapon 7 Snowfall_equip[13] // Devistator
		setp[].ammo_amount 7 Snowfall_equip[14]
		setp[].ammo_amount 8 Snowfall_equip[15] // Tripbomb
		setp[].gotweapon 9 Snowfall_equip[16] // Freezer
		setp[].ammo_amount 9 Snowfall_equip[17]
		setp[].gotweapon 11 Snowfall_equip[18] // Expander
		setp[].ammo_amount 11 Snowfall_equip[19]

		getp[].i temp7
		ife Snowfall_equip[20] 0 setarray Snowfall_equip[20] 50
		seta[temp7].extra Snowfall_equip[20]
		ife Snowfall_equip[21] 0 setarray Snowfall_equip[21] 50
		setp[].max_player_health Snowfall_equip[21]

		setp[].shield_amount Snowfall_equip[22]
		set P_SPIRIT_ARMOUR Snowfall_equip[23]
		set P_FIRE_ARMOUR Snowfall_equip[53]
		set SNOWFALL_UPGRADE Snowfall_equip[24]
		set gun_firemode Snowfall_equip[25]
		set guns_akimbo Snowfall_equip[26]
		set GOT_EXPLOSIVE Snowfall_equip[27]
		set AIR_FILTER Snowfall_equip[28]
		set PISTOLMAG Snowfall_equip[29]
		set MGUNMAG Snowfall_equip[30]
		set RUNEKEYS Snowfall_equip[31]
		set ACCESSKEY2 Snowfall_equip[32]
		set PLUGKEY Snowfall_equip[33]
		set HELLGKEYS Snowfall_equip[34]
		set OLDKEYS Snowfall_equip[35]
		set GENERIC_KEYS Snowfall_equip[45]
		setp[].got_access Snowfall_equip[44]
		setp[].boot_amount Snowfall_equip[36]
		setp[].heat_amount Snowfall_equip[37]
		setp[].holoduke_amount Snowfall_equip[38]
		setp[].jetpack_amount Snowfall_equip[39]
		setp[].scuba_amount Snowfall_equip[40]
		setp[].firstaid_amount Snowfall_equip[41]
		setp[].steroids_amount Snowfall_equip[42]
		set silver_ammo Snowfall_equip[46]
		set explosive_shells Snowfall_equip[47]
		set FIRE_SUIT Snowfall_equip[48]
		set GAS_MASK Snowfall_equip[49]
		set tesla_ammo Snowfall_equip[50]
		set SCARABKEYS Snowfall_equip[51]
		set COGS Snowfall_equip[52]
		set TOOLBOX Snowfall_equip[54]
		set flechete_shells Snowfall_equip[55]
		set silver_bolts Snowfall_equip[56]
		set NORMAL_KEYS Snowfall_equip[57]
		set micro_torpedo Snowfall_equip[58]
		set magnum_shells Snowfall_equip[59]
		set heat_seek_card Snowfall_equip[60]
		set atomic_bomb Snowfall_equip[61]
		set DUP_missile_ammo Snowfall_equip[62]
		set SW_KEYS Snowfall_equip[63]
		set fortymm_grenades Snowfall_equip[64]
		set fortymm_shells Snowfall_equip[65]
		set fortymm_MIA_shells Snowfall_equip[66]
		set fortymm_plasma Snowfall_equip[67]
		set fortymm_caseless Snowfall_equip[68]
		set fortymm_electro Snowfall_equip[69]
		set fortymm_slug Snowfall_equip[70]
		set fortymm_cryo Snowfall_equip[71]
		set ROPE Snowfall_equip[72]
		set SHOTGUNMAG Snowfall_equip[73]
		set SHOTGUNBOXMAG Snowfall_equip[74]
		set dragon_shells Snowfall_equip[75]
		set GOT_KNIFE Snowfall_equip[76]
		set riot_shield Snowfall_equip[77]
		set gun_firemode_two Snowfall_equip[78]
		// set P_HAS_SHIELD Snowfall_equip[79] - Snowfall always has a energy shield by default
		}
	ife CHAR 17 // Kagura
		{
		set temp_weap Kagura_equip[43]
		setp[].ammo_amount 0 Kagura_equip[1]
		setp[].gotweapon 1 Kagura_equip[2]
		setp[].ammo_amount 1 Kagura_equip[3]
		setp[].gotweapon 2 Kagura_equip[4]
		setp[].ammo_amount 2 Kagura_equip[5]
		setp[].gotweapon 3 Kagura_equip[6]
		setp[].ammo_amount 3 Kagura_equip[7]
		setp[].gotweapon 4 Kagura_equip[8] // RPG
		setp[].ammo_amount 4 Kagura_equip[9]
		setp[].ammo_amount 5 Kagura_equip[10] // Pipebomb
		setp[].gotweapon 6 Kagura_equip[11] // Shrinker
		setp[].ammo_amount 6 Kagura_equip[12]
		setp[].gotweapon 7 Kagura_equip[13] // Devistator
		setp[].ammo_amount 7 Kagura_equip[14]
		setp[].ammo_amount 8 Kagura_equip[15] // Tripbomb
		setp[].gotweapon 9 Kagura_equip[16] // Freezer
		setp[].ammo_amount 9 Kagura_equip[17]
		setp[].gotweapon 11 Kagura_equip[18] // Expander
		setp[].ammo_amount 11 Kagura_equip[19]

		getp[].i temp7
		ife Kagura_equip[20] 0 setarray Kagura_equip[20] 50
		seta[temp7].extra Kagura_equip[20]
		ife Kagura_equip[21] 0 setarray Kagura_equip[21] 50
		setp[].max_player_health Kagura_equip[21]

		setp[].shield_amount Kagura_equip[22]
		set P_SPIRIT_ARMOUR Kagura_equip[23]
		set P_FIRE_ARMOUR Kagura_equip[53]
		set KAGURA_UPGRADE Kagura_equip[24]
		set gun_firemode Kagura_equip[25]
		set guns_akimbo Kagura_equip[26]
		set GOT_EXPLOSIVE Kagura_equip[27]
		set AIR_FILTER Kagura_equip[28]
		set PISTOLMAG Kagura_equip[29]
		set MGUNMAG Kagura_equip[30]
		set RUNEKEYS Kagura_equip[31]
		set ACCESSKEY2 Kagura_equip[32]
		set PLUGKEY Kagura_equip[33]
		set HELLGKEYS Kagura_equip[34]
		set OLDKEYS Kagura_equip[35]
		set GENERIC_KEYS Kagura_equip[45]
		setp[].got_access Kagura_equip[44]
		setp[].boot_amount Kagura_equip[36]
		setp[].heat_amount Kagura_equip[37]
		setp[].holoduke_amount Kagura_equip[38]
		setp[].jetpack_amount Kagura_equip[39]
		setp[].scuba_amount Kagura_equip[40]
		setp[].firstaid_amount Kagura_equip[41]
		setp[].steroids_amount Kagura_equip[42]
		set silver_ammo Kagura_equip[46]
		set explosive_shells Kagura_equip[47]
		set FIRE_SUIT Kagura_equip[48]
		set GAS_MASK Kagura_equip[49]
		set tesla_ammo Kagura_equip[50]
		set SCARABKEYS Kagura_equip[51]
		set COGS Kagura_equip[52]
		set TOOLBOX Kagura_equip[54]
		set flechete_shells Kagura_equip[55]
		set silver_bolts Kagura_equip[56]
		set NORMAL_KEYS Kagura_equip[57]
		set micro_torpedo Kagura_equip[58]
		set magnum_shells Kagura_equip[59]
		set heat_seek_card Kagura_equip[60]
		set atomic_bomb Kagura_equip[61]
		set DUP_missile_ammo Kagura_equip[62]
		set SW_KEYS Kagura_equip[63]
		set fortymm_grenades Kagura_equip[64]
		set fortymm_shells Kagura_equip[65]
		set fortymm_MIA_shells Kagura_equip[66]
		set fortymm_plasma Kagura_equip[67]
		set fortymm_caseless Kagura_equip[68]
		set fortymm_electro Kagura_equip[69]
		set fortymm_slug Kagura_equip[70]
		set fortymm_cryo Kagura_equip[71]
		set ROPE Kagura_equip[72]
		set SHOTGUNMAG Kagura_equip[73]
		set SHOTGUNBOXMAG Kagura_equip[74]
		set dragon_shells Kagura_equip[75]
		set GOT_KNIFE Kagura_equip[76]
		set riot_shield Kagura_equip[77]
		set gun_firemode_two Kagura_equip[78]
		set P_HAS_SHIELD Kagura_equip[79]
		}

checkavailinven THISACTOR
checkavailweapon THISACTOR

}


ife EXTRASAVED 1
 ifn CHAR -1
		{
state give_assigned_weapon
		ifspritepal 0
			{ setp[].max_player_health 100 seta[temp].extra 100 }
				ifspritepal 1
			{ setp[].max_player_health 255 seta[temp].extra 255 }
				ifspritepal 2
			{ setp[].max_player_health 200 seta[temp].extra 200 }
				ifspritepal 3
			{ setp[].max_player_health 100 seta[temp].extra 100 }
				ifspritepal 4
			{ ife PERSONNEL_RESEARCH[10] 2 { setp[].max_player_health 100 seta[temp].extra 100 } else
					{ setp[].max_player_health 75 seta[temp].extra 75 } }
				ifspritepal 5
			{ ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 140 seta[temp].extra 140 }
					else { setp[].max_player_health 120 seta[temp].extra 120 } }
				ifspritepal 6
			{ setp[].max_player_health 120 seta[temp].extra 120 }

			ifspritepal 7
			{
					ife PERSONNEL_RESEARCH[6] 2 // Both
					 ife PERSONNEL_RESEARCH[9] 2
					 {
					 setp[].max_player_health 200
					seta[temp].extra 200
					 }
					 else
			ife PERSONNEL_RESEARCH[6] 2 // Adamantium sheathing
					{
						setp[].max_player_health 170
						seta[temp].extra 170
					}
						else
					ife PERSONNEL_RESEARCH[9] 2 // MS Corp ceramic plating
					{
						setp[].max_player_health 180
						seta[temp].extra 180
					}
					 else
					 {
					setp[].max_player_health 150
					seta[temp].extra 150
					}
			}

		ifspritepal 8
	{ set CHAR -1 }
		ifspritepal 9
	{ setp[].max_player_health 100 seta[temp].extra 100 }
		ifspritepal 10
	{ setp[].max_player_health 100 seta[temp].extra 100 }
		ifspritepal 11
	{  setp[].max_player_health 100 seta[temp].extra 100 }
		ifspritepal 12
	{ setp[].max_player_health 200 seta[temp].extra 200 }
		ifspritepal 13
	{ setp[].max_player_health 100 seta[temp].extra 100 }
	ifspritepal 14
	{ set CHAR 14 ife PERSONNEL_RESEARCH[10] 2 { setp[].max_player_health 75 seta[temp].extra 75 }
	else { setp[].max_player_health 50 seta[temp].extra 50 } }
	ifspritepal 17
		{
		ife PERSONNEL_RESEARCH[6] 2 { setp[].max_player_health 120 seta[temp].extra 120 }
		else { setp[].max_player_health 100 seta[temp].extra 100 }
		}
	set CHARSELECT 0

	getp[].max_player_health pmax_health
	ife ARTIFACTS_LOADOUT[CHAR] 11
		{
		add pmax_health 20
		seta[].extra pmax_health
		setp[].max_player_health pmax_health
		}
}
killit
ends

useractor notenemy FORCE_CHARACTER
cstat 32768

ifaction 0
	{
	setarray James_equip[24] JAMES_UPGRADE
	setarray Zaxtor_equip[24] ZAXTOR_UPGRADE
	setarray Merlijn_equip[24] MERLIJN_UPGRADE
	setarray Highwire_equip[24] HIGHWIRE_UPGRADE
	setarray Sang_equip[24] SANG_UPGRADE
	setarray Rusty_equip[24] RUSTY_UPGRADE
	setarray Geoffrey_equip[24] GEOFFREY_UPGRADE
	setarray Mikko_equip[24] MIKKO_UPGRADE
	setarray Micky_equip[24] MICKY_UPGRADE
	setarray Snowfall_equip[24] SNOWFALL_UPGRADE
	setarray Kagura_equip[24] KAGURA_UPGRADE
	action ZERO
	}

ife LOTAGSAVED 0
{
set MOUSEUP 0
state force_char
}
else
{
checkactivatormotion LOTAGSAVED
ife RETURN 1
	{
	ifn OWNERSAVED -1 state fade_out_white
	state hard_removefollower
	ifn sprite[].pal 8
		{
		ife CHAR 0
			{
			setarray James_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray James_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray James_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray James_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray James_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray James_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray James_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray James_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray James_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray James_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray James_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray James_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray James_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray James_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray James_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray James_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray James_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray James_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray James_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray James_equip[19] temp
			setarray James_equip[20] PHEALTH
			setarray James_equip[21] pmax_health
			setarray James_equip[22] PARMOUR
			setarray James_equip[23] P_SPIRIT_ARMOUR
			setarray James_equip[24] JAMES_UPGRADE
			setarray James_equip[25] gun_firemode
			setarray James_equip[26] guns_akimbo
			setarray James_equip[27] GOT_EXPLOSIVE
			setarray James_equip[28] AIR_FILTER
			setarray James_equip[29] PISTOLMAG
			setarray James_equip[30] MGUNMAG
			setarray James_equip[31] RUNEKEYS
			setarray James_equip[32] ACCESSKEY2
			setarray James_equip[33] PLUGKEY
			setarray James_equip[34] HELLGKEYS
			setarray James_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray James_equip[36] temp
			getp[].heat_amount temp
			setarray James_equip[37] temp
			getp[].holoduke_amount temp
			setarray James_equip[38] temp
			getp[].jetpack_amount temp
			setarray James_equip[39] temp
			getp[].scuba_amount temp
			setarray James_equip[40] temp
			getp[].firstaid_amount temp
			setarray James_equip[41] temp
			getp[].steroids_amount temp
			setarray James_equip[42] temp
			getp[].got_access temp
			setarray James_equip[44] temp
			setarray James_equip[45] GENERIC_KEYS
			setarray James_equip[46] silver_ammo
			setarray James_equip[47] explosive_shells
			setarray James_equip[48] FIRE_SUIT
			setarray James_equip[49] GAS_MASK
			setarray James_equip[50] tesla_ammo
			setarray James_equip[51] SCARABKEYS
			setarray James_equip[52] COGS
			setarray James_equip[53] P_FIRE_ARMOUR
			setarray James_equip[54] TOOLBOX
			setarray James_equip[55] flechete_shells
			setarray James_equip[56] silver_bolts
			setarray James_equip[57] NORMAL_KEYS
			setarray James_equip[58] micro_torpedo
			setarray James_equip[59] magnum_shells
			setarray James_equip[60] heat_seek_card
			setarray James_equip[61] atomic_bomb
			setarray James_equip[62] DUP_missile_ammo
			setarray James_equip[63] SW_KEYS
			setarray James_equip[64] fortymm_grenades
			setarray James_equip[65] fortymm_shells
			setarray James_equip[66] fortymm_MIA_shells
			setarray James_equip[67] fortymm_plasma
			setarray James_equip[68] fortymm_caseless
			setarray James_equip[69] fortymm_electro
			setarray James_equip[70] fortymm_slug
			setarray James_equip[71] fortymm_cryo
			setarray James_equip[72] ROPE
			setarray James_equip[73] SHOTGUNMAG
			setarray James_equip[74] SHOTGUNBOXMAG
			setarray James_equip[75] dragon_shells
			setarray James_equip[76] GOT_KNIFE
			setarray James_equip[77] riot_shield
			setarray James_equip[78] gun_firemode_two
			setarray James_equip[79] P_HAS_SHIELD
			}
		ife CHAR 1
			{
			setarray Zaxtor_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Zaxtor_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Zaxtor_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Zaxtor_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Zaxtor_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Zaxtor_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Zaxtor_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Zaxtor_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Zaxtor_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Zaxtor_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Zaxtor_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Zaxtor_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Zaxtor_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Zaxtor_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Zaxtor_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Zaxtor_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Zaxtor_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Zaxtor_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Zaxtor_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Zaxtor_equip[19] temp
			setarray Zaxtor_equip[20] PHEALTH
			setarray Zaxtor_equip[21] pmax_health
			setarray Zaxtor_equip[22] PARMOUR
			setarray Zaxtor_equip[23] P_SPIRIT_ARMOUR
			setarray Zaxtor_equip[24] ZAXTOR_UPGRADE
			setarray Zaxtor_equip[25] gun_firemode
			setarray Zaxtor_equip[26] guns_akimbo
			setarray Zaxtor_equip[27] GOT_EXPLOSIVE
			setarray Zaxtor_equip[28] AIR_FILTER
			setarray Zaxtor_equip[29] PISTOLMAG
			setarray Zaxtor_equip[30] MGUNMAG
			setarray Zaxtor_equip[31] RUNEKEYS
			setarray Zaxtor_equip[32] ACCESSKEY2
			setarray Zaxtor_equip[33] PLUGKEY
			setarray Zaxtor_equip[34] HELLGKEYS
			setarray Zaxtor_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Zaxtor_equip[36] temp
			getp[].heat_amount temp
			setarray Zaxtor_equip[37] temp
			getp[].holoduke_amount temp
			setarray Zaxtor_equip[38] temp
			getp[].jetpack_amount temp
			setarray Zaxtor_equip[39] temp
			getp[].scuba_amount temp
			setarray Zaxtor_equip[40] temp
			getp[].firstaid_amount temp
			setarray Zaxtor_equip[41] temp
			getp[].steroids_amount temp
			setarray Zaxtor_equip[42] temp
			getp[].got_access temp
			setarray Zaxtor_equip[44] temp
			setarray Zaxtor_equip[45] GENERIC_KEYS
			setarray Zaxtor_equip[46] silver_ammo
			setarray Zaxtor_equip[47] explosive_shells
			setarray Zaxtor_equip[48] FIRE_SUIT
			setarray Zaxtor_equip[49] GAS_MASK
			setarray Zaxtor_equip[50] tesla_ammo
			setarray Zaxtor_equip[51] SCARABKEYS
			setarray Zaxtor_equip[52] COGS
			setarray Zaxtor_equip[53] P_FIRE_ARMOUR
			setarray Zaxtor_equip[54] TOOLBOX
			setarray Zaxtor_equip[55] flechete_shells
			setarray Zaxtor_equip[56] silver_bolts
			setarray Zaxtor_equip[57] NORMAL_KEYS
			setarray Zaxtor_equip[58] micro_torpedo
			setarray Zaxtor_equip[59] magnum_shells
			setarray Zaxtor_equip[60] heat_seek_card
			setarray Zaxtor_equip[61] atomic_bomb
			setarray Zaxtor_equip[62] DUP_missile_ammo
			setarray Zaxtor_equip[63] SW_KEYS
			setarray Zaxtor_equip[64] fortymm_grenades
			setarray Zaxtor_equip[65] fortymm_shells
			setarray Zaxtor_equip[66] fortymm_MIA_shells
			setarray Zaxtor_equip[67] fortymm_plasma
			setarray Zaxtor_equip[68] fortymm_caseless
			setarray Zaxtor_equip[69] fortymm_electro
			setarray Zaxtor_equip[70] fortymm_slug
			setarray Zaxtor_equip[71] fortymm_cryo
			setarray Zaxtor_equip[72] ROPE
			setarray Zaxtor_equip[73] SHOTGUNMAG
			setarray Zaxtor_equip[74] SHOTGUNBOXMAG
			setarray Zaxtor_equip[75] dragon_shells
			setarray Zaxtor_equip[76] GOT_KNIFE
			setarray Zaxtor_equip[77] riot_shield
			setarray Zaxtor_equip[78] gun_firemode_two
			setarray Zaxtor_equip[79] P_HAS_SHIELD
			}
		ife CHAR 2
			{
			setarray Merlijn_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Merlijn_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Merlijn_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Merlijn_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Merlijn_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Merlijn_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Merlijn_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Merlijn_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Merlijn_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Merlijn_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Merlijn_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Merlijn_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Merlijn_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Merlijn_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Merlijn_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Merlijn_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Merlijn_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Merlijn_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Merlijn_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Merlijn_equip[19] temp
			setarray Merlijn_equip[20] PHEALTH
			setarray Merlijn_equip[21] pmax_health
			setarray Merlijn_equip[22] PARMOUR
			setarray Merlijn_equip[23] P_SPIRIT_ARMOUR
			setarray Merlijn_equip[24] MERLIJN_UPGRADE
			setarray Merlijn_equip[25] gun_firemode
			setarray Merlijn_equip[26] guns_akimbo
			setarray Merlijn_equip[27] GOT_EXPLOSIVE
			setarray Merlijn_equip[28] AIR_FILTER
			setarray Merlijn_equip[29] PISTOLMAG
			setarray Merlijn_equip[30] MGUNMAG
			setarray Merlijn_equip[31] RUNEKEYS
			setarray Merlijn_equip[32] ACCESSKEY2
			setarray Merlijn_equip[33] PLUGKEY
			setarray Merlijn_equip[34] HELLGKEYS
			setarray Merlijn_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Merlijn_equip[36] temp
			getp[].heat_amount temp
			setarray Merlijn_equip[37] temp
			getp[].holoduke_amount temp
			setarray Merlijn_equip[38] temp
			getp[].jetpack_amount temp
			setarray Merlijn_equip[39] temp
			getp[].scuba_amount temp
			setarray Merlijn_equip[40] temp
			getp[].firstaid_amount temp
			setarray Merlijn_equip[41] temp
			getp[].steroids_amount temp
			setarray Merlijn_equip[42] temp
			getp[].got_access temp
			setarray Merlijn_equip[44] temp
			setarray Merlijn_equip[45] GENERIC_KEYS
			setarray Merlijn_equip[46] silver_ammo
			setarray Merlijn_equip[47] explosive_shells
			setarray Merlijn_equip[48] FIRE_SUIT
			setarray Merlijn_equip[49] GAS_MASK
			setarray Merlijn_equip[50] tesla_ammo
			setarray Merlijn_equip[51] SCARABKEYS
			setarray Merlijn_equip[52] COGS
			setarray Merlijn_equip[53] P_FIRE_ARMOUR
			setarray Merlijn_equip[54] TOOLBOX
			setarray Merlijn_equip[55] flechete_shells
			setarray Merlijn_equip[56] silver_bolts
			setarray Merlijn_equip[57] NORMAL_KEYS
			setarray Merlijn_equip[58] micro_torpedo
			setarray Merlijn_equip[59] magnum_shells
			setarray Merlijn_equip[60] heat_seek_card
			setarray Merlijn_equip[61] atomic_bomb
			setarray Merlijn_equip[62] DUP_missile_ammo
			setarray Merlijn_equip[63] SW_KEYS
			setarray Merlijn_equip[64] fortymm_grenades
			setarray Merlijn_equip[65] fortymm_shells
			setarray Merlijn_equip[66] fortymm_MIA_shells
			setarray Merlijn_equip[67] fortymm_plasma
			setarray Merlijn_equip[68] fortymm_caseless
			setarray Merlijn_equip[69] fortymm_electro
			setarray Merlijn_equip[70] fortymm_slug
			setarray Merlijn_equip[71] fortymm_cryo
			setarray Merlijn_equip[72] ROPE
			setarray Merlijn_equip[73] SHOTGUNMAG
			setarray Merlijn_equip[74] SHOTGUNBOXMAG
			setarray Merlijn_equip[75] dragon_shells
			setarray Merlijn_equip[76] GOT_KNIFE
			setarray Merlijn_equip[77] riot_shield
			setarray Merlijn_equip[78] gun_firemode_two
			setarray Merlijn_equip[79] P_HAS_SHIELD
			}
		ife CHAR 3
			{
			setarray Highwire_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Highwire_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Highwire_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Highwire_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Highwire_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Highwire_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Highwire_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Highwire_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Highwire_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Highwire_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Highwire_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Highwire_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Highwire_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Highwire_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Highwire_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Highwire_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Highwire_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Highwire_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Highwire_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Highwire_equip[19] temp
			setarray Highwire_equip[20] PHEALTH
			setarray Highwire_equip[21] pmax_health
			setarray Highwire_equip[22] PARMOUR
			setarray Highwire_equip[23] P_SPIRIT_ARMOUR
			setarray Highwire_equip[24] HIGHWIRE_UPGRADE
			setarray Highwire_equip[25] gun_firemode
			setarray Highwire_equip[26] guns_akimbo
			setarray Highwire_equip[27] GOT_EXPLOSIVE
			setarray Highwire_equip[28] AIR_FILTER
			setarray Highwire_equip[29] PISTOLMAG
			setarray Highwire_equip[30] MGUNMAG
			setarray Highwire_equip[31] RUNEKEYS
			setarray Highwire_equip[32] ACCESSKEY2
			setarray Highwire_equip[33] PLUGKEY
			setarray Highwire_equip[34] HELLGKEYS
			setarray Highwire_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Highwire_equip[36] temp
			getp[].heat_amount temp
			setarray Highwire_equip[37] temp
			getp[].holoduke_amount temp
			setarray Highwire_equip[38] temp
			getp[].jetpack_amount temp
			setarray Highwire_equip[39] temp
			getp[].scuba_amount temp
			setarray Highwire_equip[40] temp
			getp[].firstaid_amount temp
			setarray Highwire_equip[41] temp
			getp[].steroids_amount temp
			setarray Highwire_equip[42] temp
			getp[].got_access temp
			setarray Highwire_equip[44] temp
			setarray Highwire_equip[45] GENERIC_KEYS
			setarray Highwire_equip[46] silver_ammo
			setarray Highwire_equip[47] explosive_shells
			setarray Highwire_equip[48] FIRE_SUIT
			setarray Highwire_equip[49] GAS_MASK
			setarray Highwire_equip[50] tesla_ammo
			setarray Highwire_equip[51] SCARABKEYS
			setarray Highwire_equip[52] COGS
			setarray Highwire_equip[53] P_FIRE_ARMOUR
			setarray Highwire_equip[54] TOOLBOX
			setarray Highwire_equip[55] flechete_shells
			setarray Highwire_equip[56] silver_bolts
			setarray Highwire_equip[57] NORMAL_KEYS
			setarray Highwire_equip[58] micro_torpedo
			setarray Highwire_equip[59] magnum_shells
			setarray Highwire_equip[60] heat_seek_card
			setarray Highwire_equip[61] atomic_bomb
			setarray Highwire_equip[62] DUP_missile_ammo
			setarray Highwire_equip[63] SW_KEYS
			setarray Highwire_equip[64] fortymm_grenades
			setarray Highwire_equip[65] fortymm_shells
			setarray Highwire_equip[66] fortymm_MIA_shells
			setarray Highwire_equip[67] fortymm_plasma
			setarray Highwire_equip[68] fortymm_caseless
			setarray Highwire_equip[69] fortymm_electro
			setarray Highwire_equip[70] fortymm_slug
			setarray Highwire_equip[71] fortymm_cryo
			setarray Highwire_equip[72] ROPE
			setarray Highwire_equip[73] SHOTGUNMAG
			setarray Highwire_equip[74] SHOTGUNBOXMAG
			setarray Highwire_equip[75] dragon_shells
			setarray Highwire_equip[76] GOT_KNIFE
			setarray Highwire_equip[77] riot_shield
			setarray Highwire_equip[78] gun_firemode_two
			setarray Highwire_equip[79] P_HAS_SHIELD
			}
		ife CHAR 4
			{
			setarray Sang_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Sang_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Sang_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Sang_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Sang_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Sang_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Sang_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Sang_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Sang_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Sang_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Sang_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Sang_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Sang_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Sang_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Sang_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Sang_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Sang_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Sang_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Sang_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Sang_equip[19] temp
			setarray Sang_equip[20] PHEALTH
			setarray Sang_equip[21] pmax_health
			setarray Sang_equip[22] PARMOUR
			setarray Sang_equip[23] P_SPIRIT_ARMOUR
			setarray Sang_equip[24] SANG_UPGRADE
			setarray Sang_equip[25] gun_firemode
			setarray Sang_equip[26] guns_akimbo
			setarray Sang_equip[27] GOT_EXPLOSIVE
			setarray Sang_equip[28] AIR_FILTER
			setarray Sang_equip[29] PISTOLMAG
			setarray Sang_equip[30] MGUNMAG
			setarray Sang_equip[31] RUNEKEYS
			setarray Sang_equip[32] ACCESSKEY2
			setarray Sang_equip[33] PLUGKEY
			setarray Sang_equip[34] HELLGKEYS
			setarray Sang_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Sang_equip[36] temp
			getp[].heat_amount temp
			setarray Sang_equip[37] temp
			getp[].holoduke_amount temp
			setarray Sang_equip[38] temp
			getp[].jetpack_amount temp
			setarray Sang_equip[39] temp
			getp[].scuba_amount temp
			setarray Sang_equip[40] temp
			getp[].firstaid_amount temp
			setarray Sang_equip[41] temp
			getp[].steroids_amount temp
			setarray Sang_equip[42] temp
			getp[].got_access temp
			setarray Sang_equip[44] temp
			setarray Sang_equip[45] GENERIC_KEYS
			setarray Sang_equip[46] silver_ammo
			setarray Sang_equip[47] explosive_shells
			setarray Sang_equip[48] FIRE_SUIT
			setarray Sang_equip[49] GAS_MASK
			setarray Sang_equip[50] tesla_ammo
			setarray Sang_equip[51] SCARABKEYS
			setarray Sang_equip[52] COGS
			setarray Sang_equip[53] P_FIRE_ARMOUR
			setarray Sang_equip[54] TOOLBOX
			setarray Sang_equip[55] flechete_shells
			setarray Sang_equip[56] silver_bolts
			setarray Sang_equip[57] NORMAL_KEYS
			setarray Sang_equip[58] micro_torpedo
			setarray Sang_equip[59] magnum_shells
			setarray Sang_equip[60] heat_seek_card
			setarray Sang_equip[61] atomic_bomb
			setarray Sang_equip[62] DUP_missile_ammo
			setarray Sang_equip[63] SW_KEYS
			setarray Sang_equip[64] fortymm_grenades
			setarray Sang_equip[65] fortymm_shells
			setarray Sang_equip[66] fortymm_MIA_shells
			setarray Sang_equip[67] fortymm_plasma
			setarray Sang_equip[68] fortymm_caseless
			setarray Sang_equip[69] fortymm_electro
			setarray Sang_equip[70] fortymm_slug
			setarray Sang_equip[71] fortymm_cryo
			setarray Sang_equip[72] ROPE
			setarray Sang_equip[73] SHOTGUNMAG
			setarray Sang_equip[74] SHOTGUNBOXMAG
			setarray Sang_equip[75] dragon_shells
			setarray Sang_equip[76] GOT_KNIFE
			setarray Sang_equip[77] riot_shield
			setarray Sang_equip[78] gun_firemode_two
			setarray Sang_equip[79] P_HAS_SHIELD
			}
		ife CHAR 5
			{
			setarray Rusty_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Rusty_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Rusty_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Rusty_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Rusty_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Rusty_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Rusty_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Rusty_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Rusty_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Rusty_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Rusty_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Rusty_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Rusty_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Rusty_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Rusty_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Rusty_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Rusty_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Rusty_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Rusty_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Rusty_equip[19] temp
			setarray Rusty_equip[20] PHEALTH
			setarray Rusty_equip[21] pmax_health
			setarray Rusty_equip[22] PARMOUR
			setarray Rusty_equip[23] P_SPIRIT_ARMOUR
			setarray Rusty_equip[24] RUSTY_UPGRADE
			setarray Rusty_equip[25] gun_firemode
			setarray Rusty_equip[26] guns_akimbo
			setarray Rusty_equip[27] GOT_EXPLOSIVE
			setarray Rusty_equip[28] AIR_FILTER
			setarray Rusty_equip[29] PISTOLMAG
			setarray Rusty_equip[30] MGUNMAG
			setarray Rusty_equip[31] RUNEKEYS
			setarray Rusty_equip[32] ACCESSKEY2
			setarray Rusty_equip[33] PLUGKEY
			setarray Rusty_equip[34] HELLGKEYS
			setarray Rusty_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Rusty_equip[36] temp
			getp[].heat_amount temp
			setarray Rusty_equip[37] temp
			getp[].holoduke_amount temp
			setarray Rusty_equip[38] temp
			getp[].jetpack_amount temp
			setarray Rusty_equip[39] temp
			getp[].scuba_amount temp
			setarray Rusty_equip[40] temp
			getp[].firstaid_amount temp
			setarray Rusty_equip[41] temp
			getp[].steroids_amount temp
			setarray Rusty_equip[42] temp
			getp[].got_access temp
			setarray Rusty_equip[44] temp
			setarray Rusty_equip[45] GENERIC_KEYS
			setarray Rusty_equip[46] silver_ammo
			setarray Rusty_equip[47] explosive_shells
			setarray Rusty_equip[48] FIRE_SUIT
			setarray Rusty_equip[49] GAS_MASK
			setarray Rusty_equip[50] tesla_ammo
			setarray Rusty_equip[51] SCARABKEYS
			setarray Rusty_equip[52] COGS
			setarray Rusty_equip[53] P_FIRE_ARMOUR
			setarray Rusty_equip[54] TOOLBOX
			setarray Rusty_equip[55] flechete_shells
			setarray Rusty_equip[56] silver_bolts
			setarray Rusty_equip[57] NORMAL_KEYS
			setarray Rusty_equip[58] micro_torpedo
			setarray Rusty_equip[59] magnum_shells
			setarray Rusty_equip[60] heat_seek_card
			setarray Rusty_equip[61] atomic_bomb
			setarray Rusty_equip[62] DUP_missile_ammo
			setarray Rusty_equip[63] SW_KEYS
			setarray Rusty_equip[64] fortymm_grenades
			setarray Rusty_equip[65] fortymm_shells
			setarray Rusty_equip[66] fortymm_MIA_shells
			setarray Rusty_equip[67] fortymm_plasma
			setarray Rusty_equip[68] fortymm_caseless
			setarray Rusty_equip[69] fortymm_electro
			setarray Rusty_equip[70] fortymm_slug
			setarray Rusty_equip[71] fortymm_cryo
			setarray Rusty_equip[72] ROPE
			setarray Rusty_equip[73] SHOTGUNMAG
			setarray Rusty_equip[74] SHOTGUNBOXMAG
			setarray Rusty_equip[75] dragon_shells
			setarray Rusty_equip[76] GOT_KNIFE
			setarray Rusty_equip[77] riot_shield
			setarray Rusty_equip[78] gun_firemode_two
			setarray Rusty_equip[79] P_HAS_SHIELD
			}
		ife CHAR 6
			{
			setarray Geoffrey_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Geoffrey_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Geoffrey_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Geoffrey_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Geoffrey_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Geoffrey_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Geoffrey_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Geoffrey_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Geoffrey_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Geoffrey_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Geoffrey_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Geoffrey_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Geoffrey_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Geoffrey_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Geoffrey_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Geoffrey_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Geoffrey_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Geoffrey_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Geoffrey_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Geoffrey_equip[19] temp
			setarray Geoffrey_equip[20] PHEALTH
			setarray Geoffrey_equip[21] pmax_health
			setarray Geoffrey_equip[22] PARMOUR
			setarray Geoffrey_equip[23] P_SPIRIT_ARMOUR
			setarray Geoffrey_equip[24] GEOFFREY_UPGRADE
			setarray Geoffrey_equip[25] gun_firemode
			setarray Geoffrey_equip[26] guns_akimbo
			setarray Geoffrey_equip[27] GOT_EXPLOSIVE
			setarray Geoffrey_equip[28] AIR_FILTER
			setarray Geoffrey_equip[29] PISTOLMAG
			setarray Geoffrey_equip[30] MGUNMAG
			setarray Geoffrey_equip[31] RUNEKEYS
			setarray Geoffrey_equip[32] ACCESSKEY2
			setarray Geoffrey_equip[33] PLUGKEY
			setarray Geoffrey_equip[34] HELLGKEYS
			setarray Geoffrey_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Geoffrey_equip[36] temp
			getp[].heat_amount temp
			setarray Geoffrey_equip[37] temp
			getp[].holoduke_amount temp
			setarray Geoffrey_equip[38] temp
			getp[].jetpack_amount temp
			setarray Geoffrey_equip[39] temp
			getp[].scuba_amount temp
			setarray Geoffrey_equip[40] temp
			getp[].firstaid_amount temp
			setarray Geoffrey_equip[41] temp
			getp[].steroids_amount temp
			setarray Geoffrey_equip[42] temp
			getp[].got_access temp
			setarray Geoffrey_equip[44] temp
			setarray Geoffrey_equip[45] GENERIC_KEYS
			setarray Geoffrey_equip[46] silver_ammo
			setarray Geoffrey_equip[47] explosive_shells
			setarray Geoffrey_equip[48] FIRE_SUIT
			setarray Geoffrey_equip[49] GAS_MASK
			setarray Geoffrey_equip[50] tesla_ammo
			setarray Geoffrey_equip[51] SCARABKEYS
			setarray Geoffrey_equip[52] COGS
			setarray Geoffrey_equip[53] P_FIRE_ARMOUR
			setarray Geoffrey_equip[54] TOOLBOX
			setarray Geoffrey_equip[55] flechete_shells
			setarray Geoffrey_equip[56] silver_bolts
			setarray Geoffrey_equip[57] NORMAL_KEYS
			setarray Geoffrey_equip[58] micro_torpedo
			setarray Geoffrey_equip[59] magnum_shells
			setarray Geoffrey_equip[60] heat_seek_card
			setarray Geoffrey_equip[61] atomic_bomb
			setarray Geoffrey_equip[62] DUP_missile_ammo
			setarray Geoffrey_equip[63] SW_KEYS
			setarray Geoffrey_equip[64] fortymm_grenades
			setarray Geoffrey_equip[65] fortymm_shells
			setarray Geoffrey_equip[66] fortymm_MIA_shells
			setarray Geoffrey_equip[67] fortymm_plasma
			setarray Geoffrey_equip[68] fortymm_caseless
			setarray Geoffrey_equip[69] fortymm_electro
			setarray Geoffrey_equip[70] fortymm_slug
			setarray Geoffrey_equip[71] fortymm_cryo
			setarray Geoffrey_equip[72] ROPE
			setarray Geoffrey_equip[73] SHOTGUNMAG
			setarray Geoffrey_equip[74] SHOTGUNBOXMAG
			setarray Geoffrey_equip[75] dragon_shells
			setarray Geoffrey_equip[76] GOT_KNIFE
			setarray Geoffrey_equip[77] riot_shield
			setarray Geoffrey_equip[78] gun_firemode_two
			setarray Geoffrey_equip[79] P_HAS_SHIELD
			}
		ife CHAR 7
			{
			setarray Mikko_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Mikko_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Mikko_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Mikko_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Mikko_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Mikko_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Mikko_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Mikko_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Mikko_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Mikko_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Mikko_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Mikko_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Mikko_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Mikko_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Mikko_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Mikko_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Mikko_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Mikko_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Mikko_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Mikko_equip[19] temp
			setarray Mikko_equip[20] PHEALTH
			setarray Mikko_equip[21] pmax_health
			setarray Mikko_equip[22] PARMOUR
			setarray Mikko_equip[23] P_SPIRIT_ARMOUR
			setarray Mikko_equip[24] MIKKO_UPGRADE
			setarray Mikko_equip[25] gun_firemode
			setarray Mikko_equip[26] guns_akimbo
			setarray Mikko_equip[27] GOT_EXPLOSIVE
			setarray Mikko_equip[28] AIR_FILTER
			setarray Mikko_equip[29] PISTOLMAG
			setarray Mikko_equip[30] MGUNMAG
			setarray Mikko_equip[31] RUNEKEYS
			setarray Mikko_equip[32] ACCESSKEY2
			setarray Mikko_equip[33] PLUGKEY
			setarray Mikko_equip[34] HELLGKEYS
			setarray Mikko_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Mikko_equip[36] temp
			getp[].heat_amount temp
			setarray Mikko_equip[37] temp
			getp[].holoduke_amount temp
			setarray Mikko_equip[38] temp
			getp[].jetpack_amount temp
			setarray Mikko_equip[39] temp
			getp[].scuba_amount temp
			setarray Mikko_equip[40] temp
			getp[].firstaid_amount temp
			setarray Mikko_equip[41] temp
			getp[].steroids_amount temp
			setarray Mikko_equip[42] temp
			getp[].got_access temp
			setarray Mikko_equip[44] temp
			setarray Mikko_equip[45] GENERIC_KEYS
			setarray Mikko_equip[46] silver_ammo
			setarray Mikko_equip[47] explosive_shells
			setarray Mikko_equip[48] FIRE_SUIT
			setarray Mikko_equip[49] GAS_MASK
			setarray Mikko_equip[50] tesla_ammo
			setarray Mikko_equip[51] SCARABKEYS
			setarray Mikko_equip[52] COGS
			setarray Mikko_equip[53] P_FIRE_ARMOUR
			setarray Mikko_equip[54] TOOLBOX
			setarray Mikko_equip[55] flechete_shells
			setarray Mikko_equip[56] silver_bolts
			setarray Mikko_equip[57] NORMAL_KEYS
			setarray Mikko_equip[58] micro_torpedo
			setarray Mikko_equip[59] magnum_shells
			setarray Mikko_equip[60] heat_seek_card
			setarray Mikko_equip[61] atomic_bomb
			setarray Mikko_equip[62] DUP_missile_ammo
			setarray Mikko_equip[63] SW_KEYS
			setarray Mikko_equip[64] fortymm_grenades
			setarray Mikko_equip[65] fortymm_shells
			setarray Mikko_equip[66] fortymm_MIA_shells
			setarray Mikko_equip[67] fortymm_plasma
			setarray Mikko_equip[68] fortymm_caseless
			setarray Mikko_equip[69] fortymm_electro
			setarray Mikko_equip[70] fortymm_slug
			setarray Mikko_equip[71] fortymm_cryo
			setarray Mikko_equip[72] ROPE
			setarray Mikko_equip[73] SHOTGUNMAG
			setarray Mikko_equip[74] SHOTGUNBOXMAG
			setarray Mikko_equip[75] dragon_shells
			setarray Mikko_equip[76] GOT_KNIFE
			setarray Mikko_equip[77] riot_shield
			setarray Mikko_equip[78] gun_firemode_two
			setarray Mikko_equip[79] P_HAS_SHIELD
			}
	ife CHAR 13
			{
			setarray Micky_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Micky_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Micky_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Micky_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Micky_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Micky_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Micky_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Micky_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Micky_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Micky_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Micky_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Micky_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Micky_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Micky_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Micky_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Micky_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Micky_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Micky_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Micky_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Micky_equip[19] temp
			setarray Micky_equip[20] PHEALTH
			setarray Micky_equip[21] pmax_health
			setarray Micky_equip[22] PARMOUR
			setarray Micky_equip[23] P_SPIRIT_ARMOUR
			setarray Micky_equip[24] MICKY_UPGRADE
			setarray Micky_equip[25] gun_firemode
			setarray Micky_equip[26] guns_akimbo
			setarray Micky_equip[27] GOT_EXPLOSIVE
			setarray Micky_equip[28] AIR_FILTER
			setarray Micky_equip[29] PISTOLMAG
			setarray Micky_equip[30] MGUNMAG
			setarray Micky_equip[31] RUNEKEYS
			setarray Micky_equip[32] ACCESSKEY2
			setarray Micky_equip[33] PLUGKEY
			setarray Micky_equip[34] HELLGKEYS
			setarray Micky_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Micky_equip[36] temp
			getp[].heat_amount temp
			setarray Micky_equip[37] temp
			getp[].holoduke_amount temp
			setarray Micky_equip[38] temp
			getp[].jetpack_amount temp
			setarray Micky_equip[39] temp
			getp[].scuba_amount temp
			setarray Micky_equip[40] temp
			getp[].firstaid_amount temp
			setarray Micky_equip[41] temp
			getp[].steroids_amount temp
			setarray Micky_equip[42] temp
			getp[].got_access temp
			setarray Micky_equip[44] temp
			setarray Micky_equip[45] GENERIC_KEYS
			setarray Micky_equip[46] silver_ammo
			setarray Micky_equip[47] explosive_shells
			setarray Micky_equip[48] FIRE_SUIT
			setarray Micky_equip[49] GAS_MASK
			setarray Micky_equip[50] tesla_ammo
			setarray Micky_equip[51] SCARABKEYS
			setarray Micky_equip[52] COGS
			setarray Micky_equip[53] P_FIRE_ARMOUR
			setarray Micky_equip[54] TOOLBOX
			setarray Micky_equip[55] flechete_shells
			setarray Micky_equip[56] silver_bolts
			setarray Micky_equip[57] NORMAL_KEYS
			setarray Micky_equip[58] micro_torpedo
			setarray Micky_equip[59] magnum_shells
			setarray Micky_equip[60] heat_seek_card
			setarray Micky_equip[61] atomic_bomb
			setarray Micky_equip[62] DUP_missile_ammo
			setarray Micky_equip[63] SW_KEYS
			setarray Micky_equip[64] fortymm_grenades
			setarray Micky_equip[65] fortymm_shells
			setarray Micky_equip[66] fortymm_MIA_shells
			setarray Micky_equip[67] fortymm_plasma
			setarray Micky_equip[68] fortymm_caseless
			setarray Micky_equip[69] fortymm_electro
			setarray Micky_equip[70] fortymm_slug
			setarray Micky_equip[71] fortymm_cryo
			setarray Micky_equip[72] ROPE
			setarray Micky_equip[73] SHOTGUNMAG
			setarray Micky_equip[74] SHOTGUNBOXMAG
			setarray Micky_equip[75] dragon_shells
			setarray Micky_equip[76] GOT_KNIFE
			setarray Micky_equip[77] riot_shield
			setarray Micky_equip[78] gun_firemode_two
			setarray Micky_equip[79] P_HAS_SHIELD
			}
	ife CHAR 14
			{
			setarray Snowfall_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Snowfall_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Snowfall_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Snowfall_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Snowfall_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Snowfall_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Snowfall_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Snowfall_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Snowfall_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Snowfall_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Snowfall_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Snowfall_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Snowfall_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Snowfall_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Snowfall_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Snowfall_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Snowfall_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Snowfall_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Snowfall_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Snowfall_equip[19] temp
			setarray Snowfall_equip[20] PHEALTH
			setarray Snowfall_equip[21] pmax_health
			setarray Snowfall_equip[22] PARMOUR
			setarray Snowfall_equip[23] P_SPIRIT_ARMOUR
			setarray Snowfall_equip[24] SNOWFALL_UPGRADE
			setarray Snowfall_equip[25] gun_firemode
			setarray Snowfall_equip[26] guns_akimbo
			setarray Snowfall_equip[27] GOT_EXPLOSIVE
			setarray Snowfall_equip[28] AIR_FILTER
			setarray Snowfall_equip[29] PISTOLMAG
			setarray Snowfall_equip[30] MGUNMAG
			setarray Snowfall_equip[31] RUNEKEYS
			setarray Snowfall_equip[32] ACCESSKEY2
			setarray Snowfall_equip[33] PLUGKEY
			setarray Snowfall_equip[34] HELLGKEYS
			setarray Snowfall_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Snowfall_equip[36] temp
			getp[].heat_amount temp
			setarray Snowfall_equip[37] temp
			getp[].holoduke_amount temp
			setarray Snowfall_equip[38] temp
			getp[].jetpack_amount temp
			setarray Snowfall_equip[39] temp
			getp[].scuba_amount temp
			setarray Snowfall_equip[40] temp
			getp[].firstaid_amount temp
			setarray Snowfall_equip[41] temp
			getp[].steroids_amount temp
			setarray Snowfall_equip[42] temp
			getp[].got_access temp
			setarray Snowfall_equip[44] temp
			setarray Snowfall_equip[45] GENERIC_KEYS
			setarray Snowfall_equip[46] silver_ammo
			setarray Snowfall_equip[47] explosive_shells
			setarray Snowfall_equip[48] FIRE_SUIT
			setarray Snowfall_equip[49] GAS_MASK
			setarray Snowfall_equip[50] tesla_ammo
			setarray Snowfall_equip[51] SCARABKEYS
			setarray Snowfall_equip[52] COGS
			setarray Snowfall_equip[53] P_FIRE_ARMOUR
			setarray Snowfall_equip[54] TOOLBOX
			setarray Snowfall_equip[55] flechete_shells
			setarray Snowfall_equip[56] silver_bolts
			setarray Snowfall_equip[57] NORMAL_KEYS
			setarray Snowfall_equip[58] micro_torpedo
			setarray Snowfall_equip[59] magnum_shells
			setarray Snowfall_equip[60] heat_seek_card
			setarray Snowfall_equip[61] atomic_bomb
			setarray Snowfall_equip[62] DUP_missile_ammo
			setarray Snowfall_equip[63] SW_KEYS
			setarray Snowfall_equip[64] fortymm_grenades
			setarray Snowfall_equip[65] fortymm_shells
			setarray Snowfall_equip[66] fortymm_MIA_shells
			setarray Snowfall_equip[67] fortymm_plasma
			setarray Snowfall_equip[68] fortymm_caseless
			setarray Snowfall_equip[69] fortymm_electro
			setarray Snowfall_equip[70] fortymm_slug
			setarray Snowfall_equip[71] fortymm_cryo
			setarray Snowfall_equip[72] ROPE
			setarray Snowfall_equip[73] SHOTGUNMAG
			setarray Snowfall_equip[74] SHOTGUNBOXMAG
			setarray Snowfall_equip[75] dragon_shells
			setarray Snowfall_equip[76] GOT_KNIFE
			setarray Snowfall_equip[77] riot_shield
			setarray Snowfall_equip[78] gun_firemode_two
			setarray Snowfall_equip[79] P_HAS_SHIELD
			}
	ife CHAR 17
			{
			setarray Kagura_equip[43] temp_weap // Temp weapon
			getp[].ammo_amount 0 temp
			setarray Kagura_equip[1] temp
			getp[].gotweapon 1 temp // Pistol
			setarray Kagura_equip[2] temp
			getp[].ammo_amount 1 temp
			setarray Kagura_equip[3] temp
			getp[].gotweapon 2 temp // Shotgun
			setarray Kagura_equip[4] temp
			getp[].ammo_amount 2 temp
			setarray Kagura_equip[5] temp
			getp[].gotweapon 3 temp // Shotgun
			setarray Kagura_equip[6] temp
			getp[].ammo_amount 3 temp // Chaingun
			setarray Kagura_equip[7] temp
			getp[].gotweapon 4 temp // RPG
			setarray Kagura_equip[8] temp
			getp[].ammo_amount 4 temp
			setarray Kagura_equip[9] temp
			getp[].ammo_amount 5 temp // Pipebomb
			setarray Kagura_equip[10] temp
			getp[].gotweapon 6 temp // Shrinker
			setarray Kagura_equip[11] temp
			getp[].ammo_amount 6 temp
			setarray Kagura_equip[12] temp
			getp[].gotweapon 7 temp // Devistator
			setarray Kagura_equip[13] temp
			getp[].ammo_amount 7 temp
			setarray Kagura_equip[14] temp
			getp[].ammo_amount 8 temp // Tripbomb
			setarray Kagura_equip[15] temp
			getp[].gotweapon 9 temp // Freezer
			setarray Kagura_equip[16] temp
			getp[].ammo_amount 9 temp
			setarray Kagura_equip[17] temp
			getp[].gotweapon 11 temp // Expander
			setarray Kagura_equip[18] temp
			getp[].ammo_amount 11 temp
			setarray Kagura_equip[19] temp
			setarray Kagura_equip[20] PHEALTH
			setarray Kagura_equip[21] pmax_health
			setarray Kagura_equip[22] PARMOUR
			setarray Kagura_equip[23] P_SPIRIT_ARMOUR
			setarray Kagura_equip[24] KAGURA_UPGRADE
			setarray Kagura_equip[25] gun_firemode
			setarray Kagura_equip[26] guns_akimbo
			setarray Kagura_equip[27] GOT_EXPLOSIVE
			setarray Kagura_equip[28] AIR_FILTER
			setarray Kagura_equip[29] PISTOLMAG
			setarray Kagura_equip[30] MGUNMAG
			setarray Kagura_equip[31] RUNEKEYS
			setarray Kagura_equip[32] ACCESSKEY2
			setarray Kagura_equip[33] PLUGKEY
			setarray Kagura_equip[34] HELLGKEYS
			setarray Kagura_equip[35] OLDKEYS
			getp[].boot_amount temp
			setarray Kagura_equip[36] temp
			getp[].heat_amount temp
			setarray Kagura_equip[37] temp
			getp[].holoduke_amount temp
			setarray Kagura_equip[38] temp
			getp[].jetpack_amount temp
			setarray Kagura_equip[39] temp
			getp[].scuba_amount temp
			setarray Kagura_equip[40] temp
			getp[].firstaid_amount temp
			setarray Kagura_equip[41] temp
			getp[].steroids_amount temp
			setarray Kagura_equip[42] temp
			getp[].got_access temp
			setarray Kagura_equip[44] temp
			setarray Kagura_equip[45] GENERIC_KEYS
			setarray Kagura_equip[46] silver_ammo
			setarray Kagura_equip[47] explosive_shells
			setarray Kagura_equip[48] FIRE_SUIT
			setarray Kagura_equip[49] GAS_MASK
			setarray Kagura_equip[50] tesla_ammo
			setarray Kagura_equip[51] SCARABKEYS
			setarray Kagura_equip[52] COGS
			setarray Kagura_equip[53] P_FIRE_ARMOUR
			setarray Kagura_equip[54] TOOLBOX
			setarray Kagura_equip[55] flechete_shells
			setarray Kagura_equip[56] silver_bolts
			setarray Kagura_equip[57] NORMAL_KEYS
			setarray Kagura_equip[58] micro_torpedo
			setarray Kagura_equip[59] magnum_shells
			setarray Kagura_equip[60] heat_seek_card
			setarray Kagura_equip[61] atomic_bomb
			setarray Kagura_equip[62] DUP_missile_ammo
			setarray Kagura_equip[63] SW_KEYS
			setarray Kagura_equip[64] fortymm_grenades
			setarray Kagura_equip[65] fortymm_shells
			setarray Kagura_equip[66] fortymm_MIA_shells
			setarray Kagura_equip[67] fortymm_plasma
			setarray Kagura_equip[68] fortymm_caseless
			setarray Kagura_equip[69] fortymm_electro
			setarray Kagura_equip[70] fortymm_slug
			setarray Kagura_equip[71] fortymm_cryo
			setarray Kagura_equip[72] ROPE
			setarray Kagura_equip[73] SHOTGUNMAG
			setarray Kagura_equip[74] SHOTGUNBOXMAG
			setarray Kagura_equip[75] dragon_shells
			setarray Kagura_equip[76] GOT_KNIFE
			setarray Kagura_equip[77] riot_shield
			setarray Kagura_equip[78] gun_firemode_two
			setarray Kagura_equip[79] P_HAS_SHIELD
			}
        }
	state force_char
	}
}
enda


// PLAYER DUPLICATE==========================================================================================================

defstate hide_cutscene
ifg HITAGSAVED 0
{
    ifl camerasprite 0
        cstat 32768
    else
    {
	ifg HITAGSAVED 1
		{
        checkactivatormotion HITAGSAVED
        ife RETURN 1 cstat 0
		}
	else cstat 0
    }
}
ends

defstate facing_code
ifvarn dummy_face -1
    {
            getactor[dummy_face].x mx
            getactor[dummy_face].y my
            subvarvar mx sprite[].x
            subvarvar my sprite[].y
            getangle angvar mx my
            setactor[THISACTOR].ang angvar
    }
ends

action JSTAND2 3841 1 5 1 1
// bionic arm james
action J2STAND2 24236 1 5 1 1
// ringwolrd james
action J3STAND2 25993 1 5 1 1

action ZSTAND2 4097 1 5 1 1

action PSTAND2 4996 1 5 1 1
// berserker suit Merlijn
action P2STAND2 25043 1 5 1 1

action RSTAND2 4609 1 5 1 1
action R2_STAND2 30340 1 5 1 1

action SSTAND2 4932 1 5 1 1
// peacelock sang
action S2STAND2 22562 1 5 1 1

action RNSTAND2 5252 1 5 1 1
// Rust D
action RNSTAND2_2 26465 1 5 1 1

action GSTAND2 5277 1 5 1 1

action MSTAND2 5528 1 5 1 1
action MC_STAND2 14985 1 5 1 1
action SF_STAND2 19332 1 5 1 1
action KT_STAND2 25742 1 5 1 1

action C_STAND2 6276 1 5 1 1
action MT_STAND2 24876 1 5 1 1
action JA_STAND2 11397 1 5 1 1
action BS_STAND2 8961 1 5 1 1

// flat versions
action JSTAND_F 3841 1 1 1 1
action J2STAND_F 24236 1 1 1 1

action ZSTAND_F 4097 1 1 1 1

action PSTAND_F 4996 1 1 1 1
action RSTAND_F 4609 1 1 1 1


action SSTAND_F 4932 1 1 1 1
action S2STAND2_F 22404 1 5 1 1

action RNSTAND_F 5252 1 1 1 1
action GSTAND_F 5277 1 1 1 1
action MSTAND_F 5528 1 1 1 1
action MC_STAND_F 14985 1 1 1 1
action SF_STAND_F 19332 1 1 1 1
action KT_STAND_F 25742 1 1 1 1

action C_STAND_F 6276 1 5 1 1
action MT_STAND_F 24876 1 1 1 1
action JA_STAND_F 11397 1 1 1 1
action BS_STAND_F 8961 1 1 1 1

// running versions

action JRUN2 3861 4 5 1 10
action J2RUN2 24241 4 5 1 10
action J3RUN2 25998 4 5 1 10

action ZRUN2 4117 4 5 1 10

action PRUN2 4996 4 5 1 10
action P2RUN2 25048 4 5 1 10

action RRUN2 4624 4 5 1 10
action R2_RUN2 30345 4 5 1 10

action SRUN2 4932 4 5 1 10
action S2RUN2 22404 4 5 1 10

action RNRUN2 5252 4 5 1 10
action GRUN2 5026 4 5 1 10
action MRUN2 5508 4 5 1 10
action MC_RUN2 14990 4 5 1 10
action SF_RUN2 19337 4 5 1 10
action KT_RUN2 25747 4 5 1 10

action MT_RUN2 24880 4 5 1 10

action C_RUN2 6276 5 5 1 10
action BS_RUN2 8505 4 5 1 10
action JA_RUN2 11407 4 5 1 10

move fake_player_run 120 0

var DUMMY_MOVEMENT 0 2

spriteshadow 1404
useractor notenemy 1404 100 0
state facing_code
state spawn_cold_breathe

ife sprite[].cstat 80 nullop else
ifand ZVELSAVED 2 nullop else
{
ifaction MSTAND2 sizeat 23 23 else
ifaction ZSTAND2 sizeat 22 22 else
ifaction JSTAND2 sizeat 22 22 else
ifaction J2STAND2 sizeat 22 22 else
ifaction J3STAND2 sizeat 22 22 else
ifaction RSTAND2 sizeat 23 23 else
ifaction R2_STAND2 sizeat 24 24 else
ifaction GSTAND2 sizeat 21 21 else
ifaction SSTAND2 sizeat 24 24 else
ifaction S2STAND2 sizeat 22 22 else
ifaction MT_STAND2 sizeat 21 21 else
ifaction RNSTAND2 sizeat 23 23 else
ifaction RNSTAND2_2 sizeat 23 23 else
ifaction JA_STAND2 sizeat 23 23 else
ifaction PSTAND2 sizeat 22 22 else
ifaction P2STAND2 sizeat 22 22 else
ifaction MC_STAND2 sizeat 23 23 else
ifaction SF_STAND2 sizeat 21 21 else
ifaction KT_STAND2 sizeat 23 23 else
ifaction BS_STAND2 sizeat 22 22 else
ifaction C_STAND2 sizeat 24 24 else

ifaction MRUN2 sizeat 23 23 else
ifaction JRUN2 sizeat 22 22 else
ifaction J2RUN2 sizeat 22 22 else
ifaction J3RUN2 sizeat 22 22 else
ifaction ZRUN2 sizeat 22 22 else
ifaction RRUN2 sizeat 23 23 else
ifaction R2_RUN2 sizeat 24 24 else
ifaction GRUN2 sizeat 21 21 else
ifaction SRUN2 sizeat 25 25 else
ifaction S2RUN2 sizeat 22 22 else
ifaction MT_RUN2 sizeat 21 21 else
ifaction RNRUN2 sizeat 23 23 else
ifaction PRUN2 sizeat 22 22 else
ifaction P2RUN2 sizeat 22 22 else
ifaction MC_RUN2 sizeat 23 23 else
ifaction SF_RUN2 sizeat 21 21 else
ifaction KT_RUN2 sizeat 23 23 else
ifaction BS_RUN2 sizeat 22 22 else
ifaction JA_RUN2 sizeat 23 23 else
ifaction C_RUN2 sizeat 24 24 else
sizeat 34 34
}

ifand ZVELSAVED 1
	{
	ifvarn ZPOS_SAVED 0 seta[].z ZPOS_SAVED
	}
	else fall

ifspawnedby APLAYER { set EXTRASAVED -1 ife PCAMERA 0 killit }

ifl EXTRASAVED -1 set EXTRASAVED -1

ifg HITAGSAVED 0 state facing_code

ife HITAGSAVED 1 { ifn camerasprite -1 cstat 0 else cstat 32768 }

// hitag > 2 -- if in cutscene, check if activated, then make visible
ifg HITAGSAVED 2
{
    ifl camerasprite 0
        cstat 32768
    else
    {
        checkactivatormotion HITAGSAVED
        ife RETURN 1 cstat 0
    }
}

ifspawnedby RESPAWN
	{
	ife HITAGSAVED 2
		{
		checkactivatormotion 811
		ife RETURN 1 killit
		}
	}

ifn OWNERSAVED -1
	{
	checkactivatormotion OWNERSAVED
	ife RETURN 1 killit
	}

ife EXTRASAVED -1
	{
	geta[].htflags temp
	xorvar temp 4
	seta[].htflags temp

	ifand sprite[].cstat 16
	{
		ife CHAR 0 { ifand CHAR_APP 1 action J2STAND_F else action JSTAND_F }  else
		ife CHAR 1 { ifspritepal 0 spritepal 21 action ZSTAND_F } else
		ife CHAR 2 { ifspritepal 0 spritepal 21 action PSTAND_F } else
		ife CHAR 3 { ifspritepal 0 spritepal 3 action RSTAND_F } else
		ife CHAR 4 { ifspritepal 0 spritepal 21 ifand CHAR_APP 2 action S2STAND2_F else action SSTAND_F } else
		ife CHAR 5 { ifspritepal 0 spritepal 12 action RNSTAND_F } else
		ife CHAR 6 { ifspritepal 0 spritepal 21 action GSTAND_F } else
		ife CHAR 7 { ifspritepal 0 spritepal 11 action MSTAND_F } else
		ife CHAR 9 action C_STAND_F else
		ife CHAR 10 action BS_STAND_F else
		ife CHAR 11 action MT_STAND_F else
		ife CHAR 12 { ifspritepal 0 spritepal 3 action JA_STAND_F } else
		ife CHAR 13 { ifspritepal 0 spritepal 3 action MC_STAND_F } else
		ife CHAR 14 { ifspritepal 0 spritepal 3 action SF_STAND_F } else
		ife CHAR 17 { ifspritepal 0 spritepal 3 action KT_STAND_F }
	}
	else
		{
		ife CHAR 0 { ifand CHAR_APP 64 action J3STAND2 else ifand CHAR_APP 1 action J2STAND2 else action JSTAND2 } else
		ife CHAR 1 { spritepal 21 action ZSTAND2 } else
		ife CHAR 2 { spritepal 21 ifand CHAR_APP 4 action P2STAND2 else action PSTAND2 } else
		ife CHAR 3 { spritepal 11 ifand CHAR_APP 16 action R2_STAND2 else action RSTAND2 } else
		ife CHAR 4 { spritepal 21 ifand CHAR_APP 2 action S2STAND2 else action SSTAND2 } else
		ife CHAR 5 { spritepal 12 ifand CHAR_APP 32 action RNSTAND2_2 else action RNSTAND2 } else
		ife CHAR 6 { spritepal 21 action GSTAND2 } else
		ife CHAR 7 { spritepal 11 action MSTAND2 } else
		ife CHAR 9 action C_STAND2 else
		ife CHAR 10 action BS_STAND2 else
		ife CHAR 11 action MT_STAND2 else
		ife CHAR 12 { spritepal 3 action JA_STAND2 } else
		ife CHAR 13 { spritepal 3 action MC_STAND2 } else
		ife CHAR 14 { spritepal 3 action SF_STAND2 } else
		ife CHAR 17 { spritepal 3 action KT_STAND2 }
		ife DUMMY_MOVEMENT 0 set DUMMY_MOVEMENT 1
		}
	}
else
	{
	ifaction 0
	 ifg player[].player_par 10 // gives some time for timezone actor to kick in
		{
		ifg EXTRASAVED 99 // sets character to which character beat chosen levels
			{
			readarrayfromfile BEATEN_LEVEL_CHAR F_PLAYED_AS_AMCTC
			ife EXTRASAVED 100 set EXTRASAVED BEATEN_LEVEL_CHAR[0] // City under siege
			ife EXTRASAVED 101 set EXTRASAVED BEATEN_LEVEL_CHAR[1] // Chisland
			ife EXTRASAVED 102 set EXTRASAVED BEATEN_LEVEL_CHAR[2] // X64-2
			ife EXTRASAVED 103 set EXTRASAVED BEATEN_LEVEL_CHAR[3] // Egypt
			ife EXTRASAVED 104 set EXTRASAVED BEATEN_LEVEL_CHAR[4] // Base Invasion
			ife EXTRASAVED 105 set EXTRASAVED BEATEN_LEVEL_CHAR[5] // Megabase
			ife EXTRASAVED 106 set EXTRASAVED BEATEN_LEVEL_CHAR[6] // Dis Base
			ife EXTRASAVED 200 // for chisland ending cutscene
				{
				ife CHARSELECT 0
					{
					ife CHAR 0 killit
					else ife CHAR 13 killit
					else set EXTRASAVED CHAR
					}
				}
			}
		else
			{
			ife EXTRASAVED 0
				{
				ifand CHAR_APP 64 action J3STAND2
				else ifand CHAR_APP 1 action J2STAND2
				else action JSTAND2
				}
			ife EXTRASAVED 1 { ifspritepal 0 spritepal 21 action ZSTAND2 }
			ife EXTRASAVED 2 { ifspritepal 0 spritepal 21 ifand CHAR_APP 4 action P2STAND2 else action PSTAND2 }
			ife EXTRASAVED 3 { ifand CHAR_APP 16 action R2_STAND2 else action RSTAND2 ifspritepal 0 spritepal 11 }
			ife EXTRASAVED 4
				{
				ifspritepal 0 spritepal 21 state spawn_bat setactorvar[RETURN].HITAGSAVED HITAGSAVED
				ifand CHAR_APP 2 action S2STAND2 else action SSTAND2
				}
			ife EXTRASAVED 5 { ifspritepal 0 spritepal 12 ifand CHAR_APP 32 action RNSTAND2_2 else action RNSTAND2 }
			ife EXTRASAVED 6 { ifspritepal 0 spritepal 21 action GSTAND2 }
			ife EXTRASAVED 7 { ifspritepal 0 spritepal 11 action MSTAND2 }
			ife EXTRASAVED 9 action C_STAND2
			ife EXTRASAVED 10 action BS_STAND2
			ife EXTRASAVED 11 action MT_STAND2
			ife EXTRASAVED 12 action JA_STAND2
			ife EXTRASAVED 13 { ifspritepal 0 spritepal 3 action MC_STAND2 }
			ife EXTRASAVED 14 { ifspritepal 0 spritepal 3 action SF_STAND2 }
			ife EXTRASAVED 17 { ifspritepal 0 spritepal 3 action KT_STAND2 }
			}
		set DUMMY_MOVEMENT 1
		}
	}

ife DUMMY_MOVEMENT 1 // 'Idle'
	{
	move STOP
	ifn LOTAGSAVED 0
		{
		checkactivatormotion LOTAGSAVED
			ife RETURN 1
				{
				ife EXTRASAVED -1 set EXTRASAVED CHAR
				ife EXTRASAVED 0
					{
					ifand CHAR_APP 64 action J3RUN2 else
					ifand CHAR_APP 1 action J2RUN2 else
					action JRUN2
					}
				ife EXTRASAVED 1 action ZRUN2
				ife EXTRASAVED 2
					{
					ifand CHAR_APP 4 action P2RUN2 else
					action PRUN2
					}
				ife EXTRASAVED 3
					{
					ifand CHAR_APP 16 action R2_RUN2 else
					action RRUN2
					}
				ife EXTRASAVED 4
					{
					ifand CHAR_APP 2 action S2RUN2 else
					action SRUN2
					}
				ife EXTRASAVED 5 action RNRUN2
				ife EXTRASAVED 6 action GRUN2
				ife EXTRASAVED 7 action MRUN2
				ife EXTRASAVED 9 action C_RUN2
				ife EXTRASAVED 10 action BS_RUN2
				ife EXTRASAVED 11 action MT_RUN2
				ife EXTRASAVED 12 action JA_RUN2
				ife EXTRASAVED 13 action MC_RUN2
				ife EXTRASAVED 14 action SF_RUN2
				ife EXTRASAVED 17 action KT_RUN2
				set DUMMY_MOVEMENT 2
				}
		}
	}
ife DUMMY_MOVEMENT 2 // 'Running'
	{
	ifand ZVELSAVED 1 nullop else fall
	move fake_player_run geth
	randvar footstep_count 3
	add temp4 1
	ifg temp4 8
		{
		ife footstep_count 0 globalsound STEP1 else
		ife footstep_count 1 globalsound STEP2 else
		ife footstep_count 2 globalsound STEP3 else
		ife footstep_count 3 globalsound STEP4
		set temp4 0
		}
	sub YVELSAVED 1
	ifl YVELSAVED 1
		{
		move STOP
		ifn EXTRASAVED -1
			{
			ife EXTRASAVED 0 { ifand CHAR_APP 64 action J3STAND2 else ifand CHAR_APP 1 action J2STAND2 else action JSTAND2 }
			ife EXTRASAVED 1 action ZSTAND2
			ife EXTRASAVED 2 { ifand CHAR_APP 4 action P2STAND2 else action PSTAND2 }
			ife EXTRASAVED 3
				{
				ifand CHAR_APP 16 action R2_STAND2
				else
				action RSTAND2
				}
			ife EXTRASAVED 4
				{
				ifand CHAR_APP 2 action S2STAND2 else
				action SSTAND2
				}
			ife EXTRASAVED 5
				{
				ifand CHAR_APP 32 action RNSTAND2_2
				else
				action RNSTAND2
				}
			ife EXTRASAVED 6 action GSTAND2
			ife EXTRASAVED 7 action MSTAND2
			ife EXTRASAVED 9 action C_STAND2
			ife EXTRASAVED 10 action BS_STAND2
			ife EXTRASAVED 11 action MT_STAND2
			ife EXTRASAVED 12 action JA_STAND2
			ife EXTRASAVED 13 action MC_STAND2
			ife EXTRASAVED 14 action SF_STAND2
			ife EXTRASAVED 17 action KT_STAND2
			}
		else
			{
			ife CHAR 0 { ifand CHAR_APP 64 action J3STAND2 else ifand CHAR_APP 1 action J2STAND2 else action JSTAND2 } else
			ife CHAR 1 action ZSTAND2 else
			ife CHAR 2 { ifand CHAR_APP 4 action P2STAND2 else action PSTAND2 } else
			ife CHAR 3 { ifand CHAR_APP 16 action R2_STAND2 else action RSTAND2 } else
			ife CHAR 4 { ifand CHAR_APP 2 action S2STAND2 else action SSTAND2 } else
			ife CHAR 5 { ifand CHAR_APP 32 action RNSTAND2_2 else action RNSTAND2 } else
			ife CHAR 6 action GSTAND2 else
			ife CHAR 7 action MSTAND2 else
			ife CHAR 9 action C_STAND2 else
			ife CHAR 10 action BS_STAND2 else
			ife CHAR 11 action MT_STAND2 else
			ife CHAR 12 action JA_STAND2 else
			ife CHAR 13 action MC_STAND2 else
			ife CHAR 14 action SF_STAND2 else
			ife CHAR 17 action KT_STAND2 
			}
		set DUMMY_MOVEMENT 1
		}
	}

ifn temp9 0
	{
	fall
	ifvarvarn temp9 CONTROL_VR killit
	}

enda

action JS_D_PAIN 3948
action JS2_D_PAIN 24322

action Z_D_PAIN 4204

action MRL_D_PAIN 5017

action HIGH_D_PAIN 4716

action SANG_D_PAIN 4953
action SANG2_D_PAIN 22532

action RUSTY_D_PAIN 5293

action GEO_D_PAIN 5047

action MIKKO_D_PAIN 5539

action CULT_D_PAIN 6366

action MICKY_D_PAIN 15019

action BOMBSHELL_PAIN 8526

action JANE_PAIN 11468

action SNOWF_D_PAIN 19479

action KAG_D_PAIN 25838

// 108
useractor notenemy 1403

	ifinwater
		{
		sleeptime 0
		spawn WATERBUBBLE
		fall
		}

ifaction 0
 ife CHARSELECT 0
	{
	ifspritepal 0
		{
		getp[].palookup temp
		seta[].pal temp
		}
	ife CHAR 0 { ifand CHAR_APP 1 action JS2_D_PAIN else action JS_D_PAIN } else
	ife CHAR 1 action Z_D_PAIN else
	ife CHAR 2 { ifspritepal 0 spritepal 21 action MRL_D_PAIN } else
	ife CHAR 3 { ifspritepal 0 spritepal 3 action HIGH_D_PAIN } else
	ife CHAR 4
		{ ifspritepal 0 spritepal 21
		ifand CHAR_APP 2 action SANG2_D_PAIN else action SANG_D_PAIN
		}
		else
	ife CHAR 5 { ifspritepal 0 spritepal 12 action RUSTY_D_PAIN } else
	ife CHAR 6 { ifspritepal 0 spritepal 21 action GEO_D_PAIN } else
	ife CHAR 7 { ifspritepal 0 spritepal 11 action MIKKO_D_PAIN } else
	ife CHAR 9 action CULT_D_PAIN else
	ife CHAR 10 action BOMBSHELL_PAIN else
	ife CHAR 12 action JANE_PAIN else
	ife CHAR 13 { ifspritepal 0 spritepal 3 action MICKY_D_PAIN }
	ife CHAR 14 { ifspritepal 0 spritepal 3 action SNOWF_D_PAIN }
	ife CHAR 17 { ifspritepal 0 spritepal 3 action KAG_D_PAIN }
	}

ifaction JS_D_PAIN sizeat 23 23 else
ifaction JS2_D_PAIN sizeat 23 23 else
ifaction MIKKO_D_PAIN sizeat 25 25 else
ifaction GEO_D_PAIN sizeat 25 25 else
ifaction HIGH_D_PAIN sizeat 21 21 else
ifaction SANG_D_PAIN sizeat 25 25 else
ifaction SANG2_D_PAIN sizeat 25 25 else
ifaction RUSTY_D_PAIN sizeat 23 23 else
ifaction MRL_D_PAIN sizeat 22 22 else
ifaction MICKY_D_PAIN sizeat 23 23 else
ifaction SNOWF_D_PAIN sizeat 21 21 else
ifaction KAG_D_PAIN sizeat 23 23 else
sizeat 34 34

enda

// TRIGGER ONLY IF CHAR==========================================================================================================

useractor notenemy TRIGGERONLYIFCHAR
cstat 32768

ifn HITAGSAVED 0
	{
	checkactivatormotion HITAGSAVED
	ife RETURN 1 set HITAGSAVED 0
	}
else
{
ife YVELSAVED 0 set YVELSAVED 1024

dist temp6 THISACTOR player[].i

ifl temp6 YVELSAVED
	{
	ifspritepal 0 ifn CHAR 0 break
	ifspritepal 1 ifn CHAR 1 break
	ifspritepal 2 ifn CHAR 2 break
	ifspritepal 3 ifn CHAR 3 break
	ifspritepal 4 ifn CHAR 4 break
	ifspritepal 5 ifn CHAR 5 break
	ifspritepal 6 ifn CHAR 6 break
	ifspritepal 7 ifn CHAR 7 break
	ifspritepal 9 ifn CHAR 9 break
	ifspritepal 10 ifn CHAR 10 break
	ifspritepal 11 ifn CHAR 11 break
	ifspritepal 12 ifn CHAR 12 break
	ifspritepal 13 ifn CHAR 13 break
	ifspritepal 14 ifn CHAR 14 break
	ifspritepal 15 ifn CHAR 15 break
	ifspritepal 16 ifn CHAR 16 break
	ifspritepal 17 ifn CHAR 17 break
	ifspritepal 40
		{
		findnearactor3dvar VLADMIR YVELSAVED temp4
		ife temp4 -1 { ife XVELSAVED 0 quote 266 break }
		}
	ifspritepal 41
		{
		findnearactor3dvar EDFSOLDIER_ACTIVE YVELSAVED temp4
		ife temp4 -1 { ife XVELSAVED 0 quote 247 break }
		}
	operateactivators LOTAGSAVED THISACTOR
	operaterespawns LOTAGSAVED
	operatemasterswitches LOTAGSAVED
	killit
	}
}

enda

// MOVE PLAYER==========================================================================================================

defstate transfer_player
	// set position relative to target sprite position
	geta[temp].x x
	geta[temp].y y
	geta[temp].z z

	subvarvar x mx
	subvarvar y my
	subvarvar z mz

	geta[temp].sectnum upd_sect
	updatesectorz x y z upd_sect

	ifn upd_sect -1
	{
		setp[].posx x
		setp[].posy y
		setp[].posz z
		setp[].oposx x
		setp[].oposy y
		setp[].oposz z
		setp[].cursectnum upd_sect
		changespritesect PLAYER_IDENTITY upd_sect
	}
ends

useractor notenemy MOVEPLAYER
cstat 32768

// pals 13 and 14 are for "seamless" teleportation effect, see SANGtempLE.MAP for example
// They don't rely on hitags, you need a pair where 13 is the entrance and 14 is the exit
ifspritepal 13
{
	set temp 0

	ife HITAGSAVED 0
	{
		ife player[].cursectnum sprite[].sectnum
			set temp 1
	}
	else
	{
		set MASTERSWITCH_SUBSCRIBE HITAGSAVED
		checkactivatormotion HITAGSAVED
		ife RETURN 1
			set temp 1
		else ife MASTERSWITCH_RETURN 1 // see event_killit
		{
			set temp 1
			set MASTERSWITCH_RETURN 0 // reset it or we'll keep teleporting!
		}
	}
}

ife temp 1
{
	getp[].posx x
	getp[].posy y
	getp[].posz z

	geta[].x mx
	geta[].y my
	geta[].z mz

	subvarvar mx x
	subvarvar my y
	subvarvar mz z

	for temp allsprites
	{
		getav[temp].LOTAGSAVED temp4

		ife sprite[temp].picnum 3713 // other moveplayer sprite
			ife sprite[temp].pal 14 // exit pal
			{
				ife LOTAGSAVED temp4 // same lotag
					state transfer_player
			}
	}
}
else
{
	set temp 0
	set MASTERSWITCH_SUBSCRIBE HITAGSAVED
	checkactivatormotion HITAGSAVED
	ife RETURN 1
		set temp 1
	else ife MASTERSWITCH_RETURN 1 // see event_killit
	{
		set temp 1
		set MASTERSWITCH_RETURN 0 // reset it or we'll keep teleporting!
	}

	ife temp 1
	{
		geta[].sectnum upd_sect
		updatesectorz sprite[].x sprite[].y sprite[].z upd_sect
		ifn upd_sect -1
			{
			setp[].cursectnum upd_sect
			changespritesect PLAYER_IDENTITY upd_sect
			}
		setp[].falling_counter 0
		setp[].posx sprite[].x
		setp[].posy sprite[].y
		setp[].posz sprite[].z
		stopsound WIND_FALL_RAPID
		stopsound LAND_HEAVY
		setp[].ang sprite[].ang
		ifspritepal 1
		{
			globalsound TELEPORTER
			spawn TRANSPORTERBEAM
			palfrom 10 10 10 10
		}
		else ifspritepal 2 state hard_removefollower
		else ifspritepal 3
			setgamepalette 1
		else ifspritepal 4
		{
			state fade_out_white
			globalsound USE_TIMEPORTAL
			spawn 8433
		}
		else ifspritepal 5
			state fade_out_black
		else ifspritepal 6
		{
			palfrom 64 0 64 0
			globalsound ACTOR_SHRINKING
			set PLAYER_VOICEOVER 30
			set fake_shrunk 1
			state hard_removefollower
		}
		else ifspritepal 7
		{
			state fade_out_white
			globalsound ACTOR_UNSHRINK
			set fake_shrunk 0
			state hard_removefollower
		}
		else ifspritepal 8
			setgamepalette 0
		else ifspritepal 9
		{
			state fade_out_white
			globalsound MIND_ATTACK
		}
		else ifspritepal 10
		{
			state fade_out_white
			globalsound USE_PORTAL
		}
		else ifspritepal 11
		{
			state fade_out_white
		}
		else ifspritepal 12
		{
			stopallsounds
			globalsound PLYR_SCREAM
		}
		else ifspritepal 15
		{
			state fade_out_black
		}
		else ifspritepal 16
		{
			state fade_out_white
			globalsound HEARTBEAT
		}
		else ifspritepal 17
		{
			globalsound LAND_HEAVY
			wackplayer
		}

		set player_in_vehicle 0
		set player_using_fighter -1
		set player_using_hovercraft -1
		killit
	}
}
enda
