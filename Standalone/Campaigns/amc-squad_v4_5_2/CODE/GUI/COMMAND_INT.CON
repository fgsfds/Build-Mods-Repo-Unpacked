/*
-------------------------------------------------------------------------------
===============================================================================

         -ooo:             +oo-            `+oo.       ./+oooooooooo+/:
        /NMMMN+            NMMNo`         -dMMM/      .mMMNmmmmmmmmmMMNo
       /NMd:mMMo           NMMNMd:      `oNMNMM/      :MMM/.........mMMh
      oNMd. -mMMy`         NMN:mMNs`   -hMm/mMM/      :MMM:         ::-.
    `sMMh`   .dMMh`        NMN .sNMd:`oNMh. mMM/      :MMM:
   `yMMMdhhhhhmMMMd.       NMN   /mMNdMm+`  mMM/      :MMM:         ss+:
  `hMMdhhhhhhhhhmMMm-      NMN    .yMMh.    mMM/      :MMM/.........mMMh
 .dMMs`         .hMMm:     NMN      :/`     mMM/      .mMMNmmmmmmmmmMMNo
 :oo+            `+oo+     +o+              +oo.       ./++ooooooooo+/:

###############################################################################
+ The AMC Squad
+ CON code by James Stanfield, Cedric "Sangman" Haegeman, Dino Bollinger,
+              Mikko Sandt, Cedric "Zaxtor" Lutes and Dan "Danarama" Gaskill
-------------------------------------------------------------------------------
* See AMC_MAIN.CON for a full list of script authors.

Feel free to use any code in the game for your own uses; just make
sure to mention the authors and/or "The AMC Squad" in your credits.
--------------------------------------------------------------------------------
NOTES:

--------------------------------------------------------------------------------
*/



// =========================================================================================================================================
// *****************************************************************************************************************************************
// COMMAND SCREEN STUFF
// *****************************************************************************************************************************************
// =========================================================================================================================================

// 0 = Earth
// 1 = Sol System
// 2 = Moon
// 3 = Ganymede
// 4 = Io
// 5 = Mars
// 10 = Local cloud
// 11 = Ishteg
// 12 = Xuglop
// 13 = Ractonia
// 14 = 33 boo
// 15 = Umbriel
// 16 = USA
// 17 = Europe
// 18 = Milky way
// 19 = Elysion
// 20 = Abyss
// 21 = Elysion surface
// 22 = Ceres
// 23 = Haumea
// 24 = Makemake
// 25 = Eris
// 26 = Venus

define MI_JAMES 31720
define MI_ZAXTOR 31721
define MI_MERLIJN 31722
define MI_HIGHWIRE 31723
define MI_SANG 31724
define MI_RUSTY 31725
define MI_GEOFFREY 31726
define MI_MIKKO 31727
define MI_MICKY 31733
define MI_SNOWFALL 31734
define MI_KAGURA 31736
define MI_CULTIST 31729
define MI_BOMBSHELL 31730
define MI_JANE 31732
define MI_MAARTEN 31731

define MISSION_PIC_SIZE 25700

defstate NEW_MAP_DISPLAY
	add rot_flash 1
	ifg rot_flash 2048 set rot_flash 0
	set disp_temp8 2048
	mul disp_temp8 disp_pulse
	rotatespritea gui_pos_x gui_pos_y disp_temp8 rot_flash 3793 disp_pulse 0 0 -255 0 0 xdim ydim
ends

var news_ticker 9200 1
var news_x 400 1

// move the news ticker every X milliseconds to keep the movement smooth, but not too fast on higher framerates
var update_news_ticker -1 1 // set to 1 if update allowed
var news_count -1 1

var mouse_over_element 0 0
var mission_pic_pal 0 0

include CODE/GUI/COMM_ENEMY.CON

defstate STANDARD_INFO_BOX

	rotatespritea 160 100 20000 0 14656 0 disp_temp4 0 -255 0 0 xdim ydim // GUI bit
	rotatespritea 160 100 20000 0 14755 0 0 0 -255 0 0 xdim ydim // GUI bit

	ifn disp_temp4 36 // don't display difficulty for factory stuff
	rotatespritea 114 117 16384 0 14659 0 0 0 -255 0 0 xdim ydim

	set gui_pos_x 212
	set gui_pos_y 72
	state CURSOR_OVER_ITEM

	// exit button
	ife mouse_over_element 0
	{
	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	    ifl gui_pos_y_temp 8
		 ifg gui_pos_y_temp -8
		  {
		  rotatespritea gui_pos_x gui_pos_y 15000 0 14655 0 disp_temp4 0 -255 0 0 xdim ydim
		  ifand BITS_PRESS 4
		   ife button_counter 0
			{
			sound INTERFACE_3
			set INFO_SEL 0
			set rollover_sound 0
			set button_counter 15
			}
		  }
		else
		rotatespritea gui_pos_x gui_pos_y 15000 0 14654 0 disp_temp4 0 -255 0 0 xdim ydim
	}

ends

defstate PAPER_INFO_BOX

	set gui_pos_x 114
	set gui_pos_y 130
	state CURSOR_OVER_ITEM

	// exit button

	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	    ifl gui_pos_y_temp 8
		 ifg gui_pos_y_temp -8
		  {
		  rotatesprite 160 100 NNORMALSIZE 0 22713 0 disp_temp4 0 0 0 xdim ydim
		  ifand BITS_PRESS 4
			{
			sound BOOK_CLOSE
			set INFO_SEL 0
			set rollover_sound 0
			}
		  }
		else
	rotatesprite 160 100 NNORMALSIZE 0 22712 0 disp_temp4 0 0 0 xdim ydim // GUI bit

ends

gamevar BOX_TOGGLE 0 1

defstate PRECOG_BOX
	ife BASE_RESEARCH[5] 2 // has the precog brain?
	{
		set gui_pos_x 153
		set gui_pos_y 140
		state CURSOR_OVER_ITEM
		ifand BOX_TOGGLE 1 rotatesprite gui_pos_x gui_pos_y 20000 0 14668 0 27 0 0 0 xdim ydim // GUI bit
		else rotatesprite gui_pos_x gui_pos_y 20000 0 14668 0 49 0 0 0 xdim ydim // GUI bit

		ifl gui_pos_x_temp 15
		 ifg gui_pos_x_temp -15
		   ifl gui_pos_y_temp 10
			ifg gui_pos_y_temp -10
			{
			set mouse_hint 3092 // refers to quote in user.con
			sub mouse_hint_timer 2
			  ifand BITS_PRESS 4
			   ife button_counter 0
				{
				state clear_precog
				sound INTERFACE_1
				xorvar BOX_TOGGLE 1
				set button_counter 15
				}
			}
	}
ends

defstate AIRDROP_BOX

set gui_pos_x 215
set gui_pos_y 140
state CURSOR_OVER_ITEM

	setvar airdrop_available 1
	rotatesprite gui_pos_x gui_pos_y 20000 0 14736 0 0 0 0 0 xdim ydim // GUI bit


ends

defstate FLY_SCENE
ife play_sound 0
	{
	ifrnd 96 screensound FLY_MUSIC1
	else ifrnd 96 screensound FLY_MUSIC2
	else screensound FLY_MUSIC3
	set play_sound 1
	}
operateactivators 20022 THISACTOR
ends

defstate FLY_SF_SCENE
ife play_sound 0
	{
	ifrnd 96 screensound FLY_MUSIC1
	else ifrnd 96 screensound FLY_MUSIC2
	else screensound FLY_MUSIC3
	set play_sound 1
	}
operateactivators 2500 THISACTOR
ends

defstate CHAOS_SCENE
ife play_sound 0
	{
	screensound CHAOS_MUSIC
	set play_sound 1
	}
operateactivators 2600 THISACTOR
ends

defstate RINGW_SCENE
ife play_sound 0
	{
	ifrnd 96 screensound FLY_MUSIC1
	else ifrnd 96 screensound FLY_MUSIC2
	else screensound FLY_MUSIC3
	set play_sound 1
	}
ife VOLUME 4 operateactivators 32050 THISACTOR
else startlevel mis_vol mis_lev
ends

defstate ELYSION_MAPS

	ife m_charselect_used 1
	  ife m_charselect_forced 0
	{
		// For forced missions the CHAR is already set below. Might refactor that into this if but not yet
		state mission_setcharfromselect
	}

	ife INFO_SEL 63 // Clicked easthaven
	{
		// If all quests are done, it's attack time
		ifand ELYSION_QUEST 64 // Micky quest done?
		 ifand ELYSION_QUEST 256 // Sang quest done?
		   ifand ELYSION_QUEST 2048 // Snowfall quest done?
		    ifand ELYSION_QUEST 4096 // James quest done?
			 ifand ELYSION_QUEST 16384 // Kagura quest done?
			  ifand ELYSION_QUEST 131072  // Merlijn Quest done?
		{
			// if we've also talked to Drabeus after the attack though it's the hub map again
			ifand ELYSION_QUEST 1
				startlevel 3 5
			else
				startlevel 3 37 // attack map
		}
		else startlevel 3 5 // Easthaven, hub map
	}
	ife INFO_SEL 64 { set CHAR 13 ife amc_base 0 operateactivators 1100 THISACTOR else { set mis_vol 3 set mis_lev 9 state RINGW_SCENE } } // forest, Micky's map (Map 1)
	ife INFO_SEL 65 { set CHAR 2 ife amc_base 0 operateactivators 1040 THISACTOR else { set mis_vol 3 set mis_lev 7 state RINGW_SCENE } } // Hamprock, Merlijn (Map 1)
	ife INFO_SEL 68 { set CHAR 5 ife amc_base 0 operateactivators 1080 THISACTOR else { set mis_vol 3 set mis_lev 17 state RINGW_SCENE } } // Graveyard, Rusty (Map 1)
	ife INFO_SEL 69 { set CHAR 14 ife amc_base 0 operateactivators 1160 THISACTOR else { set mis_vol 3 set mis_lev 12 state RINGW_SCENE } } // Reservoir, Snowfall (Map 1)
	ife INFO_SEL 70 { set CHAR 4 ife amc_base 0 operateactivators 1060 THISACTOR else { set mis_vol 3 set mis_lev 6 state RINGW_SCENE } } // Sjoerd's woodland, Sang (Map 1)
	ife INFO_SEL 71 { set CHAR 0 ife amc_base 0 operateactivators 1000 THISACTOR else { set mis_vol 3 set mis_lev 15 state RINGW_SCENE } } // Darrow Lake, James (Map 1)
	ife INFO_SEL 72 { set CHAR 17 ife amc_base 0 operateactivators 1120 THISACTOR else { set mis_vol 3 set mis_lev 24 state RINGW_SCENE } } // Canyons, Kagura
	ife INFO_SEL 74 { ife amc_base 0 { stopallmusic stopallsounds startcutscene 1327 } clearmapstate 218 { set mis_vol 3 set mis_lev 41 state RINGW_SCENE } } // Palace of Rowgar
	ife INFO_SEL 75 { startlevel 3 27 } // Sky islands
	ife INFO_SEL 76 { startlevel 3 18 } // Sky caves
	ife INFO_SEL 77 { startlevel 3 55 } // Necromancer's keep
	ife INFO_SEL 78 { setvar CHAR 7 ife amc_base 0 operateactivators 1140 THISACTOR else { set mis_vol 3 set mis_lev 39 state RINGW_SCENE } } // Serpent Canyon
ends

defstate PAPER_TRAVEL_BOX
ife mouse_over_element 1 set mission_pic_pal 27 else set mission_pic_pal 0
set gui_pos_x 203
set gui_pos_y 140
state CURSOR_OVER_ITEM

// Launch button
	ifl gui_pos_x_temp 25
	 ifg gui_pos_x_temp -25
	    ifl gui_pos_y_temp 10
		 ifg gui_pos_y_temp -10
		  {
		  set mouse_over_element 1
		  rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 22710 0 disp_temp4 0 0 0 xdim ydim
		  ifand BITS_PRESS 4
		   ife button_counter 0
			{
			screensound BOOK_CLOSE // Launch level
			state fade_out_black
			set cus_fade_duration 5
			set PCINTER 0
			set MOUSEUP 0
			set give_loadout 1
			set amcbase_level LEVEL
			set amcbase_volume VOLUME
			ifn RAINREPLACE 0 set RAINREPLACE 0
			state ELYSION_MAPS
			set INFO_SEL 0
			}
		  }
		else
		{
		set mouse_over_element 0
		rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 22709 0 disp_temp4 0 0 0 xdim ydim // GUI bit
		}

ends

defstate MISSION_START_BOX
ife mouse_over_element 1 set mission_pic_pal 27 else set mission_pic_pal 0
set gui_pos_x 110
set gui_pos_y 140
state CURSOR_OVER_ITEM

	// Launch button
	ifl gui_pos_x_temp 25
	 ifg gui_pos_x_temp -25
	    ifl gui_pos_y_temp 10
		 ifg gui_pos_y_temp -10
		  {
		  set mouse_over_element 1
		  rotatesprite gui_pos_x gui_pos_y INVENSIZE 0 14667 0 2 0 0 0 xdim ydim
		  ifand BITS_PRESS 4
		   ife button_counter 0
			{
			writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
			screensound INTERFACE_1 // Launch level
			state fade_out_black
			set cus_fade_duration 5
			set PCINTER 0
			set MOUSEUP 0

				ife m_charselect_used 1
				  ife m_charselect_forced 0
				{
					// For forced missions the CHAR is already set below. Might refactor that into this if but not yet
					state mission_setcharfromselect
				}
			set give_loadout 1
			state strip_inventory
			state strip_ammo_and_weapons
			state strip_keys
			
			set amcbase_level LEVEL
			set amcbase_volume VOLUME
			ifn RAINREPLACE 0 set RAINREPLACE 0
			stopsound COMMAND_AMB5
			stopsound COMMAND_AMB6
			stopsound COMMAND_AMB7
			stopsound COMMAND_AMB8
			stopsound COMMAND_AMB4
			stopsound COMMAND_AMB3
			stopsound COMMAND_AMB2
			stopsound COMMAND_AMB
			stopsound COMM_AMB_ALT
			stopsound ENTERDIS

				state give_assigned_weapon


				ife INFO_SEL 2 startlevel 0 2 // Megabase
				ife INFO_SEL 7 { set mis_vol 0 set mis_lev 4 state FLY_SCENE } // Dis base
				ife INFO_SEL 8 startlevel 0 5 // The Abyss
				ife INFO_SEL 9 startlevel 0 15 // Scarlet Hollow
				ife INFO_SEL 3 // Millhaven
					{
					set CHAR 5
					clearmapstate 11
					clearmapstate 14
					set mis_vol 0 set mis_lev 11 state FLY_SCENE
					}
				ife INFO_SEL 4 { set CHAR 7 set mis_vol 0 set mis_lev 12 state FLY_SCENE } // Snowbase
				ife INFO_SEL 6 { set CHAR 0 set mis_vol 0 set mis_lev 9 set play_sound 1 screensound FLY_FINALE state FLY_SCENE } // Providence
				ife INFO_SEL 5 { set CHAR 3 startlevel 0 20 } // Revolution
				// EPISODE 2 =================================================================================
				ife INFO_SEL 10 { set mis_vol 1 set mis_lev 2 state FLY_SCENE } // City Under siege
				ife INFO_SEL 11 startlevel 1 5 // Big Trouble in China
				ife INFO_SEL 12 { set mis_vol 1 set mis_lev 7 state FLY_SCENE } // Fishing Wharf
				ife INFO_SEL 13 { set mis_vol 1 set mis_lev 45 state FLY_SCENE } // Island Facility
				ife INFO_SEL 14 { set mis_vol 1 set mis_lev 23 state FLY_SCENE } // Tower of Life
				ife INFO_SEL 15 { set mis_vol 1 set mis_lev 24 state FLY_SCENE } // Hidden Dojo
				ife INFO_SEL 16 { set mis_vol 1 set mis_lev 25 state FLY_SCENE } // Oilrig
				ife INFO_SEL 17 { set CHAR 7 set mis_vol 1 set mis_lev 57 set jump_gate 1 state FLY_SCENE } // Energia
				ife INFO_SEL 20 { set mis_vol 1 set mis_lev 10 state FLY_SCENE } // Repent your sins
				ife INFO_SEL 21 { set CHAR 13 set mis_vol 1 set mis_lev 16 state FLY_SCENE } // Ghost Ship
				ife INFO_SEL 22 { set mis_vol 1 set mis_lev 36 state FLY_SCENE } // The Lurking Fear

				ife INFO_SEL 24 { set mis_vol 1 set mis_lev 18 set jump_gate 1 state FLY_SCENE } // Xuglop Train
				ife INFO_SEL 25 { set CHAR 0 set mis_vol 1 set mis_lev 26 state FLY_SCENE } // Far mountain reaches
				ife INFO_SEL 26 // Spacestation
					{
					set CHAR 0
					clearmapstate 78
					clearmapstate 79
					set mis_vol 1 set mis_lev 14 state FLY_SCENE
					}
				ife INFO_SEL 27 // mars asia mons colony
					{
					set CHAR 4
					clearmapstate 78
					clearmapstate 79
					set mis_vol 1 set mis_lev 40
					set play_sound 1 screensound FLY_FINALE
					state FLY_SCENE
					}
				ife INFO_SEL 112 { set mis_vol 1 set mis_lev 30 set play_sound 1 screensound FLY_HUB state FLY_SCENE } // Vehicle test site
				ife INFO_SEL 90 // zeta base
					{
					clearmapstate 95
					clearmapstate 126
					clearmapstate 127
					set mis_vol 1 set mis_lev 62 state FLY_SCENE
					}
				// EPISODE 3 =================================================================================
				ife INFO_SEL 29 { set CHAR 1 set mis_vol 1 set mis_lev 55 state FLY_SCENE } // Jungle base
				ife INFO_SEL 30 // Egypt
					{
					set EGYPT_KEYS 0
					set EGYPT_ARTIFACTS 0
					clearmapstate 134
					clearmapstate 135
					clearmapstate 136
					clearmapstate 137
					clearmapstate 138
					clearmapstate 139
					clearmapstate 140
					clearmapstate 141
					set mis_vol 2 set mis_lev 5 state FLY_SCENE
					}
				ife INFO_SEL 31 { set mis_vol 2 set mis_lev 2 state FLY_SCENE } // X64-2M
				ife INFO_SEL 40 { set mis_vol 1 set mis_lev 22 set play_sound 1 screensound FLY_HUB state FLY_SCENE } // New LA (hub level)
				ife INFO_SEL 41 { set mis_vol 2 set mis_lev 32 set play_sound 1 screensound FLY_HUB state FLY_SCENE } // Garmid
				ife INFO_SEL 42 { set mis_vol 2 set mis_lev 16 state CHAOS_SCENE } // Pipedream
				ife INFO_SEL 49 // Micky Begins
					{
					set CHAR 15
					clearmapstate 169
					clearmapstate 170
					clearmapstate 171
					clearmapstate 172
					startlevel 2 40
					}
				ife INFO_SEL 50 { set CHAR 14 set mis_vol 2 set mis_lev 15 state FLY_SF_SCENE } // Neutrino
				ife INFO_SEL 51 { set CHAR 2 set mis_vol 2 set mis_lev 17 state FLY_SCENE } // Spookycut
				ife INFO_SEL 52 { set CHAR 1 set mis_vol 2 set mis_lev 19 state FLY_SCENE } // Jungle pyramid
				ife INFO_SEL 53 { set CHAR 13 set mis_vol 2 set mis_lev 27 state FLY_SCENE } // Eviction Notice
				ife INFO_SEL 80 { set mis_vol 2 set mis_lev 37 state CHAOS_SCENE } // Shellshocked
				ife INFO_SEL 81 { set mis_vol 2 set mis_lev 38 state CHAOS_SCENE } // Caligula Station
				ife INFO_SEL 55 { set CHAR 0 set mis_vol 2 set mis_lev 29 set jump_gate 1 state FLY_SCENE } // Xuglop Assault

				ife INFO_SEL 57 { set CHAR 6 set mis_vol 2 set mis_lev 47 state FLY_SCENE } // Guerillas in the mist
				ife INFO_SEL 58 { set CHAR 14 startlevel 2 36 } // Fake
				ife INFO_SEL 59 { set mis_vol 2 set mis_lev 52 state FLY_SCENE } // Chaosphere
				ife INFO_SEL 60 { set mis_vol 2 set mis_lev 51 state FLY_SF_SCENE } // Charon

				// EPISODE 4 =================================================================================
				ife INFO_SEL 61 { set mis_vol 3 set mis_lev 2 set ELYSION_QUEST 0 savegamevar ELYSION_QUEST set jump_gate 2 state FLY_SF_SCENE } // Elysion Intro
				ife INFO_SEL 62 { set mis_vol 3 set mis_lev 2 set ELYSION_QUEST 0 savegamevar ELYSION_QUEST set jump_gate 2 state FLY_SF_SCENE } // Elysion Intro (after 1st one)
				state ELYSION_MAPS
				// EDF Missions =================================================================================
				ife INFO_SEL 400 { set mis_vol 6 set mis_lev 1 state FLY_SCENE } // Red Saga
				ife INFO_SEL 401 { set mis_vol 6 set mis_lev 6 state FLY_SCENE } // Wet Dream

				ife INFO_SEL 403 { set mis_vol 6 set mis_lev 8 state FLY_SCENE } // Clear the Coast
				ife INFO_SEL 404 { set mis_vol 6 set mis_lev 9 state FLY_SCENE } // Another Big base Attacked
				ife INFO_SEL 405 { set mis_vol 6 set mis_lev 10 state FLY_SCENE } // Driving Home for Christmas
				ife INFO_SEL 406 { set mis_vol 6 set mis_lev 11 state FLY_SCENE } // Wonderful Christmas Time
				ife INFO_SEL 407 { set mis_vol 6 set mis_lev 12 state FLY_SCENE } // Fantasy Hotel
				ife INFO_SEL 408 { set mis_vol 6 set mis_lev 13 state FLY_SCENE } // The Beach CBP
				ife INFO_SEL 409 { set mis_vol 6 set mis_lev 14 state FLY_SCENE } // Secret base
				ife INFO_SEL 410 { set mis_vol 6 set mis_lev 15 state FLY_SCENE } // Underground Fortress

				ife INFO_SEL 411 { set mis_vol 6 set mis_lev 7 state FLY_SCENE } // Dracula's castle

				ife INFO_SEL 412 { set mis_vol 6 set mis_lev 18 state FLY_SCENE } // EDF Bureau
				ife INFO_SEL 415 { set mis_vol 6 set mis_lev 21 state FLY_SCENE } // Daikarin
				ife INFO_SEL 416 { set mis_vol 6 set mis_lev 27 state FLY_SCENE } // The Final confrontation
				ife INFO_SEL 417 { set mis_vol 6 set mis_lev 34 state FLY_SCENE } // Lost Highway

				ife INFO_SEL 430 { set mis_vol 6 set mis_lev 53 state FLY_SCENE } // Alone in the dark with the Undead

				ife INFO_SEL 438 { set mis_vol 6 set mis_lev 61 state FLY_SCENE } // Metropolitan Starlight

			set INFO_SEL 0
			}
		  }
		else
		{
		set mouse_over_element 0
	rotatesprite gui_pos_x gui_pos_y INVENSIZE 0 14667 0 0 0 0 0 xdim ydim // GUI bit
		}

ends

var buying_id 0 1

var mining_id 0 1
var buying_budget 0 1
var buying_supply 0 1

defstate BUY_BOX

set gui_pos_x 110
set gui_pos_y 140
state CURSOR_OVER_ITEM
set mouse_over_element 0
// Purchase button
	ifl gui_pos_x_temp 25
	 ifg gui_pos_x_temp -25
	    ifl gui_pos_y_temp 10
		 ifg gui_pos_y_temp -10
		  {
		  rotatesprite gui_pos_x gui_pos_y 20000 0 14695 0 21 0 0 0 xdim ydim
		  ifand BITS_PRESS 4
			{
			soundonce INTERFACE_1
			set buying_id INFO_SEL
			set INFO_SEL 0
			}
		  }
		else
	rotatesprite gui_pos_x gui_pos_y 20000 0 14695 0 0 0 0 0 xdim ydim // GUI bit

ends

// Used for preparing mission/resource boxes
defstate CLICK_INFO_BOX
ifvarvarn rollover_sound info_number { ife PCINTER 14 sound PAGE_TURN else sound COMM_MOVER set rollover_sound info_number }

	ifand BITS_PRESS 4
	  ifvarvarn INFO_SEL info_number
	  ife button_counter 0
	{
		ifand COM_FILTER 128 nullop
		else ifand COM_FILTER 512 nullop
		else
		{
			ife PCINTER 14 soundonce BOOK_OPEN
			else soundonce INTERFACE_2

			set INFO_SEL info_number
			state clear_precog

			// Clear mission char selection variables
			// Default selection is not forced, can pick any character (that is unlocked)
			set m_charselect_current FLAG_ALL
			set m_charselect_flags FLAG_ALL
			set m_charselect_forced 0
			set m_charselect_used 0
		}
		set button_counter 15
	}
ends

defstate MINE_BOX

set gui_pos_x 110
set gui_pos_y 140
state CURSOR_OVER_ITEM
set mouse_over_element 0
// Launch button
	ifl gui_pos_x_temp 25
	 ifg gui_pos_x_temp -25
	    ifl gui_pos_y_temp 10
		 ifg gui_pos_y_temp -10
		  {
		  rotatesprite gui_pos_x gui_pos_y 20000 0 14712 0 21 0 0 0 xdim ydim
		  ifand BITS_PRESS 4
			{
			soundonce INTERFACE_1
			setarray RESOURCES_FOUND[mining_id] 1
			sub SUPPLY_LEVEL buying_supply
			add AMC_BUDGET buying_budget
			writearraytofile RESOURCES_FOUND F_RESOURCES_AMCTC
			sound MINE_ITEM
			savegamevar SUPPLY_LEVEL
			savegamevar AMC_BUDGET
			set mining_id 0
			set INFO_SEL 0
			}
		  }
		else
	rotatesprite gui_pos_x gui_pos_y 20000 0 14712 0 0 0 0 0 xdim ydim // GUI bit

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// EARTH SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_EARTH_SCREEN
state GLOBAL_NEWS_TICKER
screentext 2822 news_x 24 49152 0 0 news_ticker 0 0 16 0 5 8 0 0 TEXT_GAMETEXTNUMHACK 0 0 xdim ydim

	set gui_pos_x 72
	set gui_pos_y 65
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	  ifl gui_pos_y_temp 15
	   ifg gui_pos_y_temp -15
	   { // Show USA outline
	   rotatespritea 160 100 30360 0 21244 disp_pulse 1 0 -255 0 0 xdim ydim
	   ifand COM_FILTER 512 nullop else // if filter screen up
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			soundonce SATELLITE_SW
			set show_system SYS_USA
			}
	   }
	   else
		 rotatespritea 160 100 30360 0 21244 10 8 0 -255 0 0 xdim ydim
		 ifand next_mission_loc 4096 state NEW_MAP_DISPLAY

	set gui_pos_x 166
	set gui_pos_y 57
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	  ifl gui_pos_y_temp 15
	   ifg gui_pos_y_temp -15
	   { // Show Europe outline
	   rotatespritea 160 100 30360 0 21217 disp_pulse 1 0 -255 0 0 xdim ydim
	   ifand COM_FILTER 512 nullop else // if filter screen up
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			soundonce SATELLITE_SW
			set show_system SYS_EUROPE
			}
	   }
	   else
		 rotatespritea 160 100 30360 0 21217 10 8 0 -255 0 0 xdim ydim
		 ifand next_mission_loc 8192 state NEW_MAP_DISPLAY

// ################################################
// Europe/Africa Airfield
// ################################################

			set gui_pos_x 169
			set gui_pos_y 73
			ife FACILITIES_OWNED[14] 2
				set disp_temp9 14801
			else
				set disp_temp9 14778
			state CURSOR_OVER_ITEM
			set info_number 110
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
				set temp framerate
				div temp 60
				set temp2 framerate
				mod temp2 60
				ifn temp2 0
					add temp 1
				ifge cus_fadetics temp
					set cus_fadetics 1
				else
					add cus_fadetics 1
					ife cus_fadetics 1
						add cus_fade 1
				ifge cus_fade 2048 set cus_fade 0
			   	ife FACILITIES_OWNED[14] 2
					{
					ife BASE_RESEARCH[7] 2 rotatespritea gui_pos_x gui_pos_y 40960 cus_fade 22388 0 11 33 -255 0 0 xdim ydim
					else rotatespritea gui_pos_x gui_pos_y 20480 cus_fade 22388 0 11 33 -255 0 0 xdim ydim
					}
			   rotatesprite gui_pos_x gui_pos_y 20000 0 disp_temp9 0 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 disp_temp9 10 0 0 0 0 xdim ydim
				}


// ################################################
// Americas Airfield
// ################################################

			set gui_pos_x 73
			set gui_pos_y 84
			ife FACILITIES_OWNED[10] 2
				set disp_temp9 14801
			else
				set disp_temp9 14778
			state CURSOR_OVER_ITEM
			set info_number 111
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
				set temp framerate
				div temp 60
				set temp2 framerate
				mod temp2 60
				ifn temp2 0
					add temp 1
				ifge cus_fadetics temp
					set cus_fadetics 1
				else
					add cus_fadetics 1
					ife cus_fadetics 1
						add cus_fade 1
				ifge cus_fade 2048 set cus_fade 0
			   	ife FACILITIES_OWNED[10] 2
					{
					ife BASE_RESEARCH[7] 2 rotatespritea gui_pos_x gui_pos_y 40960 cus_fade 22388 0 11 33 -255 0 0 xdim ydim
					else rotatespritea gui_pos_x gui_pos_y 20480 cus_fade 22388 0 11 33 -255 0 0 xdim ydim
					}
			   rotatesprite gui_pos_x gui_pos_y 20000 0 disp_temp9 0 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 disp_temp9 10 0 0 0 0 xdim ydim
				}


	ifand COM_FILTER 1024 // Set to display EDF missions?
	ifg EDF_MISSIONS 0
	{

	ifand BEAT_EPISODES[2] 8192 // beaten jungle base?
	{
	// ################################################
	// Secret base
	// ################################################

	set gui_pos_x 204
	set gui_pos_y 112
	ifand BEAT_EPISODES[6] 512 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	 set info_number 409
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}

	// ################################################
	// West alien train + underground fortress
	// ################################################

	set gui_pos_x 95
	set gui_pos_y 106
	ifand BEAT_EPISODES[6] 1024 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 410
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}

	ifand BEAT_EPISODES[2] 1024 // unlock after beating episode two
		{
		// ################################################
		// The Beach CBP
		// ################################################

		set gui_pos_x 296
		set gui_pos_y 124
		ifand BEAT_EPISODES[6] 256 set disp_temp9 11 else set disp_temp9 18
		state CURSOR_OVER_ITEM
		set info_number 408
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
		}
	}

	ifand COM_FILTER 1 // set to display Episode 1 missions?
	{
   ifand BEAT_EPISODES[1] 4 // abyss beaten?
		{
		// ################################################
		// SNOWBASE
		// ################################################
			set gui_pos_x 92
			set gui_pos_y 53
			ifand BEAT_EPISODES[1] 32 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 4
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MIKKO disp_pulse 0 0 0 0 xdim ydim
			   state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MIKKO 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}

		// ################################################
		// REVOLUTION
		// ################################################
		set gui_pos_x 203
		set gui_pos_y 45
		ifand BEAT_EPISODES[1] 64 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		set info_number 5
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_HIGHWIRE disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_HIGHWIRE 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}
	} // End of Episode 1 missions

	ifand COM_FILTER 2 // Episode 2 missions
	{
		ifand EVIDENCE_EP2 8 // Found the EAF Repent base's location?
		{
		// ################################################
		// REPENT
		// ################################################
			set gui_pos_x 99
			set gui_pos_y 141
			ifand BEAT_EPISODES[2] 64 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 20
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
				   {
				   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
				   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
				   state CLICK_INFO_BOX
				   }
				else
					{
					ife rollover_sound info_number set rollover_sound -1
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
					ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
					}
		}

ifand BEAT_EPISODES[2] 32768
{
// ################################################
// JUNGLE BASE
// ################################################
	set gui_pos_x 201
	set gui_pos_y 118
	ifand BEAT_EPISODES[2] 8192 set disp_temp9 11 else set disp_temp9 21
	state CURSOR_OVER_ITEM
	set info_number 29
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
	   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_ZAXTOR disp_pulse 0 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_ZAXTOR 5 0 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
}


ifand BEAT_EPISODES[2] 1
{
// ################################################
// BIG TROUBLE IN CHINA
// ################################################
	set gui_pos_x 264
	set gui_pos_y 78
	ifand BEAT_EPISODES[2] 2 set disp_temp9 11 else set disp_temp9 21
	state CURSOR_OVER_ITEM
	set info_number 11
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
}

ifand EVIDENCE_EP2 2 // Found the Dojo's location?
{
// ################################################
// HIDDEN DOJO
// ################################################
	set gui_pos_x 283
	set gui_pos_y 68
	ifand BEAT_EPISODES[2] 32 set disp_temp9 11 else set disp_temp9 21
	state CURSOR_OVER_ITEM
	set info_number 15
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
}

ifand BEAT_EPISODES[2] 2 // If they've beat Big trouble in China, show the next map
	{
	// ################################################
	// FISHING WHARF
	// ################################################
		set gui_pos_x 259
		set gui_pos_y 83
		ifand BEAT_EPISODES[2] 4 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		set info_number 12
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
			ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
		   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
			else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
	}

ifand BEAT_EPISODES[2] 4 // If they've beat The Wharf, show the next map
	{
// ################################################
// ISLAND FACILITY
// ################################################
	set gui_pos_x 264
	set gui_pos_y 84
	ifand BEAT_EPISODES[2] 8 set disp_temp9 11 else set disp_temp9 21
	state CURSOR_OVER_ITEM
	set info_number 13
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
		   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
	}

ifand BEAT_EPISODES[2] 8 // If they've beat Island facility, show the next map
	{
// ################################################
// TOWER OF LIFE
// ################################################
	set gui_pos_x 240
	set gui_pos_y 74
	ifand BEAT_EPISODES[2] 16 set disp_temp9 11 else set disp_temp9 21
	state CURSOR_OVER_ITEM
	set info_number 14
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}


ifand EVIDENCE_EP2 256 // Found the Oil rig's location?
	{
// ################################################
// OIL RIG
// ################################################
		set gui_pos_x 272
		set gui_pos_y 72
		ifand BEAT_EPISODES[2] 256 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		set info_number 16
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
		   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
	}

}

ifand COM_FILTER 4 // Episode 3 missions
	{

ifand BEAT_EPISODES[3] 1 // Post X64-2?
	{
// ################################################
// LE SANG EGYPT
// ################################################
	set gui_pos_x 187
	set gui_pos_y 77
	ifand BEAT_EPISODES[3] 2 set disp_temp9 11 else set disp_temp9 21
	state CURSOR_OVER_ITEM
	set info_number 30
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}

ifand BEAT_EPISODES[3] 4 // Post Le Sang?
	{
			// ################################################
			// Micky begins
			// ################################################
				set gui_pos_x 284
				set gui_pos_y 130
				ifand BEAT_EPISODES[3] 16 set disp_temp9 11 else set disp_temp9 21
				state CURSOR_OVER_ITEM
				set info_number 49
				ifl gui_pos_x_temp 3
				 ifg gui_pos_x_temp -3
				  ifl gui_pos_y_temp 3
				   ifg gui_pos_y_temp -3
				   {
					ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
				   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
				   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MICKY disp_pulse 0 0 0 0 xdim ydim
					state CLICK_INFO_BOX
				   }
				else
					{
					ife rollover_sound info_number set rollover_sound -1
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MICKY 5 0 0 0 0 xdim ydim
					ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
					}
	}

ifand BEAT_EPISODES[3] 64 // Post Axon scene/AMC base 2?
		{
		// ################################################
		// GARMID SECTOR 14B
		// ################################################
		ifg VOLUME 1
			{
			set gui_pos_x 125
			set gui_pos_y 81
			state CURSOR_OVER_ITEM
			set info_number 41
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
			}

		ifand BEAT_EPISODES[3] 262144 // can only do this mission if player has the chaosphere
		 ife BASE_RESEARCH[1] 2 // if player has the mystical research room?
		{
		// ################################################
		// PIPEDREAM
		// ################################################
			set gui_pos_x 72
			set gui_pos_y 50
			ifand BEAT_EPISODES[7] 2 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 42
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_CULTIST disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_CULTIST 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

		// ################################################
		// Spookycut
		// ################################################
			set gui_pos_x 176
			set gui_pos_y 85
			ifand BEAT_EPISODES[3] 512 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 51
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
				 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MERLIJN disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MERLIJN 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}

			// ################################################
			// Eviction Notice
			// ################################################
				set gui_pos_x 194
				set gui_pos_y 65
				ifand BEAT_EPISODES[3] 2048 set disp_temp9 11 else set disp_temp9 21
				state CURSOR_OVER_ITEM
				set info_number 53
				ifl gui_pos_x_temp 3
				 ifg gui_pos_x_temp -3
				  ifl gui_pos_y_temp 3
				   ifg gui_pos_y_temp -3
				   {
					 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					 ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
				   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
				   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MICKY disp_pulse 0 0 0 0 xdim ydim
					state CLICK_INFO_BOX
				   }
					else
					{
					ife rollover_sound info_number set rollover_sound -1
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MICKY 5 0 0 0 0 xdim ydim
					ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
					}

				// ################################################
				// GUERILLAS IN THE MIST
				// ################################################
					set gui_pos_x 171
					set gui_pos_y 97
					ifand BEAT_EPISODES[3] 16384 set disp_temp9 11 else set disp_temp9 21
					state CURSOR_OVER_ITEM
					set info_number 57
					ifl gui_pos_x_temp 3
					 ifg gui_pos_x_temp -3
					  ifl gui_pos_y_temp 3
					   ifg gui_pos_y_temp -3
					   {
						 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
						 ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
					   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
					   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_GEOFFREY disp_pulse 0 0 0 0 xdim ydim
						state CLICK_INFO_BOX
					   }
					else
						{
						ife rollover_sound info_number set rollover_sound -1
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_GEOFFREY 5 0 0 0 0 xdim ydim
						ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
						}

			// ################################################
			// Jungle pyramid
			// ################################################
				set gui_pos_x 202
				set gui_pos_y 123
				ifand BEAT_EPISODES[3] 8192 set disp_temp9 11 else set disp_temp9 21
				state CURSOR_OVER_ITEM
				set info_number 52
				ifl gui_pos_x_temp 3
				 ifg gui_pos_x_temp -3
				  ifl gui_pos_y_temp 3
				   ifg gui_pos_y_temp -3
				   {
					 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					 ifand next_mission_loc 1 { xor next_mission_loc 1 savegamevar next_mission_loc }
				   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
				   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_ZAXTOR disp_pulse 0 0 0 0 xdim ydim
					state CLICK_INFO_BOX
				   }
					else
					{
					ife rollover_sound info_number set rollover_sound -1
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_ZAXTOR 5 0 0 0 0 xdim ydim
					ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
					}

		}

	}

	ifand COM_FILTER 32
		{

// ################################################
// Africa Factory 1
// ################################################

			set gui_pos_x 198
			set gui_pos_y 96
			ife FACILITIES_OWNED[1] 2
				{
				set disp_temp8 14784
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14813
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 102
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 20000 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Brazil Factory 1
// ################################################

			set gui_pos_x 117
			set gui_pos_y 105
			ife FACILITIES_OWNED[2] 2
				{
				set disp_temp8 14784
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14813
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 103
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 20000 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// China Storage 1
// ################################################

			set gui_pos_x 260
			set gui_pos_y 70
			ife FACILITIES_OWNED[4] 2
				{
				set disp_temp9 0
				}
			else
				{
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 105
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14817 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14817 10 disp_temp9 0 0 0 xdim ydim
				}


// ################################################
// Chinese Airfield
// ################################################

			set gui_pos_x 255
			set gui_pos_y 65
			ife FACILITIES_OWNED[12] 2
				set disp_temp9 14801
			else
				set disp_temp9 14778
			state CURSOR_OVER_ITEM
			set info_number 113
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
				set temp framerate
				div temp 60
				set temp2 framerate
				mod temp2 60
				ifn temp2 0
					add temp 1
				ifge cus_fadetics temp
					set cus_fadetics 1
				else
					add cus_fadetics 1
					ife cus_fadetics 1
						add cus_fade 1
				ifge cus_fade 2048 set cus_fade 0
			   	ife FACILITIES_OWNED[12] 2
					{
					ife BASE_RESEARCH[7] 2 rotatespritea gui_pos_x gui_pos_y 40960 cus_fade 22388 0 11 33 -255 0 0 xdim ydim
					else rotatespritea gui_pos_x gui_pos_y 20480 cus_fade 22388 0 11 33 -255 0 0 xdim ydim
					}
			   rotatesprite gui_pos_x gui_pos_y 20000 0 disp_temp9 0 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 disp_temp9 10 0 0 0 0 xdim ydim
				}
		}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// EUROPE SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_EUROPE_SCREEN
state EUROPE_NEWS_TICKER
screentext 2822 news_x 24 49152 0 0 news_ticker 0 0 16 0 5 8 0 0 TEXT_GAMETEXTNUMHACK 0 0 xdim ydim

ife month 10 // is it october? show dracula's castle
	{
	set gui_pos_x 243
	set gui_pos_y 140
	ifand BEAT_EPISODES[6] 64 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 411
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
	}
else
ifand BEAT_EPISODES[6] 64 // otherwise if the map is beaten, unlock it permenantly
	{
	set gui_pos_x 243
	set gui_pos_y 140
	ifand BEAT_EPISODES[6] 64 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 411
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
	}

ife month 12 // is it december? show driving home for christmas
	{
	set gui_pos_x 170
	set gui_pos_y 73
	ifand BEAT_EPISODES[6] 32 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 405
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}
else
ifand BEAT_EPISODES[6] 32 // otherwise if the map is beaten, unlock it permenantly
	{
	set gui_pos_x 170
	set gui_pos_y 73
	ifand BEAT_EPISODES[6] 32 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 405
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}

ifand COM_FILTER 2 // Episode 2 missions
	{
	ifand BEAT_EPISODES[2] 32768
		{
		// ################################################
		// GHOST SHIP
		// ################################################
			set gui_pos_x 48
			set gui_pos_y 170
			ifand BEAT_EPISODES[2] 128 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 21
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
				ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				ifand next_mission_loc 8192 { xor next_mission_loc 8192 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MICKY disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MICKY 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}


		// ################################################
		// FAR MOUNTAiN ReACHES
		// ################################################
			set gui_pos_x 115
			set gui_pos_y 145
			ifand BEAT_EPISODES[2] 2048 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 25
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				ifand next_mission_loc 8192 { xor next_mission_loc 8192 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_JAMES disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_JAMES 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}
}

ifand COM_FILTER 1024 // Set to display EDF missions?
ifg EDF_MISSIONS 0
{
	ifand BEAT_EPISODES[1] 128 // unlock after beating episode one
		{
		// ################################################
		// Alone in the dark with the Undead
		// ################################################

		set gui_pos_x 60
		set gui_pos_y 80
		ifand BEAT_EPISODES[6] 1073741824 set disp_temp9 11 else set disp_temp9 18
		state CURSOR_OVER_ITEM
		set info_number 430
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
			else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
		}

	// ################################################
	// Another Big base attacked
	// ################################################

	set gui_pos_x 98
	set gui_pos_y 98
	ifand BEAT_EPISODES[6] 16 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 404
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
	   state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}

	// ################################################
	// The Lost Highway
	// ################################################
	set gui_pos_x 196
	set gui_pos_y 105
	ifand BEAT_EPISODES[6] 131072 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 417
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
}

ifand COM_FILTER 32
	{
// ################################################
// Europe Factory 1
// ################################################
			set gui_pos_x 208
			set gui_pos_y 113
			ife FACILITIES_OWNED[0] 2
				{
				set disp_temp8 14784
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14813
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 101
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 20000 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}
	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// USA SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_USA_SCREEN
state USA_NEWS_TICKER
screentext 2822 news_x 24 49152 0 0 news_ticker 0 0 16 0 5 8 0 0 TEXT_GAMETEXTNUMHACK 0 0 xdim ydim

ife month 12 // is it december? show driving home for christmas
	{
	set gui_pos_x 170
	set gui_pos_y 73
	ifand BEAT_EPISODES[6] 64 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 406
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14789 0 disp_temp9 0 0 0 xdim ydim
	   state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14788 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}
else // unlock it permenantly if beaten
ifand BEAT_EPISODES[6] 64
	{
	set gui_pos_x 170
	set gui_pos_y 73
	ifand BEAT_EPISODES[6] 64 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 406
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14789 0 disp_temp9 0 0 0 xdim ydim
	   state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14788 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}

ifand COM_FILTER 1024 // Set to display EDF missions?
	ifg EDF_MISSIONS 0
	{
	// ################################################
	// Wet Dream
	// ################################################

	set gui_pos_x 237
	set gui_pos_y 161
	ifand BEAT_EPISODES[6] 2 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 401
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}

	// ################################################
	// The Fantasy hotel
	// ################################################

	set gui_pos_x 17
	set gui_pos_y 150
	ifand BEAT_EPISODES[6] 128 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 407
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}

ifand BEAT_EPISODES[1] 128 // unlock after beating episode one
	{
	// ################################################
	// EDF Bureau
	// ################################################

	set gui_pos_x 107
	set gui_pos_y 95
	ifand BEAT_EPISODES[6] 4096 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 412
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}

ifand BEAT_EPISODES[2] 1024 // unlock after beating episode two
	{
	// ################################################
	// Red Saga
	// ################################################

	set gui_pos_x 21
	set gui_pos_y 118
	ifand BEAT_EPISODES[6] 1 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 400
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}

	// ################################################
	// Clear the Coast
	// ################################################

	set gui_pos_x 1
	set gui_pos_y 114
	ifand BEAT_EPISODES[6] 8 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 403
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}

		// ################################################
		// Daikarin
		// ################################################

		set gui_pos_x 39
		set gui_pos_y 100
		ifand BEAT_EPISODES[6] 32768 set disp_temp9 11 else set disp_temp9 18
		state CURSOR_OVER_ITEM
		set info_number 415
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}

	}

ifand BEAT_EPISODES[3] 65536 // beat episode 3?
	{
	// ################################################
	// The Final confrontation
	// ################################################

	set gui_pos_x 38
	set gui_pos_y 159
	ifand BEAT_EPISODES[6] 65536 set disp_temp9 11 else set disp_temp9 18
	state CURSOR_OVER_ITEM
	set info_number 416
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}

	} // End of EDF missions



ifand COM_FILTER 1 // set to display Episode 1 missions?
	{
// ################################################
// MEGABASE
// ################################################
	set gui_pos_x 30
	set gui_pos_y 125
	ifand BEAT_EPISODES[1] 1 set disp_temp9 11 else set disp_temp9 21
	state CURSOR_OVER_ITEM
	set info_number 2
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
	   {
	   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
	   ifand next_mission_loc 4096 { xor next_mission_loc 4096 savegamevar next_mission_loc }
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}

   ifand BEAT_EPISODES[1] 4 // abyss beaten?
	{
	// ################################################
	// MILLHAVEN
	// ################################################

		set gui_pos_x 138
		set gui_pos_y 152
		ifand BEAT_EPISODES[1] 16 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		set info_number 3
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
			ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			ifand next_mission_loc 4096 { xor next_mission_loc 4096 savegamevar next_mission_loc }
		   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
		   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_RUSTY disp_pulse 0 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_RUSTY 5 0 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	}

		ifand BEAT_EPISODES[1] 16 // beat snowbase and Millhaven?
		ifand BEAT_EPISODES[1] 32
		{
			// ################################################
			// PROVIDENCE
			// ################################################
				set gui_pos_x 288
				set gui_pos_y 53
				ifand BEAT_EPISODES[1] 128 set disp_temp9 11 else set disp_temp9 21
				state CURSOR_OVER_ITEM
				set info_number 6
				ifl gui_pos_x_temp 3
				 ifg gui_pos_x_temp -3
				  ifl gui_pos_y_temp 3
				   ifg gui_pos_y_temp -3
					   {
					   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					   ifand next_mission_loc 4096 { xor next_mission_loc 4096 savegamevar next_mission_loc }
					   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
					   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_JAMES disp_pulse 0 0 0 0 xdim ydim
						state CLICK_INFO_BOX
					   }
					else
						{
						ife rollover_sound info_number set rollover_sound -1
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_JAMES 5 0 0 0 0 xdim ydim
						ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
						}
		}
	} // End of Episode 1 missions

	ifand COM_FILTER 2 // Episode 2 missions
	{
// ################################################
// CITY UNDER SIEGE
// ################################################
	set gui_pos_x 12
	set gui_pos_y 123
	ifand BEAT_EPISODES[2] 1 set disp_temp9 11 else set disp_temp9 21
	set info_number 10
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 3
	 ifg gui_pos_x_temp -3
	  ifl gui_pos_y_temp 3
	   ifg gui_pos_y_temp -3
		   {
			ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			ifand next_mission_loc 4096 { xor next_mission_loc 4096 savegamevar next_mission_loc }
		   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
		ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
		}
	} // End of Episode 2 missions

	ifand COM_FILTER 4 // Episode 3 missions
	{
		ifand BEAT_EPISODES[3] 64
		{
			// ################################################
			// CHAOSPHERE
			// ################################################
				set gui_pos_x 229
				set gui_pos_y 101
				ifand BEAT_EPISODES[3] 262144 set disp_temp9 11 else set disp_temp9 21
				state CURSOR_OVER_ITEM
				set info_number 59
				ifl gui_pos_x_temp 3
				 ifg gui_pos_x_temp -3
				  ifl gui_pos_y_temp 3
				   ifg gui_pos_y_temp -3
				   {
					 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					  ifand next_mission_loc 4096 { xor next_mission_loc 4096 savegamevar next_mission_loc }
				   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
					state CLICK_INFO_BOX
				   }
					else
					{
					ife rollover_sound info_number set rollover_sound -1
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
					ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
					}
			ifand BEAT_EPISODES[3] 262144 // can only do this mission if player has the chaosphere
			 ife BASE_RESEARCH[1] 2 // if player has the mystical research room?
				{
				// ################################################
				// SHELLSHOCKED
				// ################################################
					set gui_pos_x 42
					set gui_pos_y 81
					ifand BEAT_EPISODES[7] 4 set disp_temp9 11 else set disp_temp9 21
					state CURSOR_OVER_ITEM
					set info_number 80
					ifl gui_pos_x_temp 5
					 ifg gui_pos_x_temp -5
					  ifl gui_pos_y_temp 5
					   ifg gui_pos_y_temp -5
						   {
							 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
							 ifand next_mission_loc 4096 { xor next_mission_loc 4096 savegamevar next_mission_loc }
						   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
						   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_BOMBSHELL disp_pulse 0 0 0 0 xdim ydim
							state CLICK_INFO_BOX
						   }
						else
							{
							ife rollover_sound info_number set rollover_sound -1
							rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
							rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_BOMBSHELL 5 0 0 0 0 xdim ydim
							ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
							}
				 }
		}

	} // End of Episode 3 missions

// ################################################
// AMC Vehicle test site
// ################################################

			set gui_pos_x 76
			set gui_pos_y 96
			ife FACILITIES_OWNED[11] 2
				set disp_temp9 14776
			else
				set disp_temp9 14778
			state CURSOR_OVER_ITEM
			set info_number 112
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 20000 0 disp_temp9 0 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 disp_temp9 5 0 0 0 0 xdim ydim
				}
ends


// =========================================================================================================================================
// *****************************************************************************************************************************************
// SOLAR SYSTEM SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_SOL_SCREEN

	set gui_pos_x 61
	set gui_pos_y 117
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 8
	 ifg gui_pos_x_temp -8
	  ifl gui_pos_y_temp 8
	   ifg gui_pos_y_temp -8
	   { // Show Earth
	   ifge VOLUME 4 rotatesprite gui_pos_x gui_pos_y 7800 0 8448 disp_pulse 21 0 0 0 xdim ydim
	   else rotatesprite gui_pos_x gui_pos_y 7800 0 8448 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4090 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_EARTH
			}
	   }
		else
		{
		ifge VOLUME 4 rotatesprite gui_pos_x gui_pos_y 7400 0 8448 10 21 8 0 0 xdim ydim
		else rotatesprite gui_pos_x gui_pos_y 7400 0 8448 10 0 8 0 0 xdim ydim
		}
	  ifand next_mission_loc 1 state NEW_MAP_DISPLAY
	  else ifand next_mission_loc 4096 state NEW_MAP_DISPLAY
	  else ifand next_mission_loc 8192 state NEW_MAP_DISPLAY

	set gui_pos_x 71
	set gui_pos_y 107
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show Moon
	   rotatesprite gui_pos_x gui_pos_y 2448 0 8449 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4093 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_MOON
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y 2048 0 8449 10 0 0 0 0 xdim ydim
	ifand next_mission_loc 4 state NEW_MAP_DISPLAY

   ifand COM_FILTER 1024 // Set to display EDF missions?
	ifg EDF_MISSIONS 0
	{

	ifand BEAT_EPISODES[3] 64
			{
			// ################################################
			// Metropolitan Starlight
			// ################################################

			set gui_pos_x 74
			set gui_pos_y 100
			ifand BEAT_EPISODES[8] 64 set disp_temp9 11 else set disp_temp9 18
			state CURSOR_OVER_ITEM
			set info_number 438
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
			}

	}

	ifand COM_FILTER 4
	ifand BEAT_EPISODES[3] 262144 // can only do this mission if player has the chaosphere
		ife BASE_RESEARCH[1] 2 // if player has the mystical research room?
				{
				// ################################################
				// CALIGULA STATION
				// ################################################
					set gui_pos_x 164
					set gui_pos_y 91
					ifand BEAT_EPISODES[7] 8 set disp_temp9 11 else set disp_temp9 21
					state CURSOR_OVER_ITEM
					set info_number 81
					ifl gui_pos_x_temp 5
					 ifg gui_pos_x_temp -5
					  ifl gui_pos_y_temp 5
					   ifg gui_pos_y_temp -5
					   {
					   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					   ifand next_mission_loc 2 { xor next_mission_loc 2 savegamevar next_mission_loc }
					   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
					   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_JANE disp_pulse 0 0 0 0 xdim ydim
						state CLICK_INFO_BOX
					   }
					else
						{
						ife rollover_sound info_number set rollover_sound -1
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_JANE 5 0 0 0 0 xdim ydim
						ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
						}
				 }


		set gui_pos_x 116
		set gui_pos_y 95
		state CURSOR_OVER_ITEM
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   { // Show Ganymede
	   rotatesprite gui_pos_x gui_pos_y 2448 0 8451 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4094 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_GANYMEDE
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y 2048 0 8451 10 0 0 0 0 xdim ydim
	ifand next_mission_loc 8 state NEW_MAP_DISPLAY
	else ifand next_mission_loc 65536 state NEW_MAP_DISPLAY

		set gui_pos_x 109
		set gui_pos_y 102
		state CURSOR_OVER_ITEM
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   { // Show Io
	   rotatesprite gui_pos_x gui_pos_y 2448 0 8466 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4095 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_IO
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y 2048 0 8466 10 0 0 0 0 xdim ydim
	ifand next_mission_loc 16 state NEW_MAP_DISPLAY


		set gui_pos_x 35
		set gui_pos_y 117
		ifand BEAT_EPISODES[1] 2 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		ifl gui_pos_x_temp 8
		 ifg gui_pos_x_temp -8
		  ifl gui_pos_y_temp 8
		   ifg gui_pos_y_temp -8
		   { // Show Venus
	   rotatesprite 35 117 7400 0 8457 disp_pulse 0 8 0 0 xdim ydim // venus
	   set mouse_hint 4112 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_VENUS
			}
	   }
		else
	rotatesprite 35 117 7400 0 8457 5 0 8 0 0 xdim ydim // venus

		set gui_pos_x 92
		set gui_pos_y 116
		ifand BEAT_EPISODES[1] 2 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   { // Show Mars
	   rotatesprite gui_pos_x gui_pos_y 5496 0 8450 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4092 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_MARS
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y 4996 0 8450 5 0 0 0 0 xdim ydim
	ifand next_mission_loc 32 state NEW_MAP_DISPLAY

		set gui_pos_x 245
		set gui_pos_y 95
		state CURSOR_OVER_ITEM
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   { // Show Umbriel
	   rotatesprite gui_pos_x gui_pos_y 2392 0 20224 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4105 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 13
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_UMBRIEL
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y 1792 0 20224 10 0 0 0 0 xdim ydim
	ifand next_mission_loc 2048 state NEW_MAP_DISPLAY

	ifg FACILITIES_OWNED[6] 1 // Jupiter Satellite
	{
	ifand FOUND_ADS 8
		{
			set gui_pos_x 105
			set gui_pos_y 126
			state CURSOR_OVER_ITEM
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   { // Show Ceres
		   rotatesprite gui_pos_x gui_pos_y 2392 0 33765 disp_pulse 0 0 0 0 xdim ydim
		   set mouse_hint 4108 // refers to quote in user.con
		   sub mouse_hint_timer 2
		   ifand BITS_PRESS 4
				{
				set DISP_STUFF 13
				stopsound COMMAND_AMB2
				soundonce SATELLITE_SW
				set show_system SYS_CERES
				}
		   }
			else
		rotatesprite gui_pos_x gui_pos_y 1792 0 33765 10 0 0 0 0 xdim ydim
		}

		ifand FOUND_ADS 16
		{
			set gui_pos_x 288
			set gui_pos_y 121
			state CURSOR_OVER_ITEM
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   { // Show Haumea
		   rotatesprite gui_pos_x gui_pos_y 2392 0 33766 disp_pulse 0 0 0 0 xdim ydim
		   set mouse_hint 4109 // refers to quote in user.con
		   sub mouse_hint_timer 2
		   ifand BITS_PRESS 4
				{
				set DISP_STUFF 13
				stopsound COMMAND_AMB2
				soundonce SATELLITE_SW
				set show_system SYS_HAUMEA
				}
		   }
			else
		rotatesprite gui_pos_x gui_pos_y 1792 0 33766 10 0 0 0 0 xdim ydim
		}

		ifand FOUND_ADS 32
		{
			set gui_pos_x 291
			set gui_pos_y 84
			state CURSOR_OVER_ITEM
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   { // Show Makemake
		   rotatesprite gui_pos_x gui_pos_y 2392 0 33767 disp_pulse 0 0 0 0 xdim ydim
		   set mouse_hint 4110 // refers to quote in user.con
		   sub mouse_hint_timer 2
		   ifand BITS_PRESS 4
				{
				set DISP_STUFF 13
				stopsound COMMAND_AMB2
				soundonce SATELLITE_SW
				set show_system SYS_MAKEMAKE
				}
		   }
			else
		rotatesprite gui_pos_x gui_pos_y 1792 0 33767 10 0 0 0 0 xdim ydim
		}

		ifand FOUND_ADS 64
		{
			set gui_pos_x 299
			set gui_pos_y 126
			state CURSOR_OVER_ITEM
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   { // Show Eris
		   rotatesprite gui_pos_x gui_pos_y 2392 0 33768 disp_pulse 0 0 0 0 xdim ydim
		   set mouse_hint 4111 // refers to quote in user.con
		   sub mouse_hint_timer 2
		   ifand BITS_PRESS 4
				{
				set DISP_STUFF 13
				stopsound COMMAND_AMB2
				soundonce SATELLITE_SW
				set show_system SYS_ERIS
				}
		   }
			else
		rotatesprite gui_pos_x gui_pos_y 1792 0 33768 10 0 0 0 0 xdim ydim
		}

	}

ifand COM_FILTER 2 // Episode 2 missions
	{
	// ################################################
	// MARS STATION
	// ################################################
	ifand BEAT_EPISODES[2] 16384
			{
				set gui_pos_x 83
				set gui_pos_y 104
				ifand BEAT_EPISODES[2] 1024 set disp_temp9 11 else set disp_temp9 21
				state CURSOR_OVER_ITEM
				set info_number 26
				ifl gui_pos_x_temp 3
				 ifg gui_pos_x_temp -3
				  ifl gui_pos_y_temp 3
				   ifg gui_pos_y_temp -3
				   {
				   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				   ifand next_mission_loc 2 { xor next_mission_loc 2 savegamevar next_mission_loc }
				   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
				   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_JAMES disp_pulse 0 0 0 0 xdim ydim
					state CLICK_INFO_BOX
				   }
				else
					{
					ife rollover_sound info_number set rollover_sound -1
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
					rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_JAMES 5 0 0 0 0 xdim ydim
					ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
					}
			}
	}

ifand COM_FILTER 4
	{
// ################################################
// X64-2M
// ################################################

			set gui_pos_x 35
			set gui_pos_y 78
			ifand BEAT_EPISODES[3] 1 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 31
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   ifand next_mission_loc 2 { xor next_mission_loc 2 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}

// ################################################
// POSEIDON INDUSTRIES
// ################################################

		ifand BEAT_EPISODES[3] 131072 // Triton Poseidon industries
			{
					set gui_pos_x 269
					set gui_pos_y 95
					ifand BEAT_EPISODES[3] 65536 set disp_temp9 11 else set disp_temp9 21
					state CURSOR_OVER_ITEM
					set info_number 58
					ifl gui_pos_x_temp 3
					 ifg gui_pos_x_temp -3
					  ifl gui_pos_y_temp 3
					   ifg gui_pos_y_temp -3
					   {
					   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					   ifand next_mission_loc 2 { xor next_mission_loc 2 savegamevar next_mission_loc }
					   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
					   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_SNOWFALL disp_pulse 0 0 0 0 xdim ydim
					   state CLICK_INFO_BOX
					   }
					else
						{
						ife rollover_sound info_number set rollover_sound -1
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_SNOWFALL 5 0 0 0 0 xdim ydim
						ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
						}
			}

			ifand EVIDENCE_EP3 4 // found Charon mission co-ords?
			{
					set gui_pos_x 300
					set gui_pos_y 100
					ifand BEAT_EPISODES[3] 524288 set disp_temp9 11 else set disp_temp9 21
					state CURSOR_OVER_ITEM
					set info_number 60
					ifl gui_pos_x_temp 3
					 ifg gui_pos_x_temp -3
					  ifl gui_pos_y_temp 3
					   ifg gui_pos_y_temp -3
					   {
					   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
					   ifand next_mission_loc 2 { xor next_mission_loc 2 savegamevar next_mission_loc }
					   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
						state CLICK_INFO_BOX
					   }
					else
						{
						ife rollover_sound info_number set rollover_sound -1
						rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
						ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
						}
			}

	}

			set gui_pos_x 68
			set gui_pos_y 94
			ife FACILITIES_OWNED[5] 2 set disp_temp9 0 else set disp_temp9 17
			state CURSOR_OVER_ITEM
			set info_number 106
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14800 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14800 10 disp_temp9 0 0 0 xdim ydim
				}

			set gui_pos_x 128
			set gui_pos_y 82
			ife FACILITIES_OWNED[6] 2 set disp_temp9 0 else set disp_temp9 17
			state CURSOR_OVER_ITEM
			set info_number 107
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14800 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14800 10 disp_temp9 0 0 0 xdim ydim
				}


ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// 33 BOO SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_BO33_SCREEN

ifand COM_FILTER 2 // Episode 2 missions
{
// ################################################
// ENERGEIA MAP
// ################################################
ifand BEAT_EPISODES[2] 2048
 ifand BEAT_EPISODES[2] 128
		{
			set gui_pos_x 88
			set gui_pos_y 115
			ifand BEAT_EPISODES[2] 131072 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 17
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   ifand next_mission_loc 1024 { xor next_mission_loc 1024 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MIKKO disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MIKKO 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}
}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// ISHTEG SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_ISHTEG_SCREEN

	set gui_pos_x 71
	set gui_pos_y 117
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 6
	 ifg gui_pos_x_temp -6
	  ifl gui_pos_y_temp 6
	   ifg gui_pos_y_temp -6
	   { // Show Xuglop
	   rotatesprite gui_pos_x gui_pos_y 8200 0 8452 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4100 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 16
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_XUGLOP
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y 7800 0 8452 10 0 0 0 0 xdim ydim
	ifand next_mission_loc 256 state NEW_MAP_DISPLAY


		set gui_pos_x 92
		set gui_pos_y 116
		state CURSOR_OVER_ITEM
		ifl gui_pos_x_temp 6
		 ifg gui_pos_x_temp -6
		  ifl gui_pos_y_temp 6
		   ifg gui_pos_y_temp -6
		   { // Show Ractonia
	   rotatesprite gui_pos_x gui_pos_y 8200 0 8453 disp_pulse 0 0 0 0 xdim ydim
	   set mouse_hint 4101 // refers to quote in user.con
	   sub mouse_hint_timer 2
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 16
			stopsound COMMAND_AMB2
			soundonce SATELLITE_SW
			set show_system SYS_RACTONIA
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y 7400 0 8453 5 0 0 0 0 xdim ydim
	ifand next_mission_loc 512 state NEW_MAP_DISPLAY


ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// MOON SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_MOON_SCREEN

ifand BEAT_EPISODES[2] 1 // beaten city under siege?
{
// ################################################
// NEW LA
// ################################################
	set gui_pos_x 174
	set gui_pos_y 73
	state CURSOR_OVER_ITEM
	set info_number 40
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   {
	   rotatesprite gui_pos_x gui_pos_y 36768 0 14777 0 0 0 0 0 xdim ydim
	   ifand next_mission_loc 4 { xor next_mission_loc 4 savegamevar next_mission_loc }
		state CLICK_INFO_BOX
	   }
	else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 14776 5 0 0 0 0 xdim ydim
		}
}


ifand COM_FILTER 32
	{

// ################################################
// Lunar Factory 1
// ################################################

			set gui_pos_x 117
			set gui_pos_y 105
			ife FACILITIES_OWNED[3] 2
				{
				set disp_temp8 14784
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14813
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 104
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}
	}

// ################################################
// Lunar Resources 1
// ################################################

ifand COM_FILTER 256
	{

		ifg FACILITIES_OWNED[3] 1 // Starting facility on the Moon
		 ifg FACILITIES_OWNED[5] 1 // Earth Satellite
			{

			set gui_pos_x 147
			set gui_pos_y 135
			ife RESOURCES_FOUND[0] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 200
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Lunar Resources 2
// ################################################

			set gui_pos_x 117
			set gui_pos_y 45
			ife RESOURCES_FOUND[1] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 201
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Lunar Resources 3
// ################################################

			set gui_pos_x 37
			set gui_pos_y 75
			ife RESOURCES_FOUND[2] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 202
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Lunar Resources 4
// ################################################

			set gui_pos_x 237
			set gui_pos_y 35
			ife RESOURCES_FOUND[3] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 203
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Lunar Resources 5
// ################################################

			set gui_pos_x 267
			set gui_pos_y 105
			ife RESOURCES_FOUND[4] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 204
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

			}

	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// GANYMEDE SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_GANYMEDE_SCREEN

ifand COM_FILTER 1
	{

 ifand BEAT_EPISODES[1] 1
	  {
	// ################################################
	// DIS BASE
	// ################################################
		set gui_pos_x 184
		set gui_pos_y 99
		ifand BEAT_EPISODES[1] 2 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		set info_number 7
		ifl gui_pos_x_temp 5
		 ifg gui_pos_x_temp -5
		  ifl gui_pos_y_temp 5
		   ifg gui_pos_y_temp -5
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   ifand next_mission_loc 8 { xor next_mission_loc 8 savegamevar next_mission_loc }
		   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
		}

} // End of Episode 1 missions

ifand BEAT_EPISODES[1] 2
	{
	set gui_pos_x 196
	set gui_pos_y 98
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show Abyss
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 23 0 0 0 xdim ydim
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 26
			stopsound COMMAND_AMB4
			soundonce SATELLITE_SW
			set show_system SYS_ABYSS
			}
	   }
		else
		{
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 10 23 0 0 0 xdim ydim
		ifand next_mission_loc 65536 state NEW_MAP_DISPLAY
		}

	}

ifand COM_FILTER 32
{

	// ################################################
	// Ganymede Factory 1
	// ################################################

				set gui_pos_x 52
				set gui_pos_y 164
				ife FACILITIES_OWNED[8] 2
					{
					set disp_temp8 14784
					set disp_temp9 0
					}
				else
					{
					set disp_temp8 14813
					set disp_temp9 17
					}
				state CURSOR_OVER_ITEM
				set info_number 109
				ifl gui_pos_x_temp 3
				 ifg gui_pos_x_temp -3
				  ifl gui_pos_y_temp 3
				   ifg gui_pos_y_temp -3
				   {
				   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
					state CLICK_INFO_BOX
				   }
				else
					{
					ife rollover_sound info_number set rollover_sound -1
					rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
					}


// ################################################
// Ganymede Resources 1
// ################################################
		ifg FACILITIES_OWNED[8] 1 // facility on Ganymede
		 ifg FACILITIES_OWNED[6] 1 // Jupiter Satellite
			{

			set gui_pos_x 60
			set gui_pos_y 68
			ife RESOURCES_FOUND[15] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 215
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
			   state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Ganymede Resources 2
// ################################################
			set gui_pos_x 244
			set gui_pos_y 158
			ife RESOURCES_FOUND[16] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 216
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Ganymede Resources 3
// ################################################
			set gui_pos_x 174
			set gui_pos_y 45
			ife RESOURCES_FOUND[17] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 217
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
			   state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Ganymede Resources 4
// ################################################
			set gui_pos_x 116
			set gui_pos_y 96
			ife RESOURCES_FOUND[18] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 218
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Ganymede Resources 5
// ################################################
			set gui_pos_x 217
			set gui_pos_y 24
			ife RESOURCES_FOUND[19] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 219
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

	}

}


ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// VENUS SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_VENUS_SCREEN


ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// IO SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_IO_SCREEN

ifand COM_FILTER 32
	{

// ################################################
// Io Factory 1
// ################################################

			set gui_pos_x 167
			set gui_pos_y 45
			ife FACILITIES_OWNED[7] 2
				{
				set disp_temp8 14784
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14813
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 108
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}
	}

ifand COM_FILTER 256
	{

// ################################################
// Io Resources 1
// ################################################
		ifg FACILITIES_OWNED[7] 1 // Starting facility on Io
		 ifg FACILITIES_OWNED[6] 1 // Jupiter Satellite
			{

			set gui_pos_x 147
			set gui_pos_y 135
			ife RESOURCES_FOUND[10] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 210
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Io Resources 2
// ################################################
			set gui_pos_x 31
			set gui_pos_y 75
			ife RESOURCES_FOUND[11] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 211
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Io Resources 3
// ################################################
			set gui_pos_x 74
			set gui_pos_y 125
			ife RESOURCES_FOUND[12] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 212
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Io Resources 4
// ################################################
			set gui_pos_x 136
			set gui_pos_y 66
			ife RESOURCES_FOUND[13] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 213
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Io Resources 5
// ################################################
			set gui_pos_x 217
			set gui_pos_y 175
			ife RESOURCES_FOUND[14] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 214
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
			   ifvarvarn rollover_sound info_number { sound COMM_MOVER set rollover_sound info_number }
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

			}

	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// UMBRIEL SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_UMBRIEL_SCREEN

ifand COM_FILTER 4
	{
	ifand BEAT_EPISODES[3] 64
		{
		// ################################################
		// NEUTRINO
		// ################################################
			set gui_pos_x 184
			set gui_pos_y 99
			ifand BEAT_EPISODES[3] 256 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 50
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
				 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   ifand next_mission_loc 2048 { xor next_mission_loc 2048 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_SNOWFALL disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_SNOWFALL 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}
	}

ifand COM_FILTER 32
	{

// ################################################
// Umbriel Factory
// ################################################

			set gui_pos_x 127
			set gui_pos_y 65
			ife FACILITIES_OWNED[13] 2
				{
				set disp_temp8 14784
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14813
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 114
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}
	}

ifand COM_FILTER 256
	{

// ################################################
// Umbriel Resources 1
// ################################################
		ifg FACILITIES_OWNED[13] 1
		 ifg FACILITIES_OWNED[6] 1 // Jupiter Satellite
			{

			set gui_pos_x 157
			set gui_pos_y 115
			ife RESOURCES_FOUND[21] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 220
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Umbriel Resources 2
// ################################################
			set gui_pos_x 21
			set gui_pos_y 85
			ife RESOURCES_FOUND[22] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 221
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Umbriel Resources 3
// ################################################
			set gui_pos_x 64
			set gui_pos_y 135
			ife RESOURCES_FOUND[23] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 222
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Umbriel Resources 4
// ################################################
			set gui_pos_x 146
			set gui_pos_y 56
			ife RESOURCES_FOUND[24] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 223
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
// Umbriel Resources 5
// ################################################
			set gui_pos_x 227
			set gui_pos_y 165
			ife RESOURCES_FOUND[25] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 224
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}
			}

	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// CERES SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_CERES_SURFACE_SCREEN

// ################################################
//  Ceres Resources 1
// ################################################

ifand COM_FILTER 256
	{

			set gui_pos_x 147
			set gui_pos_y 135
			ife RESOURCES_FOUND[26] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 225
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Ceres Resources 2
// ################################################

			set gui_pos_x 117
			set gui_pos_y 45
			ife RESOURCES_FOUND[27] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 226
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Ceres Resources 3
// ################################################

			set gui_pos_x 37
			set gui_pos_y 75
			ife RESOURCES_FOUND[28] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 227
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Ceres Resources 4
// ################################################

			set gui_pos_x 237
			set gui_pos_y 35
			ife RESOURCES_FOUND[29] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 228
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Ceres Resources 5
// ################################################

			set gui_pos_x 267
			set gui_pos_y 105
			ife RESOURCES_FOUND[30] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 229
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// HAUMEA SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_HAUMEA_SURFACE_SCREEN

// ################################################
//  Haumea Resources 1
// ################################################

ifand COM_FILTER 256
	{

			set gui_pos_x 150
			set gui_pos_y 93
			ife RESOURCES_FOUND[31] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 230
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Haumea Resources 2
// ################################################

			set gui_pos_x 16
			set gui_pos_y 31
			ife RESOURCES_FOUND[32] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 231
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Haumea Resources 3
// ################################################

			set gui_pos_x 139
			set gui_pos_y 158
			ife RESOURCES_FOUND[33] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 232
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Haumea Resources 4
// ################################################

			set gui_pos_x 257
			set gui_pos_y 167
			ife RESOURCES_FOUND[34] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 233
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Haumea Resources 5
// ################################################

			set gui_pos_x 315
			set gui_pos_y 81
			ife RESOURCES_FOUND[35] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 234
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// MAKEMAKE SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_MAKEMAKE_SURFACE_SCREEN

// ################################################
//  Makemake Resources 1
// ################################################

ifand COM_FILTER 256
	{
			set gui_pos_x 125
			set gui_pos_y 84
			ife RESOURCES_FOUND[36] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 235
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Makemake Resources 2
// ################################################

			set gui_pos_x 228
			set gui_pos_y 40
			ife RESOURCES_FOUND[37] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 236
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Makemake Resources 3
// ################################################

			set gui_pos_x 170
			set gui_pos_y 128
			ife RESOURCES_FOUND[38] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 237
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Makemake Resources 4
// ################################################

			set gui_pos_x 32
			set gui_pos_y 155
			ife RESOURCES_FOUND[39] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 238
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Makemake Resources 5
// ################################################

			set gui_pos_x 281
			set gui_pos_y 162
			ife RESOURCES_FOUND[40] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 239
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// ERIS SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_ERIS_SURFACE_SCREEN

// ################################################
//  Eris Resources 1
// ################################################

ifand COM_FILTER 256
	{

			set gui_pos_x 159
			set gui_pos_y 112
			ife RESOURCES_FOUND[41] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 240
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Eris Resources 2
// ################################################

			set gui_pos_x 246
			set gui_pos_y 84
			ife RESOURCES_FOUND[42] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 241
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Eris Resources 3
// ################################################

			set gui_pos_x 152
			set gui_pos_y 127
			ife RESOURCES_FOUND[43] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 242
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Eris Resources 4
// ################################################

			set gui_pos_x 58
			set gui_pos_y 80
			ife RESOURCES_FOUND[44] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 243
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

// ################################################
//  Eris Resources 5
// ################################################

			set gui_pos_x 173
			set gui_pos_y 96
			ife RESOURCES_FOUND[45] 0
				{
				set disp_temp8 14782
				set disp_temp9 0
				}
			else
				{
				set disp_temp8 14783
				set disp_temp9 17
				}
			state CURSOR_OVER_ITEM
			set info_number 244
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   rotatesprite gui_pos_x gui_pos_y 36768 0 disp_temp8 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 disp_temp8 10 disp_temp9 0 0 0 xdim ydim
				}

	}

ends


// =========================================================================================================================================
// *****************************************************************************************************************************************
// MARS SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_MARS_SCREEN

ifand COM_FILTER 2
	{
	ifand BEAT_EPISODES[2] 1 // beat City Under Siege?
		{
		// ################################################
		// ZETA BASE
		// ################################################
			set gui_pos_x 109
			set gui_pos_y 117
			ifand BEAT_EPISODES[7] 1 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 90
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			    ifand next_mission_loc 32 { xor next_mission_loc 32 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand BEAT_EPISODES[2] 131072 // beat Energeia?
		 {
		// ################################################
		// MARS ARSIA MONS COLONY
		// ################################################
			set gui_pos_x 46
			set gui_pos_y 116
			ifand BEAT_EPISODES[2] 16384 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 27
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   ifand next_mission_loc 32 { xor next_mission_loc 32 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	}


ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// XUGLOP SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_XUGLOP_SCREEN

ifand COM_FILTER 2
 ifand BEAT_EPISODES[2] 32768 // beaten shadow realm?
	{
	// ################################################
	// XUGLOP TRAIN
	// ################################################
		set gui_pos_x 227
		set gui_pos_y 73
		ifand BEAT_EPISODES[2] 512 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		set info_number 24
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
			ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			ifand next_mission_loc 256 { xor next_mission_loc 256 savegamevar next_mission_loc }
		    rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
	}

ifand COM_FILTER 4
	{
	ifand BEAT_EPISODES[3] 64
		{
		// ################################################
		// XUGLOP COMBINED ASSAULT
		// ################################################
			set gui_pos_x 195
			set gui_pos_y 87
			ifand BEAT_EPISODES[3] 4096 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 55
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
				 ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				ifand next_mission_loc 256 { xor next_mission_loc 256 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_JAMES disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_JAMES 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}
	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// RACTONIA SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_RACTONIA_SCREEN


ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// ABYSS SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate SHOW_ABYSS_SCREEN

ifand COM_FILTER 1 // Episode one
	{
 ifand BEAT_EPISODES[1] 2
	  {
	// ################################################
	// ABYSS
	// ################################################
		set gui_pos_x 160
		set gui_pos_y 100
		ifand BEAT_EPISODES[1] 4 set disp_temp9 11 else set disp_temp9 21
		state CURSOR_OVER_ITEM
		set info_number 8
		ifl gui_pos_x_temp 3
		 ifg gui_pos_x_temp -3
		  ifl gui_pos_y_temp 3
		   ifg gui_pos_y_temp -3
		   {
		   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
		   ifand next_mission_loc 65536 { xor next_mission_loc 65536 savegamevar next_mission_loc }
		   rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 disp_temp9 0 0 0 xdim ydim
			state CLICK_INFO_BOX
		   }
		else
			{
			ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 disp_temp9 0 0 0 xdim ydim
			ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
			}
		}
	ifand BEAT_EPISODES[1] 256 // found the secret level in Dis base?
			{
		// ################################################
		// Scarlet Hollow
		// ################################################
			set gui_pos_x 170
			set gui_pos_y 120
			state CURSOR_OVER_ITEM
			set info_number 9
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
				ifand next_mission_loc 65536 { xor next_mission_loc 65536 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 0 14775 0 11 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14774 5 11 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
			}
	} // End of Episode 1 missions

ifand COM_FILTER 2
 ifand BEAT_EPISODES[2] 262144
	{
		// ################################################
		// The Lurking Fear
		// ################################################
			set gui_pos_x 115
			set gui_pos_y 145
			ifand BEAT_EPISODES[2] 262144 set disp_temp9 11 else set disp_temp9 21
			state CURSOR_OVER_ITEM
			set info_number 22
			ifl gui_pos_x_temp 3
			 ifg gui_pos_x_temp -3
			  ifl gui_pos_y_temp 3
			   ifg gui_pos_y_temp -3
			   {
			   ife SEEN_MAP[info_number] 0 setarray SEEN_MAP[info_number] 1
			   ifand next_mission_loc 65536 { xor next_mission_loc 65536 savegamevar next_mission_loc }
			   rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
	}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// LOCAL CLUSTER SCREEN
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_LOCAL_STAR_SCREEN

	set gui_pos_x 155
	set gui_pos_y 106
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show Sol System
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 23 0 0 0 xdim ydim
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 26
			stopsound COMMAND_AMB6
			soundonce SATELLITE_SW
			set show_system SYS_SOL
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 10 23 0 0 0 xdim ydim
	ifand next_mission_loc 79935 state NEW_MAP_DISPLAY

	set gui_pos_x 189
	set gui_pos_y 57
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show Ishteg System
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 23 0 0 0 xdim ydim
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 32
			stopsound COMMAND_AMB6
			soundonce SATELLITE_SW
			set show_system SYS_ISHTEG
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 10 23 0 0 0 xdim ydim
	ifand next_mission_loc 768 state NEW_MAP_DISPLAY

	set gui_pos_x 251
	set gui_pos_y 83
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show 33 boo System
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 23 0 0 0 xdim ydim
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 32
			stopsound COMMAND_AMB6
			soundonce SATELLITE_SW
			set show_system SYS_BOO
			}
	   }
		else
	rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 10 23 0 0 0 xdim ydim
	ifand next_mission_loc 1024 state NEW_MAP_DISPLAY

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// MILKY WAY
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_MILKY_WAY_SCREEN

	set gui_pos_x 219
	set gui_pos_y 124
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show local star system
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 23 0 0 0 xdim ydim
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 52
			stopsound COMMAND_AMB8
			soundonce SATELLITE_SW
			set show_system SYS_LOCAL_CLOUD
			}
	   }
		else
		{
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 10 23 0 0 0 xdim ydim
		ifand next_mission_loc 81407 state NEW_MAP_DISPLAY
		}

	set gui_pos_x 89
	set gui_pos_y 106
	state CURSOR_OVER_ITEM
	set info_number 61
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show Elysion
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 23 0 0 0 xdim ydim
	   ifand BITS_PRESS 4
			{
			ifand BEAT_EPISODES[4] 1
				{
				set DISP_STUFF 52
				stopsound COMMAND_AMB8
				soundonce SATELLITE_SW
				set show_system SYS_ELYSION
				}
			else
				{
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14776 0 disp_temp9 0 0 0 xdim ydim
				state CLICK_INFO_BOX
				}
			}
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
			rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 10 23 0 0 0 xdim ydim
			ifand next_mission_loc 32768 state NEW_MAP_DISPLAY
			// display a shimmer
			ife VOLUME 3
				ife ELYSION_QUEST 0
			{
				state NEW_MAP_DISPLAY
			}
		}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// ELYSION
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate SHOW_ELYSION_SCREEN

	set gui_pos_x 50
	set gui_pos_y 87
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   { // Show local star system
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 23 0 0 0 xdim ydim
	   ifand BITS_PRESS 4
			{
			set DISP_STUFF 52
			stopsound COMMAND_AMB6
			soundonce SATELLITE_SW
			set show_system SYS_ELYSION_SURFACE
			}
	   }
		else
		{
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 10 23 0 0 0 xdim ydim
		ifand next_mission_loc 32768 state NEW_MAP_DISPLAY
		}



ifand BEAT_EPISODES[4] 1
 {
	set gui_pos_x 70
	set gui_pos_y 55
	state CURSOR_OVER_ITEM
	set info_number 62
	ifl gui_pos_x_temp 5
	 ifg gui_pos_x_temp -5
	  ifl gui_pos_y_temp 5
	   ifg gui_pos_y_temp -5
	   {
	   rotatesprite gui_pos_x gui_pos_y 20000 0 14777 0 11 0 0 0 xdim ydim
		state CLICK_INFO_BOX
	   }
		else
		{
		ife rollover_sound info_number set rollover_sound -1
		rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14776 10 11 0 0 0 xdim ydim
		ifand next_mission_loc 32768 state NEW_MAP_DISPLAY
		}
}

ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// ELYSION SURFACE
// *****************************************************************************************************************************************
// =========================================================================================================================================


defstate ELYSION_INFO_BOXES
ife INFO_SEL 63 // Easthaven
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21009 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic
	set disp_temp4 15
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	}

ife INFO_SEL 64 // Wetlands of Rowgar
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21010 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[61] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[61] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[61] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[61] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[61] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_MICKY
	state mission_charselector


	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_necro 1573139
				set ps_egypt 146
				set ps_misc 4612
				state precog_enemies
				}
		}
	}

ife INFO_SEL 65 // Lookout of irusoph
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21011 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic
	ifg SKILL_MEDALS[64] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[64] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[64] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[64] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[64] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_MERLIJN
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}

	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1

				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_necro 1640471
				set ps_demons 583
				set ps_cults 4
				state precog_enemies
				}
		}
	}


ife INFO_SEL 68 // The Necropolis
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21014 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[66] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[66] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[66] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[66] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[66] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_RUSTY
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}

	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1

				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_necro 131091
				set ps_zombies 4
				state precog_enemies
				}
		}
	}

ife INFO_SEL 69 // Picbonear reservoir
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21015 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[67] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[67] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[67] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[67] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[67] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_SNOWFALL
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
		ife BASE_RESEARCH[5] 2 // has the precog brain?
		 ifand BOX_TOGGLE 1
			{
			rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
			set ps_necro 1638407
			set ps_misc 4
			state precog_enemies
			}
		}
	}

ife INFO_SEL 70 // Ebon Pinnacle
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21016 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[65] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[65] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[65] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[65] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[65] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_SANG
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_necro 6062087
				state precog_enemies
				}
		}
	}

ife INFO_SEL 71 // Darrow Lake
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21017 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[63] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[63] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[63] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[63] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[63] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_JAMES
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_necro 1605711
				set ps_mj12 16
				state precog_enemies
				}
		}
	}

ife INFO_SEL 72 // Supply run
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21018 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic
	ifg SKILL_MEDALS[62] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[62] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[62] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[62] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[62] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_KAGURA
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_misc 544
				set ps_necro 525313
				set ps_cults 4
				set ps_shadow 91
				set ps_cycloids 16
				state precog_enemies
				}
		}
	}

ife INFO_SEL 74 // Palace of Rowgar
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21021 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[72] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[72] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[72] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[72] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[72] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	state mission_charselector
	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_misc 544
				set ps_necro 4259955
				set ps_egypt 215
				state precog_enemies
				}
		}
	}

ife INFO_SEL 75 // Up in the sky
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21022 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[73] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[73] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[73] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[73] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[73] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	state mission_charselector
	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1

				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_misc 544
				set ps_necro 4260083
				state precog_enemies
				}
		}
	}

ife INFO_SEL 76 // Axon's library
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21023 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[74] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[74] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[74] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[74] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[74] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	state mission_charselector
	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_misc 544
				set ps_necro 65595
				set ps_cults 1024
				set ps_mj12 3
				state precog_enemies
				}
		}
	}

ife INFO_SEL 77 // Necromancer's keep
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21024 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[75] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[75] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[75] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[75] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[75] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	state mission_charselector
	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}
	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_misc 4096
				set ps_necro 6058143
				set ps_cults 1028
				state precog_enemies
				}
		}
	}

ife INFO_SEL 78 // Serpent Canyon
	{
	rotatesprite 160 100 MISSION_PIC_SIZE 0 21027 0 mission_pic_pal 0 0 0 xdim ydim // Main Pic

	ifg SKILL_MEDALS[68] 0 rotatesprite 185 125 HALFSIZE 0 14812 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[68] 1 rotatesprite 190 125 HALFSIZE 0 14811 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[68] 2 rotatesprite 195 125 HALFSIZE 0 14810 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[68] 3 rotatesprite 200 125 HALFSIZE 0 14809 0 0 0 0 0 xdim ydim
	ifg SKILL_MEDALS[68] 4 rotatesprite 205 125 HALFSIZE 0 14765 0 0 0 0 0 xdim ydim

	set disp_temp4 15
	set m_charselect_forced 1
	set m_charselect_flags FLAG_MIKKO
	state mission_charselector

	ife PCINTER 14
		{
		state PAPER_INFO_BOX
		state PAPER_TRAVEL_BOX
		}
	else
		{
		state STANDARD_INFO_BOX
		state MISSION_START_BOX
		}

	ifn PCINTER 14
		{
		state PRECOG_BOX
			ife BASE_RESEARCH[5] 2 // has the precog brain?
			 ifand BOX_TOGGLE 1
				{
				rotatesprite 160 80 20000 0 14657 15 18 0 0 0 xdim ydim // Main Pic
				set ps_necro 4784133
				set ps_egypt 151
				set ps_misc 9248
				state precog_enemies
				}
		}
	}

ends

defstate ELYSION_MAP_STUFF

		ifand COM_FILTER 8
		{

		// ################################################
		// EAST HAVEN
		// ################################################
			set gui_pos_x 125
			set gui_pos_y 81
			state CURSOR_OVER_ITEM
			set info_number 63
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				ife PCINTER 14 rotatesprite gui_pos_x gui_pos_y 14288 0 25598 disp_pulse 0 0 0 0 xdim ydim
			   else rotatesprite gui_pos_x gui_pos_y 36768 0 14777 0 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14 rotatesprite gui_pos_x gui_pos_y 12288 0 25598 5 0 0 0 0 xdim ydim
				else rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 14776 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}

		ifand ELYSION_QUEST 64 // Micky quest done?
		 ifand ELYSION_QUEST 256 // Sang quest done?
		   ifand ELYSION_QUEST 2048 // Snowfall quest done?
		    ifand ELYSION_QUEST 4096 // James quest done?
			 ifand ELYSION_QUEST 16384 // Kagura quest done?
			  ifand ELYSION_QUEST 131072  // Merlijn Quest done?
				{
				ifand ELYSION_QUEST 1 nullop else
				rotatesprite gui_pos_x gui_pos_y HALFSIZE 0 19584 0 0 0 0 0 xdim ydim
				}



		ifand ELYSION_QUEST 4 // Micky's quest activated?
		{
		// ################################################
		// WETLANDS OF ROWGAR
		// ################################################
			set gui_pos_x 183
			set gui_pos_y 38
			state CURSOR_OVER_ITEM
			set info_number 64
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
				ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 64 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MICKY disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 64 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MICKY 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand ELYSION_QUEST 32 // Merlijn's quest activated?
		{
		// ################################################
		// LOOKOUT OF IRUSOPH
		// ################################################
			set gui_pos_x 14
			set gui_pos_y 83
			state CURSOR_OVER_ITEM
			set info_number 65
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 131072 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MERLIJN disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 131072 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MERLIJN 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand ELYSION_QUEST 128 // Sang's quest activated?
		{
		// ################################################
		// SJOERD'S WOODLANDS
		// ################################################
			set gui_pos_x 183
			set gui_pos_y 134
			state CURSOR_OVER_ITEM
			set info_number 70
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					// ifand BEAT_EPISODES[4] 16
					ifand ELYSION_QUEST 256 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_SANG disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 256 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_SANG 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand ELYSION_QUEST 16 // James' quest activated?
		{
		// ################################################
		// DARROW LAKE
		// ################################################
			set gui_pos_x 136
			set gui_pos_y 42
			state CURSOR_OVER_ITEM
			set info_number 71
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					// ifand BEAT_EPISODES[4] 8
					ifand ELYSION_QUEST 4096 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_JAMES disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 4096 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_JAMES 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand ELYSION_QUEST 8192 // Kagura's quest activated?
		{
		// ################################################
		// SUPPLY RUN
		// ################################################
			set gui_pos_x 288
			set gui_pos_y 92
			state CURSOR_OVER_ITEM
			set info_number 72
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					// ifand BEAT_EPISODES[4] 32
					ifand ELYSION_QUEST 16384 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_KAGURA disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 16384 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_KAGURA 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand ELYSION_QUEST 8 // Rusty quest activated?
		{
		// ################################################
		// THE NECROPOLIS
		// ################################################
			set gui_pos_x 94
			set gui_pos_y 130
			state CURSOR_OVER_ITEM
			set info_number 68
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					// ifand BEAT_EPISODES[4] 512
					ifand ELYSION_QUEST 512 rotatespritea gui_pos_x gui_pos_y 13288 0 8139 disp_pulse 42 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 13288 0 8140 disp_pulse 42 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 256 14789 0 11 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_RUSTY disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 512 rotatespritea gui_pos_x gui_pos_y 11288 0 8139 5 42 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 11288 0 8140 5 42 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14788 5 11 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_RUSTY 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}


		// ################################################
		// PICBONEAR RESERVOIR
		// ################################################
			set gui_pos_x 143
			set gui_pos_y 108
			state CURSOR_OVER_ITEM
			set info_number 69
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					// ifand BEAT_EPISODES[4] 4
					ifand ELYSION_QUEST 2048 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_SNOWFALL disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 2048 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_SNOWFALL 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}

		// ################################################
		// SERPENT CANYON
		// ################################################
			set gui_pos_x 215
			set gui_pos_y 147
			state CURSOR_OVER_ITEM
			set info_number 78
			ifand BEAT_EPISODES[4] 1024 set disp_temp9 11 else set disp_temp9 21
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 524288 rotatespritea gui_pos_x gui_pos_y 13288 0 8139 disp_pulse 42 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 13288 0 8140 disp_pulse 42 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 256 14775 0 disp_temp9 0 0 0 xdim ydim
			   rotatesprite gui_pos_x gui_pos_y 20000 0 MI_MIKKO disp_pulse 0 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand ELYSION_QUEST 524288 rotatespritea gui_pos_x gui_pos_y 11288 0 8139 5 42 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 11288 0 8140 5 42 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 256 14774 5 disp_temp9 0 0 0 xdim ydim
				rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 MI_MIKKO 5 0 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}

	ifand ELYSION_QUEST 1 // All main quests done?
		{
		// ################################################
		// PALACE OF ROWGAR
		// ################################################
			set gui_pos_x 152
			set gui_pos_y 164
			state CURSOR_OVER_ITEM
			set info_number 74
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 4096 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 4096 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand BEAT_EPISODES[4] 4096 // Beat palace of rowgar?
		{
		// ################################################
		// SKY ISLANDS
		// ################################################
			set gui_pos_x 285
			set gui_pos_y 150
			state CURSOR_OVER_ITEM
			set info_number 75
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 8192 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
			else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 8192 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand BEAT_EPISODES[4] 8192 // Beat Sky islands?
		{
		// ################################################
		// SKY CAVES
		// ################################################
			set gui_pos_x 305
			set gui_pos_y 154
			state CURSOR_OVER_ITEM
			set info_number 76
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 16384 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 16384 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	ifand BEAT_EPISODES[4] 16384 // Beat Sky caves?
		{
		// ################################################
		// NECROMANCER'S KEEP
		// ################################################
			set gui_pos_x 233
			set gui_pos_y 101
			state CURSOR_OVER_ITEM
			set info_number 77
			ifl gui_pos_x_temp 5
			 ifg gui_pos_x_temp -5
			  ifl gui_pos_y_temp 5
			   ifg gui_pos_y_temp -5
			   {
			   ife SEEN_MAP[info_number] 0
				   {
				   setarray SEEN_MAP[info_number] 1
				   writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
				   }
				   ifand next_mission_loc 32768 { xor next_mission_loc 32768 savegamevar next_mission_loc }
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 32768 rotatespritea gui_pos_x gui_pos_y 14288 0 8139 disp_pulse 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 14288 0 8140 disp_pulse 0 0 0 0 xdim ydim
					}
			   else rotatesprite gui_pos_x gui_pos_y 20000 0 14789 0 11 0 0 0 xdim ydim
				state CLICK_INFO_BOX
			   }
				else
				{
				ife rollover_sound info_number set rollover_sound -1
				ife PCINTER 14
					{
					ifand BEAT_EPISODES[4] 32768 rotatespritea gui_pos_x gui_pos_y 12288 0 8139 5 0 0 75 0 0 xdim ydim
					else rotatesprite gui_pos_x gui_pos_y 12288 0 8140 5 0 0 0 0 xdim ydim
					}
				else rotatesprite gui_pos_x gui_pos_y QUARTERSIZE 0 14788 5 11 0 0 0 xdim ydim
				ife SEEN_MAP[info_number] 0 state NEW_MAP_DISPLAY
				}
		}

	}

ends

defstate SHOW_ELYSION_SURFACE_SCREEN
	state ELYSION_MAP_STUFF
ends


// =========================================================================================================================================
// *****************************************************************************************************************************************
// ELYSION PAPER MAP
// *****************************************************************************************************************************************
// =========================================================================================================================================

defstate ELYSION_PAPER_MAP
	rotatesprite 160 100 35500 0 22716 0 0 0 0 0 xdim ydim
	state ELYSION_MAP_STUFF
	state ELYSION_INFO_BOXES
ends

// =========================================================================================================================================
// *****************************************************************************************************************************************
// MAIN DISPLAY
// *****************************************************************************************************************************************
// =========================================================================================================================================

   defstate ZOOM_COM_OUT
    ifcount 8
		{
		state clear_precog
		set DISP_STUFF 13
		set news_ticker 9200
		set news_x 400
		ife show_system SYS_EARTH set show_system SYS_SOL // Go to sol
		else ife show_system SYS_MOON set show_system SYS_SOL // Go to sol
		else ife show_system SYS_GANYMEDE set show_system SYS_SOL // Go to sol
		else ife show_system SYS_IO set show_system SYS_SOL // Go to sol
		else ife show_system SYS_MARS set show_system SYS_SOL // Go to sol
		else ife show_system SYS_SOL ifg VOLUME 0 { set DISP_STUFF 26 set show_system SYS_LOCAL_CLOUD } // go to local cluster if in Solar system
		else ife show_system SYS_LOCAL_CLOUD ifg VOLUME 2 { set DISP_STUFF 36 set show_system SYS_MILKY_WAY }  // Go to Milky way
		else ife show_system SYS_ISHTEG { set DISP_STUFF 26 set show_system SYS_LOCAL_CLOUD } // go to local cluster if in Ishteg system
		else ife show_system SYS_XUGLOP { set DISP_STUFF 16 set show_system SYS_ISHTEG } // Go to Ishteg if on Xuglop
		else ife show_system SYS_RACTONIA { set DISP_STUFF 16 set show_system SYS_ISHTEG } // Go to Ishteg if on Ractonia
		else ife show_system SYS_BOO { set DISP_STUFF 26 set show_system SYS_LOCAL_CLOUD } // go to local cluster if in 33 Boo system
		else ife show_system SYS_UMBRIEL set show_system SYS_SOL // Go to sol
		else ife show_system SYS_USA set show_system SYS_EARTH // Go to Earth
		else ife show_system SYS_EUROPE set show_system SYS_EARTH // Go to Earth
		else ife show_system SYS_ELYSION { set DISP_STUFF 36 set show_system SYS_MILKY_WAY } // Go to Milky Way
		else ife show_system SYS_ELYSION_SURFACE { set DISP_STUFF 36 set show_system SYS_ELYSION } // Go to Elysion overview
		else ife show_system SYS_ABYSS { set DISP_STUFF 26 set show_system SYS_GANYMEDE } // go to Ganymede if in Abyss
		else ife show_system SYS_CERES set show_system SYS_SOL // Go to sol
		else ife show_system SYS_HAUMEA set show_system SYS_SOL // Go to sol
		else ife show_system SYS_MAKEMAKE set show_system SYS_SOL // Go to sol
		else ife show_system SYS_ERIS set show_system SYS_SOL // Go to sol
		else ife show_system SYS_VENUS set show_system SYS_SOL // Go to sol
		ifn show_system SYS_EUROPE ifn show_system SYS_USA ifn show_system SYS_EARTH stopsound COMMAND_AMB
		ifn show_system SYS_EUROPE ifn show_system SYS_USA ifn show_system SYS_EARTH stopsound COMM_AMB_ALT
		stopsound COMMAND_AMB2
		stopsound COMMAND_AMB3
		stopsound COMMAND_AMB4
		stopsound COMMAND_AMB5
		stopsound COMMAND_AMB6
		stopsound COMMAND_AMB7
		stopsound ENTERDIS
		soundonce SATELLITE_SW2
		resetcount
		}
	ends

include CODE/GUI/COMM_MISS.CON

defstate COMMAND_INTERFACE_DISPLAY
rotatesprite 160 100 NORMALSIZE 0 3584 0 4 1024 0 0 xdim ydim

gettimedate disp_temp disp_temp2 disp_temp3 disp_temp4 disp_temp5 disp_temp6 disp_temp7 disp_temp7

ife news_count -1
{
	set update_news_ticker 1
	set news_count 0
}
else
{
	add news_count 1

	// Roughly every 3 ms => divide framerate by 30 and update each time the count exceeds this number
	set temp framerate
	ifand BITS_PRESS 1 div temp 90 else
	div temp 60
	ifge news_count temp
	{
		set update_news_ticker 1
		set news_count 0
	}
	else
		set update_news_ticker 0
}
ife show_system SYS_EARTH
{
set disp_temp7 disp_temp3
ifn disp_temp7 0 mulvar disp_temp7 13

ifge VOLUME 4 rotatesprite 160 100 30360 0 29439 0 21 0 0 0 xdim ydim
else rotatesprite 160 100 30360 0 14651 0 0 0 0 0 xdim ydim

ife rendmode 0 rotatespritea disp_temp7 100 83000 0 14757 0 1 0 -254 0 0 xdim ydim
else rotatespritea disp_temp7 100 83000 0 14757 0 121 0 -253 0 0 xdim ydim

rotatespritea 160 100 30360 0 14652 0 0 0 -255 0 0 xdim ydim
}
else
ife show_system SYS_SOL // Sol System
	{
	rotatesprite 160 100 20480 0 23756 0 0 8 0 0 xdim ydim
	rotatespritea 0 100 40480 0 3605 0 2 265 -255 0 0 xdim ydim
	rotatespritea 0 100 15000 0 29242 0 0 265 -255 0 0 xdim ydim

	rotatesprite 11 117 3400 0 8458 0 0 8 0 0 xdim ydim // mercury

	rotatesprite 35 117 7400 0 8457 0 0 8 0 0 xdim ydim // venus

	rotatesprite 130 108 5192 0 13697 0 0 8 0 0 xdim ydim // jupiter

	rotatesprite 190 108 7192 0 22367 0 0 8 0 0 xdim ydim // saturn

	rotatesprite 240 108 2192 0 20226 0 0 8 0 0 xdim ydim // uranus

	rotatesprite 280 108 2192 0 20428 0 0 8 0 0 xdim ydim // neptune

	rotatesprite 310 108 512 0 22485 0 0 8 0 0 xdim ydim // pluto

	}
else
ife show_system SYS_MOON // Moon
rotatesprite 160 100 30360 0 14701 0 0 0 0 0 xdim ydim
else
ife show_system SYS_GANYMEDE // Ganymede
rotatesprite 160 100 30360 0 14702 0 0 0 0 0 xdim ydim
else
ife show_system SYS_IO // Io
rotatesprite 160 100 30360 0 14707 0 0 0 0 0 xdim ydim
else
ife show_system SYS_MARS // Mars
rotatesprite 160 100 30360 0 14717 0 0 0 0 0 xdim ydim
else
ife show_system SYS_VENUS // Venus
rotatesprite 160 100 30360 0 14634 0 0 0 0 0 xdim ydim
else
ife show_system SYS_LOCAL_CLOUD // Local star systems
rotatesprite 160 100 30360 0 14691 0 0 0 0 0 xdim ydim
else
ife show_system SYS_ISHTEG // Ishteg System
rotatesprite 160 100 41500 0 14739 0 0 0 0 0 xdim ydim
else
ife show_system SYS_XUGLOP // Xuglop
rotatesprite 160 100 41500 0 14740 0 0 0 0 0 xdim ydim
else
ife show_system SYS_RACTONIA // Ractonia
rotatesprite 160 100 41500 0 14741 0 0 0 0 0 xdim ydim
else
ife show_system SYS_BOO // Bo33 System
{
rotatesprite 160 100 41500 0 15074 0 0 0 0 0 xdim ydim
ifand BEAT_EPISODES[2] 131072 nullop // Energeia is gone after map is beaten
else rotatesprite 85 115 41500 0 15073 0 0 0 0 0 xdim ydim
}
else
ife show_system SYS_UMBRIEL // Umbriel
rotatesprite 160 100 41500 0 21247 0 0 0 0 0 xdim ydim
else
ife show_system SYS_USA // USA
	{
	set disp_temp7 disp_temp3
	sub disp_temp7 4
	ifge VOLUME 4
		{
		ifg disp_temp7 12
		rotatesprite 160 100 30360 0 21245 0 21 0 0 0 xdim ydim
		else
		rotatesprite 160 100 30360 0 21246 5 21 0 0 0 xdim ydim
		}
	else
		{
		ifg disp_temp7 12
		rotatesprite 160 100 30360 0 21245 0 0 0 0 0 xdim ydim
		else
		rotatesprite 160 100 30360 0 21246 5 0 0 0 0 xdim ydim
		}
	}
else
ife show_system SYS_EUROPE // Europe
	{
	set disp_temp7 disp_temp3
	sub disp_temp7 4
	ifge VOLUME 4
		{
		ifg disp_temp7 12
		rotatesprite 160 100 30360 0 21219 0 21 0 0 0 xdim ydim
		else
		rotatesprite 160 100 30360 0 21218 5 21 0 0 0 xdim ydim
		}
	else
		{
		ifg disp_temp7 12
		rotatesprite 160 100 30360 0 21219 0 0 0 0 0 xdim ydim
		else
		rotatesprite 160 100 30360 0 21218 5 0 0 0 0 xdim ydim
		}
	}
else
ife show_system SYS_MILKY_WAY // Milky way
rotatesprite 160 100 41500 0 22721 0 0 0 0 0 xdim ydim
else
ife show_system SYS_ELYSION // Elysion
rotatesprite 160 100 35500 0 22720 0 0 0 0 0 xdim ydim
else
ife show_system SYS_ABYSS // The Abyss
rotatesprite 160 100 41500 0 14731 0 0 0 0 0 xdim ydim
else
ife show_system SYS_ELYSION_SURFACE // Elysion Surface
rotatesprite 160 100 35500 0 22719 0 0 0 0 0 xdim ydim
else
ife show_system SYS_CERES // Ceres
rotatesprite 160 100 30360 0 33769 0 0 0 0 0 xdim ydim
else
ife show_system SYS_HAUMEA // Haumea
rotatesprite 160 100 30360 0 33770 0 0 0 0 0 xdim ydim
else
ife show_system SYS_MAKEMAKE // Makemake
rotatesprite 160 100 30360 0 33771 0 0 0 0 0 xdim ydim
else
ife show_system SYS_ERIS // Eris
rotatesprite 160 100 30360 0 33772 0 0 0 0 0 xdim ydim

ife update_news_ticker 1
{
	sub news_x 1

	qstrlen disp_temp news_ticker
	mul disp_temp 5
	inv disp_temp

	ife news_x disp_temp
	{
		add news_ticker 1
		ifg news_ticker 9207 set news_ticker 9200
		set news_x 350
	}
}

ife show_system SYS_EARTH state SHOW_EARTH_SCREEN
else ife show_system SYS_SOL state SHOW_SOL_SCREEN
else ife show_system SYS_MOON state SHOW_MOON_SCREEN
else ife show_system SYS_GANYMEDE state SHOW_GANYMEDE_SCREEN
else ife show_system SYS_IO state SHOW_IO_SCREEN
else ife show_system SYS_MARS state SHOW_MARS_SCREEN
else ife show_system SYS_LOCAL_CLOUD state SHOW_LOCAL_STAR_SCREEN
else ife show_system SYS_ISHTEG state SHOW_ISHTEG_SCREEN
else ife show_system SYS_XUGLOP state SHOW_XUGLOP_SCREEN
else ife show_system SYS_RACTONIA state SHOW_RACTONIA_SCREEN
else ife show_system SYS_BOO state SHOW_BO33_SCREEN
else ife show_system SYS_UMBRIEL state SHOW_UMBRIEL_SCREEN
else ife show_system SYS_USA state SHOW_USA_SCREEN
else ife show_system SYS_EUROPE state SHOW_EUROPE_SCREEN
else ife show_system SYS_MILKY_WAY state SHOW_MILKY_WAY_SCREEN
else ife show_system SYS_ELYSION state SHOW_ELYSION_SCREEN
else ife show_system SYS_ABYSS state SHOW_ABYSS_SCREEN
else ife show_system SYS_ELYSION_SURFACE state SHOW_ELYSION_SURFACE_SCREEN
else ife show_system SYS_CERES state SHOW_CERES_SURFACE_SCREEN
else ife show_system SYS_HAUMEA state SHOW_HAUMEA_SURFACE_SCREEN
else ife show_system SYS_MAKEMAKE state SHOW_MAKEMAKE_SURFACE_SCREEN
else ife show_system SYS_ERIS state SHOW_ERIS_SURFACE_SCREEN
else ife show_system SYS_VENUS state SHOW_VENUS_SCREEN

ifg DISP_STUFF 0
{
sub DISP_STUFF 1
ife DISP_STUFF 24 soundonce STATIC_S
ife DISP_STUFF 12 soundonce STATIC_S
ifg DISP_STUFF 10
	{
	displayrandvar disp_temp6 2048
	rotatesprite 160 100 382144 disp_temp6 351 0 0 1024 0 0 xdim ydim
	}
else ifg DISP_STUFF 6
	{
	displayrandvar disp_temp6 2048
	rotatesprite 160 100 382144 disp_temp6 351 0 0 1025 0 0 xdim ydim
	}
else
    {
	displayrandvar disp_temp6 2048
	rotatesprite 160 100 382144 disp_temp6 351 0 0 1057 0 0 xdim ydim
	}
}

// ====================================
// MAIN HUD
// ====================================

  rotatesprite 160 10 20984 0 14653 0 0 8 0 0 xdim ydim

  rotatesprite 160 190 20984 0 14669 0 0 8 0 0 xdim ydim

ife show_system SYS_EARTH set disp_temp7 4090
else ife show_system SYS_SOL set disp_temp7 4091
else ife show_system SYS_MOON set disp_temp7 4093
else ife show_system SYS_GANYMEDE set disp_temp7 4094
else ife show_system SYS_IO set disp_temp7 4095
else ife show_system SYS_MARS set disp_temp7 4092
else ife show_system SYS_LOCAL_CLOUD set disp_temp7 4096
else ife show_system SYS_ISHTEG set disp_temp7 4097
else ife show_system SYS_XUGLOP set disp_temp7 4100
else ife show_system SYS_RACTONIA set disp_temp7 4101
else ife show_system SYS_BOO set disp_temp7 4099
else ife show_system SYS_UMBRIEL set disp_temp7 4102
else ife show_system SYS_USA set disp_temp7 4103
else ife show_system SYS_EUROPE set disp_temp7 4104
else ife show_system SYS_MILKY_WAY set disp_temp7 4106
else ife show_system SYS_ELYSION set disp_temp7 4107
else ife show_system SYS_ABYSS set disp_temp7 4098
else ife show_system SYS_ELYSION_SURFACE set disp_temp7 4107
else ife show_system SYS_CERES set disp_temp7 4108
else ife show_system SYS_HAUMEA set disp_temp7 4109
else ife show_system SYS_MAKEMAKE set disp_temp7 4110
else ife show_system SYS_ERIS set disp_temp7 4111
else ife show_system SYS_VENUS set disp_temp7 4112
gametext MINIFONT 106 189 disp_temp7 0 33 0 0 0 xdim ydim

ifand BITS_PRESS 64
	{
	ifn INFO_SEL 0
	 ifcount 8
		{
		soundonce INTERFACE_3 // Exit
		set INFO_SEL 0
		set rollover_sound 0
		resetcount
		}
	else
		{
		ifl VOLUME 3
			{
			ifn show_system SYS_LOCAL_CLOUD state ZOOM_COM_OUT
			}
		else ifn show_system SYS_MILKY_WAY state ZOOM_COM_OUT
		}
	}

set gui_pos_x 295
set gui_pos_y 10
state CURSOR_OVER_ITEM
ifl gui_pos_x_temp 15
 ifg gui_pos_x_temp -15
  ifl gui_pos_y_temp 5
   ifg gui_pos_y_temp -5
   { // Exit button
   rotatespritea gui_pos_x gui_pos_y 20000 0 14655 0 0 0 -255 0 0 xdim ydim
   ifand BITS_PRESS 4
		{
		writearraytofile SEEN_MAP F_SEEN_MAP_AMCTC
		sound CLOSE_COMM // Exit
		state fade_out_black
		set cus_fade_duration 5
		stopsound COMMAND_AMB5
		stopsound COMMAND_AMB6
		stopsound COMMAND_AMB7
		stopsound COMMAND_AMB8
		stopsound COMMAND_AMB4
		stopsound COMMAND_AMB3
		stopsound COMMAND_AMB2
		stopsound COMMAND_AMB
		stopsound COMM_AMB_ALT
		stopsound ENTERDIS
		set PCINTER 0
		set MOUSEUP 0
		}
   }
	else
rotatespritea gui_pos_x gui_pos_y 20000 0 14654 0 0 0 -255 0 0 xdim ydim

set gui_pos_x 30
set gui_pos_y 10
state CURSOR_OVER_ITEM
ifl gui_pos_x_temp 15
 ifg gui_pos_x_temp -15
  ifl gui_pos_y_temp 7
   ifg gui_pos_y_temp -7
   { // Info button
   rotatespritea gui_pos_x gui_pos_y 20000 0 14672 0 0 0 -255 0 0 xdim ydim

   	set mouse_hint 3061 // refers to quote in user.con
	sub mouse_hint_timer 2

   ifand BITS_PRESS 4
    ifcount 8
		{
		ifand COM_FILTER 64 soundonce INTERFACE_3 else
		soundonce INTERFACE_2
		xorvar COM_FILTER 64
		resetcount
		}
   }
	else
rotatespritea gui_pos_x gui_pos_y 20000 0 14670 0 0 0 -255 0 0 xdim ydim

set gui_pos_x 85
set gui_pos_y 10
state CURSOR_OVER_ITEM
ifl gui_pos_x_temp 15
 ifg gui_pos_x_temp -15
  ifl gui_pos_y_temp 7
   ifg gui_pos_y_temp -7
   { // Help button
   rotatespritea gui_pos_x gui_pos_y 20000 0 14685 0 0 0 -255 0 0 xdim ydim

   	set mouse_hint 3062 // refers to quote in user.con
	sub mouse_hint_timer 2

   ifand BITS_PRESS 4
    ifcount 8
		{
		ifand COM_FILTER 128 soundonce INTERFACE_3 else
		soundonce INTERFACE_2
		xorvar COM_FILTER 128
		resetcount
		}
   }
	else
rotatespritea gui_pos_x gui_pos_y 20000 0 14684 0 0 0 -255 0 0 xdim ydim

set gui_pos_x 140
set gui_pos_y 10

// zoom out button ========================================================================================================================================================================

	set disp_temp5 0
	set disp_temp6 0
	// next mission loc is basically filtering every mission that is outside the current system's zoom layer
	ife show_system SYS_EARTH ifand next_mission_loc 118782 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_SOL ifand next_mission_loc 51136 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_GANYMEDE ifand next_mission_loc 65527 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_IO ifand next_mission_loc 131055 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_MARS ifand next_mission_loc 131039 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_LOCAL_CLOUD ifand next_mission_loc 49152 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_ISHTEG ifand next_mission_loc 130175 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_XUGLOP ifand next_mission_loc 130815 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_RACTONIA ifand next_mission_loc 130559 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_BOO ifand next_mission_loc 130047 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_UMBRIEL ifand next_mission_loc 129023 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_USA ifand next_mission_loc 126975 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_EUROPE ifand next_mission_loc 122879 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_ABYSS ifand next_mission_loc 65535 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_ELYSION ifand next_mission_loc 98303 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_CERES ifand next_mission_loc 131071 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_HAUMEA ifand next_mission_loc 131071 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_MAKEMAKE ifand next_mission_loc 131071 { set disp_temp5 106 set disp_temp6 disp_pulse }
	ife show_system SYS_ERIS ifand next_mission_loc 131071 { set disp_temp5 106 set disp_temp6 disp_pulse }

	ife show_system SYS_VENUS ifand next_mission_loc 131071 { set disp_temp5 106 set disp_temp6 disp_pulse }

ife VOLUME 0
{
state CURSOR_OVER_ITEM
ifl gui_pos_x_temp 15
 ifg gui_pos_x_temp -15
  ifl gui_pos_y_temp 7
   ifg gui_pos_y_temp -7
    ifn show_system SYS_SOL // not in local star system (furthest zoom)
   { // Show Star system
   rotatespritea gui_pos_x gui_pos_y 20000 0 14687 0 0 0 -255 0 0 xdim ydim

   ife show_system SYS_SOL set mouse_hint 3064 else
   ife show_system SYS_ISHTEG set mouse_hint 3064 else
   ife show_system SYS_USA set mouse_hint 3067 else
   ife show_system SYS_EUROPE set mouse_hint 3067 else
   	set mouse_hint 3063 // refers to quote in user.con
	sub mouse_hint_timer 2

   ifand BITS_PRESS 4 state ZOOM_COM_OUT
   }
	else
	{
	ife show_system SYS_SOL rotatespritea gui_pos_x gui_pos_y 20000 0 14686 15 27 0 -255 0 0 xdim ydim else
	rotatespritea gui_pos_x gui_pos_y 20000 0 14686 disp_temp6 disp_temp5 0 -255 0 0 xdim ydim
	}
}
else
ifg VOLUME 2
{
	// Button is being hovered over:
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
		ifn show_system SYS_MILKY_WAY // not in milky way
	{
			// Show Star system
		   rotatespritea gui_pos_x gui_pos_y 20000 0 14687 0 0 0 -255 0 0 xdim ydim

		   ife show_system SYS_SOL set mouse_hint 3064 else
		   ife show_system SYS_ISHTEG set mouse_hint 3064 else
		   ife show_system SYS_USA set mouse_hint 3067 else
		   ife show_system SYS_EUROPE set mouse_hint 3067 else
		   ife show_system SYS_LOCAL_CLOUD set mouse_hint 3068 else
			set mouse_hint 3063 // refers to quote in user.con
			sub mouse_hint_timer 2

		   ifand BITS_PRESS 4 state ZOOM_COM_OUT
	}

	// Not hovered over:
	else
	{
		// if in milky way already, button is greyed out
		ife show_system SYS_MILKY_WAY rotatespritea gui_pos_x gui_pos_y 20000 0 14686 15 27 0 -255 0 0 xdim ydim else
		rotatespritea gui_pos_x gui_pos_y 20000 0 14686 disp_temp6 disp_temp5 0 -255 0 0 xdim ydim
	}
}
else
{
state CURSOR_OVER_ITEM
ifl gui_pos_x_temp 15
 ifg gui_pos_x_temp -15
  ifl gui_pos_y_temp 7
   ifg gui_pos_y_temp -7
    ifn show_system SYS_LOCAL_CLOUD // not in local star system (furthest zoom)
   { // Show Star system
   rotatespritea gui_pos_x gui_pos_y 20000 0 14687 0 0 0 -255 0 0 xdim ydim

   ife show_system SYS_SOL set mouse_hint 3064 else
   ife show_system SYS_ISHTEG set mouse_hint 3064 else
   ife show_system SYS_USA set mouse_hint 3067 else
   ife show_system SYS_EUROPE set mouse_hint 3067 else
   	set mouse_hint 3063 // refers to quote in user.con
	sub mouse_hint_timer 2

   ifand BITS_PRESS 4 state ZOOM_COM_OUT
   }
	else
	{
	ife show_system SYS_LOCAL_CLOUD rotatespritea gui_pos_x gui_pos_y 20000 0 14686 15 27 0 -255 0 0 xdim ydim else
	rotatespritea gui_pos_x gui_pos_y 20000 0 14686 disp_temp6 disp_temp5 0 -255 0 0 xdim ydim
	}
}

set gui_pos_x 195
set gui_pos_y 10
state CURSOR_OVER_ITEM
ifl gui_pos_x_temp 15
 ifg gui_pos_x_temp -15
  ifl gui_pos_y_temp 7
   ifg gui_pos_y_temp -7
   { // filter button
   rotatespritea gui_pos_x gui_pos_y 20000 0 14719 0 0 0 -255 0 0 xdim ydim

   	set mouse_hint 3066 // refers to quote in user.con
	sub mouse_hint_timer 2

   ifand BITS_PRESS 4
    ifcount 8
		{
		ifand COM_FILTER 512 soundonce INTERFACE_3 else
		soundonce INTERFACE_2
		xorvar COM_FILTER 512
		resetcount
		}
   }
	else
rotatespritea gui_pos_x gui_pos_y 20000 0 14718 0 0 0 -255 0 0 xdim ydim

ife VOLUME 0
 ifand BEAT_EPISODES[1] 1
  ifand BEAT_EPISODES[1] 2
   ifand BEAT_EPISODES[1] 4
    ifand BEAT_EPISODES[1] 16
	 ifand BEAT_EPISODES[1] 32
	   ifand BEAT_EPISODES[1] 128
	 {
	set gui_pos_x 250
	set gui_pos_y 10
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   { // Show debriefing
	   rotatespritea gui_pos_x gui_pos_y 20000 0 14693 0 0 0 -255 0 0 xdim ydim

		set mouse_hint 3065 // refers to quote in user.con
		sub mouse_hint_timer 2

	   ifand BITS_PRESS 4
		ifcount 8
			{
			startlevel 0 17
			resetcount
			}
	   }
		else
	rotatespritea gui_pos_x gui_pos_y 20000 0 14692 0 0 0 -255 0 0 xdim ydim
	}

ife VOLUME 1
 ifand BEAT_EPISODES[2] 1024
	 {
	set gui_pos_x 250
	set gui_pos_y 10
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   { // Show debriefing
	   rotatespritea gui_pos_x gui_pos_y 20000 0 14693 0 0 0 -255 0 0 xdim ydim

		set mouse_hint 3065 // refers to quote in user.con
		sub mouse_hint_timer 2

	   ifand BITS_PRESS 4
		ifcount 8
			{
			startlevel 1 34
			resetcount
			}
	   }
		else
	rotatespritea gui_pos_x gui_pos_y 20000 0 14692 0 0 0 -255 0 0 xdim ydim
	}

ife VOLUME 2
 ifand BEAT_EPISODES[3] 65536
	 {
	set gui_pos_x 250
	set gui_pos_y 10
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 15
	 ifg gui_pos_x_temp -15
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   { // Show debriefing
	   rotatespritea gui_pos_x gui_pos_y 20000 0 14693 0 0 0 -255 0 0 xdim ydim

		set mouse_hint 3065 // refers to quote in user.con
		sub mouse_hint_timer 2

	   ifand BITS_PRESS 4
		ifcount 8
			{
			startlevel 2 49
			resetcount
			}
	   }
		else
	rotatespritea gui_pos_x gui_pos_y 20000 0 14692 0 0 0 -255 0 0 xdim ydim
	}


// ==================================================================================================================
// INFORMATION
// ==================================================================================================================

ifand COM_FILTER 64 // Information
{
rotatesprite 60 100 20000 0 14673 0 0 1 0 0 xdim ydim

rotatesprite 32 66 INVENSIZE 0 14820 0 0 0 0 0 xdim ydim
digitalnumberz 14674 45 66 TECH_LEVEL 30 0 0 0 0 xdim ydim INVENSIZE // black
digitalnumberz 14674 44 66 TECH_LEVEL 0 0 0 0 0 xdim ydim INVENSIZE

rotatesprite 32 78 INVENSIZE 0 14786 0 0 0 0 0 xdim ydim
digitalnumberz 14674 45 78 SUPPLY_LEVEL 30 0 0 0 0 xdim ydim INVENSIZE // black
digitalnumberz 14674 44 78 SUPPLY_LEVEL 0 0 0 0 0 xdim ydim INVENSIZE

rotatesprite 50 78 INVENSIZE 0 14694 0 0 0 0 0 xdim ydim

set max_supply_level 100
ife FACILITIES_OWNED[4] 2 add max_supply_level 100 // China Warehouse?
ifand BEAT_EPISODES[7] 64 add max_supply_level 300 // beat backrooms?

digitalnumberz 14674 59 78 max_supply_level 30 0 0 0 0 xdim ydim INVENSIZE // black
digitalnumberz 14674 58 78 max_supply_level 0 0 0 0 0 xdim ydim INVENSIZE

set disp_temp9 1
    ife FACILITIES_OWNED[0] 2 add disp_temp9 1 // Euro factory 1?
    ife FACILITIES_OWNED[1] 2 add disp_temp9 1 // Africa factory 1?
    ife FACILITIES_OWNED[2] 2 add disp_temp9 2 // Brazil factory 1?
    ife FACILITIES_OWNED[3] 2 add disp_temp9 4 // Lunar factory?
    ife FACILITIES_OWNED[7] 2 add disp_temp9 4 // Io factory?
    ife FACILITIES_OWNED[8] 2 add disp_temp9 3 // Ganymede factory?
	ife FACILITIES_OWNED[13] 2 add disp_temp9 4 // Umbriel factory?

rotatesprite 32 91 INVENSIZE 0 14784 0 0 0 0 0 xdim ydim
rotatesprite 34 93 QUARTERSIZE 0 14786 0 0 0 0 0 xdim ydim
digitalnumberz 14674 45 91 disp_temp9 30 0 0 0 0 xdim ydim INVENSIZE // black
digitalnumberz 14674 44 91 disp_temp9 0 8 0 0 0 xdim ydim INVENSIZE

rotatesprite 32 104 INVENSIZE 0 14821 0 0 0 0 0 xdim ydim
digitalnumberz 14674 45 104 log_budgetinc 30 8 0 0 0 xdim ydim INVENSIZE // black
ifg log_budgetinc 0 set disp_temp8 8 else ifl log_budgetinc 0 set disp_temp8 124 else set disp_temp8 0
digitalnumberz 14674 44 104 log_budgetinc 0 disp_temp8 0 0 0 xdim ydim INVENSIZE

rotatesprite 32 116 INVENSIZE 0 14754 0 0 0 0 0 xdim ydim
digitalnumberz 14674 45 116 log_kills 30 0 0 0 0 xdim ydim INVENSIZE // black
digitalnumberz 14674 44 116 log_kills 0 8 0 0 0 xdim ydim INVENSIZE

rotatesprite 32 129 INVENSIZE 0 14825 0 0 0 0 0 xdim ydim
digitalnumberz 14674 45 129 log_loadout 30 0 0 0 0 xdim ydim INVENSIZE // black
digitalnumberz 14674 44 129 log_loadout 0 124 0 0 0 xdim ydim INVENSIZE

rotatesprite 32 142 INVENSIZE 0 14696 0 0 0 0 0 xdim ydim
digitalnumberz 14674 45 142 log_treasure 30 0 0 0 0 xdim ydim INVENSIZE // black
ifg log_treasure 0 set disp_temp8 8 else set disp_temp8 0
digitalnumberz 14674 44 142 log_treasure 0 disp_temp8 0 0 0 xdim ydim INVENSIZE

}

// ==================================================================================================================
// HELP / Computer tutorial
// ==================================================================================================================

ifand COM_FILTER 128 // Help
{
	// Current info_sel value determines the page to show
	ife INFO_SEL_2 0 rotatespritea 160 100 16000 0 14688 0 0 0 -255 0 0 xdim ydim
	else ife INFO_SEL_2 1 rotatespritea 160 100 16000 0 14710 0 0 0 -255 0 0 xdim ydim
	else ife INFO_SEL_2 2 rotatespritea 160 100 16000 0 14724 0 0 0 -255 0 0 xdim ydim
	else ife INFO_SEL_2 3 rotatespritea 160 100 16000 0 14735 0 0 0 -255 0 0 xdim ydim

	// Scroll through pages, either by using keyboard:

	ifand EXTBITS_PRESS 4 // Left
		ifcount 8
	{
		ife INFO_SEL_2 3 { sound COMP_SELECT set INFO_SEL_2 2 }
		else ife INFO_SEL_2 2 { sound COMP_SELECT set INFO_SEL_2 1 }
		else ife INFO_SEL_2 1 { sound COMP_SELECT set INFO_SEL_2 0 }
		resetcount
	}

	ifand EXTBITS_PRESS 8 // Right
		ifcount 8
	{
		ife INFO_SEL_2 0 { sound COMP_SELECT set INFO_SEL_2 1 }
		else ife INFO_SEL_2 1 { sound COMP_SELECT set INFO_SEL_2 2 }
		else ife INFO_SEL_2 2 { sound COMP_SELECT set INFO_SEL_2 3 }
		resetcount
	}

	// Or by using cursor:
	set gui_pos_x 75
	set gui_pos_y 45
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	    ifg INFO_SEL_2 0 // if on the first page, don't do anything
	{
		// prev button
	   rotatespritea gui_pos_x gui_pos_y 20000 0 14715 0 0 0 -255 0 0 xdim ydim

		ifand BITS_PRESS 4
		  ifcount 8
		{
			sound COMP_SELECT
			ife INFO_SEL_2 3 set INFO_SEL_2 2
			else ife INFO_SEL_2 2 set INFO_SEL_2 1
			else ife INFO_SEL_2 1 set INFO_SEL_2 0
			resetcount
		}
	}
	else ifn INFO_SEL_2 0
	{
		// previous button
		rotatespritea gui_pos_x gui_pos_y 20000 0 14715 disp_pulse 106 0 -255 0 0 xdim ydim
	}


	set gui_pos_x 247
	set gui_pos_y 45
	state CURSOR_OVER_ITEM
	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	    ifl INFO_SEL_2 3 // if on the last page, don't do anything
	{
		// next button
		rotatespritea gui_pos_x gui_pos_y 20000 1024 14715 0 0 4 -255 0 0 xdim ydim

		ifand BITS_PRESS 4
		  ifcount 8
		{
			sound COMP_SELECT
			ife INFO_SEL_2 0 set INFO_SEL_2 1
			else ife INFO_SEL_2 1 set INFO_SEL_2 2
			else ife INFO_SEL_2 2 set INFO_SEL_2 3
			resetcount
		}
	}
	else ifn INFO_SEL_2 3
	{
		// previous button
		rotatespritea gui_pos_x gui_pos_y 20000 1024 14715 disp_pulse 106 4 -255 0 0 xdim ydim
	}

	// If on the last page, show a close button in place of where the next button usually is.
	// At the moment not possible to trigger this via keyboard
	ife INFO_SEL_2 3
	{
		// These values indicate we're hovering over the button, it seems?
		ifl gui_pos_x_temp 7
		 ifg gui_pos_x_temp -7
		  ifl gui_pos_y_temp 7
		   ifg gui_pos_y_temp -7
		{
			rotatespritea gui_pos_x gui_pos_y 20000 1024 14655 0 0 4 -255 0 0 xdim ydim

			ifand BITS_PRESS 4
			  ifcount 8
			{
				sound COMP_SELECT
				// Disable showing this
				xorvar COM_FILTER 128
				resetcount
			}
		}
		else
			rotatespritea gui_pos_x gui_pos_y 20000 1024 14654 0 0 4 -255 0 0 xdim ydim
	}
}

// ==================================================================================================================
// FILTER
// ==================================================================================================================

ifand COM_FILTER 512 // FILTER SCREEN
{
rotatespritea 160 100 26767 0 14657 0 0 0 -255 0 0 xdim ydim


	set gui_pos_x 74
	set gui_pos_y 40
	state CURSOR_OVER_ITEM

	ifand COM_FILTER 1 rotatespritea gui_pos_x gui_pos_y 20000 0 14721 0 0 0 -255 0 0 xdim ydim
	else rotatespritea gui_pos_x gui_pos_y 20000 0 14720 0 0 0 -255 0 0 xdim ydim
	minitext 85 37 3070 0 4
	minitext 84 38 3070 0 0

	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   {
	   ifand BITS_PRESS 4 // Episode 1 missions
		ifcount 4
			{
			xorvar COM_FILTER 1
			soundonce COMP_SELECT
			resetcount
			}
	   }

	ifg VOLUME 0 set disp_temp 1
	else
	 ifand BEAT_EPISODES[1] 128 set disp_temp 1 else set disp_temp 0


	ife disp_temp 1
	{
	set gui_pos_y 55
	state CURSOR_OVER_ITEM

	ifand COM_FILTER 2 rotatespritea gui_pos_x gui_pos_y 20000 0 14721 0 0 0 -255 0 0 xdim ydim
	else rotatespritea gui_pos_x gui_pos_y 20000 0 14720 0 0 0 -255 0 0 xdim ydim
	minitext 85 52 3071 0 4
	minitext 84 53 3071 0 21

	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   {
	   ifand BITS_PRESS 4  // Episode 2 missions
		ifcount 4
			{
			xorvar COM_FILTER 2
			soundonce COMP_SELECT
			resetcount
			}
	   }
	}

	ifg VOLUME 1 set disp_temp 1
	else
	 ifand BEAT_EPISODES[2] 1024 set disp_temp 1 else set disp_temp 0

	ife disp_temp 1
	{
	set gui_pos_y 70
	state CURSOR_OVER_ITEM

	ifand COM_FILTER 4 rotatespritea gui_pos_x gui_pos_y 20000 0 14721 0 0 0 -255 0 0 xdim ydim
	else rotatespritea gui_pos_x gui_pos_y 20000 0 14720 0 0 0 -255 0 0 xdim ydim
	minitext 85 67 3074 0 4
	minitext 84 68 3074 0 11

	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   {
	   ifand BITS_PRESS 4  // Episode 3 missions
		ifcount 4
			{
			xorvar COM_FILTER 4
			soundonce COMP_SELECT
			resetcount
			}
	   }
	}

	ifg VOLUME 2 set disp_temp 1
	else
	 ifand BEAT_EPISODES[3] 1 set disp_temp 1 else set disp_temp 0

   ife disp_temp 1
    {
	set gui_pos_y 85
	state CURSOR_OVER_ITEM

	ifand COM_FILTER 8 rotatespritea gui_pos_x gui_pos_y 20000 0 14721 0 0 0 -255 0 0 xdim ydim
	else rotatespritea gui_pos_x gui_pos_y 20000 0 14720 0 0 0 -255 0 0 xdim ydim
	minitext 85 82 3075 0 4
	minitext 84 83 3075 0 15

	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   {
	   ifand BITS_PRESS 4 // Episode 4 missions
		ifcount 4
			{
			xorvar COM_FILTER 8
			soundonce COMP_SELECT
			resetcount
			}
	   }
	}

	ifg EDF_MISSIONS 0
	{
	set gui_pos_y 130
	state CURSOR_OVER_ITEM

	ifand COM_FILTER 1024 rotatespritea gui_pos_x gui_pos_y 20000 0 14721 0 0 0 -255 0 0 xdim ydim
	else rotatespritea gui_pos_x gui_pos_y 20000 0 14720 0 0 0 -255 0 0 xdim ydim
	minitext 85 127 3078 0 4
	minitext 84 128 3078 0 12

	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   {
	   ifand BITS_PRESS 4 // EDF
		ifcount 4
			{
			xorvar COM_FILTER 1024
			soundonce COMP_SELECT
			resetcount
			}
	   }
	}

	set gui_pos_y 145
	state CURSOR_OVER_ITEM

	ifand COM_FILTER 32 rotatespritea gui_pos_x gui_pos_y 20000 0 14721 0 0 0 -255 0 0 xdim ydim
	else rotatespritea gui_pos_x gui_pos_y 20000 0 14720 0 0 0 -255 0 0 xdim ydim
	minitext 85 143 3072 0 4
	minitext 84 144 3072 0 12

	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   {
	   ifand BITS_PRESS 4 // Facilities
		ifcount 4
			{
			xorvar COM_FILTER 32
			soundonce COMP_SELECT
			resetcount
			}
	   }

	set gui_pos_y 160
	state CURSOR_OVER_ITEM

	ifand COM_FILTER 256 rotatespritea gui_pos_x gui_pos_y 20000 0 14721 0 0 0 -255 0 0 xdim ydim
	else rotatespritea gui_pos_x gui_pos_y 20000 0 14720 0 0 0 -255 0 0 xdim ydim
	minitext 85 159 3073 0 4
	minitext 84 160 3073 0 12

	ifl gui_pos_x_temp 7
	 ifg gui_pos_x_temp -7
	  ifl gui_pos_y_temp 7
	   ifg gui_pos_y_temp -7
	   {
	   ifand BITS_PRESS 4 // Resources
		ifcount 4
			{
			xorvar COM_FILTER 256
			soundonce COMP_SELECT
			resetcount
			}
	   }


}

state command_mission_boxes

// ====================================================================================================================================
// CLOCK - Time is a companion who goes with us on the journey, and reminds us to cherish every moment - because it'll never come again.
// ===================================================================================================================================

                gettimedate disp_temp disp_temp2 disp_temp3 disp_temp4 month disp_temp6 disp_temp7 disp_temp7
                digitalnumber 3087 145 189 disp_temp3 0 33 0 0 0 xdim ydim // Hours
		myospal 149 189 3097 0 0 33
		ifl disp_temp2 10 // Add the extra '0' in front of the number
				{
				myospal 152 189 3087 0 0 33
				digitalnumber 3087 157 189 disp_temp2 0 33 0 0 0 xdim ydim // minutes
				}
				else
			digitalnumber 3087 155 189 disp_temp2 0 33 0 0 0 xdim ydim // minutes
		myospal 159 189 3097 0 0 33
			ifl disp_temp 10 // Add the extra '0' in front of the number
				{
				myospal 162 189 3087 0 0 33
				digitalnumber 3087 166 189 disp_temp 0 33 0 0 0 xdim ydim // seconds
				}
			else
			digitalnumber 3087 165 189 disp_temp 0 33 0 0 0 xdim ydim // seconds

		digitalnumber 3087 176 189 disp_temp4 0 33 0 0 0 xdim ydim // Day
		myospal 180 189 3086 0 0 33
		add month 1 // 0 = january and 11 = december so we need to add 1
		digitalnumber 3087 186 189 month 0 33 0 0 0 xdim ydim // Month
		myospal 190 189 3086 0 0 33
		digitalnumber 3087 202 189 disp_temp6 0 33 0 0 0 xdim ydim // Year

	// ====================================================================================================================================
	// BUDGET
	// ===================================================================================================================================

	digitalnumber 3087 276 189 AMC_BUDGET 0 33 0 0 0 xdim ydim

	// EP1 Training map not done yet. Give popup. Maybe only if episode 1 wasn't beaten yet either. Not sure how to check that.
	ife TUTORIAL_DONE[0] 0
	{
		qputs 7507 It is recommended that first-time players
		qputs 7508 go through the Training map first. Click
		qputs 7509 "Yes" to do that now, or "No" to skip.
		qputs 7510
		qputs 7511
		state showyesnopopup

		ife ui_popup_return 0
		{
			// mark as done as if players played it
			setarray TUTORIAL_DONE[0] 1
			setarray TUTORIAL_DONE[1] 1
			setarray TUTORIAL_DONE[2] 1
			setarray TUTORIAL_DONE[3] 1
			setarray TUTORIAL_DONE[4] 1
			writearraytofile TUTORIAL_DONE F_TUTORIAL_DONE
			// Todo add call for episode 6 as well after ep5 is out and fully patched
		}
		// Start training map level
		else ife ui_popup_return 1
		{
			set MOUSEUP 0
			startlevel 0 26
		}
	}
ends

defstate RES_BUY

ends

defstate FAC_BUY
	writearraytofile FACILITIES_OWNED F_FACILITIES_AMCTC
	soundonce CASHREG
	savegamevar AMC_BUDGET
	set buying_id 0
ends

defstate COMMAND_INTERFACE // The actual gameplay stuff
// 0 = World
ife show_system SYS_SOL { ifsound COMMAND_AMB2 nullop else screensound COMMAND_AMB2 }
else ife show_system SYS_MOON { ifsound COMMAND_AMB3 nullop else screensound COMMAND_AMB3 }
else ife show_system SYS_GANYMEDE { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
else ife show_system SYS_IO { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
else ife show_system SYS_MARS { ifsound COMMAND_AMB5 nullop else screensound COMMAND_AMB5 }
else ife show_system SYS_LOCAL_CLOUD { ifsound COMMAND_AMB6 nullop else screensound COMMAND_AMB6 }
else ife show_system SYS_ISHTEG { ifsound COMMAND_AMB2 nullop else screensound COMMAND_AMB2 }
else ife show_system SYS_XUGLOP { ifsound COMMAND_AMB7 nullop else screensound COMMAND_AMB7 } // Xuglop
else ife show_system SYS_RACTONIA { ifsound COMMAND_AMB5 nullop else screensound COMMAND_AMB5 } // Ractonia
else ife show_system SYS_BOO { ifsound COMMAND_AMB6 nullop else screensound COMMAND_AMB6 }
else ife show_system SYS_UMBRIEL { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
// 16 = USA
// 17 = Europe
else ife show_system SYS_MILKY_WAY { ifsound COMMAND_AMB8 nullop else screensound COMMAND_AMB8 } // milky way
else ife show_system SYS_ELYSION { ifsound COMMAND_AMB6 nullop else screensound COMMAND_AMB6 }
else ife show_system SYS_ABYSS soundonce ENTERDIS
else ife show_system SYS_ELYSION_SURFACE { ifsound COMMAND_AMB7 nullop else screensound COMMAND_AMB7 }
else ife show_system SYS_CERES { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
else ife show_system SYS_HAUMEA { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
else ife show_system SYS_MAKEMAKE { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
else ife show_system SYS_ERIS { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
else ife show_system SYS_VENUS { ifsound COMMAND_AMB4 nullop else screensound COMMAND_AMB4 }
else
	{
	ifg VOLUME 3 { ifsound COMM_AMB_ALT nullop else screensound COMM_AMB_ALT }
	else { ifsound COMMAND_AMB nullop else screensound COMMAND_AMB }
	}

ifn buying_id 0
		{
		ife buying_id 101
			{
			setarray FACILITIES_OWNED[0] 2
			sub AMC_BUDGET 10
			state FAC_BUY
			}

		ife buying_id 102
			{
			setarray FACILITIES_OWNED[1] 2
			sub AMC_BUDGET 5
			state FAC_BUY
			}

		ife buying_id 103
			{
			setarray FACILITIES_OWNED[2] 2
			sub AMC_BUDGET 20
			state FAC_BUY
			}

		ife buying_id 104
			{
			setarray FACILITIES_OWNED[3] 2
			sub AMC_BUDGET 40
			state FAC_BUY
			}

		ife buying_id 105
			{
			setarray FACILITIES_OWNED[4] 2
			sub AMC_BUDGET 10
			state FAC_BUY
			}

		// EARTH SATELLITE

		ife buying_id 106
			{
			setarray FACILITIES_OWNED[5] 2
			sub AMC_BUDGET 25
			state FAC_BUY
			}

		// JUPITER SATELLITE

		ife buying_id 107
			{
			setarray FACILITIES_OWNED[6] 2
			sub AMC_BUDGET 50
			state FAC_BUY
			}

		// Io factory

		ife buying_id 108
			{
			setarray FACILITIES_OWNED[7] 2
			sub AMC_BUDGET 40
			state FAC_BUY
			}

		// Ganymede factory

		ife buying_id 109
			{
			setarray FACILITIES_OWNED[8] 2
			sub AMC_BUDGET 30
			state FAC_BUY
			}

		ife buying_id 110 // Europe/Africa airport
			{
			setarray FACILITIES_OWNED[14] 2
			writearraytofile FACILITIES_OWNED F_FACILITIES_AMCTC
			sub AMC_BUDGET 10
			sub SUPPLY_LEVEL 5
			soundonce CASHREG
			savegamevar SUPPLY_LEVEL
			savegamevar AMC_BUDGET
			set buying_id 0
			}

		ife buying_id 111 // Americas airport
			{
			setarray FACILITIES_OWNED[10] 2
			writearraytofile FACILITIES_OWNED F_FACILITIES_AMCTC
			sub AMC_BUDGET 10
			sub SUPPLY_LEVEL 5
			soundonce CASHREG
			savegamevar SUPPLY_LEVEL
			savegamevar AMC_BUDGET
			set buying_id 0
			}

		ife buying_id 112
			{
			setarray FACILITIES_OWNED[11] 2
			writearraytofile FACILITIES_OWNED F_FACILITIES_AMCTC
			sub AMC_BUDGET 5
			sub SUPPLY_LEVEL 20
			soundonce CASHREG
			savegamevar SUPPLY_LEVEL
			savegamevar AMC_BUDGET
			set buying_id 0
			}

		ife buying_id 113
			{
			setarray FACILITIES_OWNED[12] 2
			writearraytofile FACILITIES_OWNED F_FACILITIES_AMCTC
			sub AMC_BUDGET 20
			sub SUPPLY_LEVEL 20
			soundonce CASHREG
			savegamevar SUPPLY_LEVEL
			savegamevar AMC_BUDGET
			set buying_id 0
			}

		ife buying_id 114 // Umbriel factory
			{
			setarray FACILITIES_OWNED[13] 2
			sub AMC_BUDGET 40
			state FAC_BUY
			}

		}

ends
