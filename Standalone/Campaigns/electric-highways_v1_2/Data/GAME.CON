
include DEFS.CON
include USER.CON
include SCREEN.CON


setgamename Electric Highways

action ZERO 0 0 0 0 0
action ZERO2 0 0 0 0 0
action ZERO3 0 0 0 0 2
action ZERO4 0 0 0 0 1
action ZERO5 0 0 0 0 2
action ZERO6 0 0 0 0 2
action ZERO7 0 0 0 0 2

move MOVEZERO 0

spritenoshade JIBS1
spritenoshade 5010
spritenoshade 5498
spritenoshade 5500
spritenoshade 5502
spritenoshade 5503
spritenoshade 5507
spritenoshade 5510
spritenoshade 5561
spritenoshade 5039
spritenoshade 3836
spritenoshade 3837
spritenoshade 3841
spritenoshade 199
spritenopal 199
spritenopal 5473
spritenopal 5239
spritenopal 5416


definecheat 0 bb743
definecheat 1 dd536
definecheat 2 cc7457
definecheat 4 dhtyuuioeo;kljs
definecheat 6 hdfyuyqpppcbb,skju
definecheat 7 dkshfl;agfnyu
definecheat 8 srigskjhfgeyiiiii
definecheat 10 bnvsarewq446tf7]
definecheat 13 leugddq;dkjhv
definecheat 17 p]gskfjrytw76ewju
definecheat 18 t55kfghtgghd
definecheat 19 hguq4wwjgydoi
definecheat 20 ]aldjueysjjhfgftr
definecheat 21 aa
definecheat 22 nm,.lkahg][[0
definecheat 23 bn,jfspqt,nshm 

state lookatplayer
        getplayer[THISACTOR].posx mx
        getplayer[THISACTOR].posy my
        getactor[THISACTOR].x x
        getactor[THISACTOR].y y
        subvarvar mx x
        subvarvar my y
        getangle ANGVAR mx my
        setactor[THISACTOR].ang ANGVAR
ends

state shadestate 
addvar SHADEME 1 
ifvarg SHADEME 1 setactor[THISACTOR].shade 0
ifvarg SHADEME 2 setactor[THISACTOR].shade 1
ifvarg SHADEME 3 setactor[THISACTOR].shade 2
ifvarg SHADEME 4 setactor[THISACTOR].shade 3
ifvarg SHADEME 5 setactor[THISACTOR].shade 4
ifvarg SHADEME 6 setactor[THISACTOR].shade 5
ifvarg SHADEME 7 setactor[THISACTOR].shade 6
ifvarg SHADEME 8 setactor[THISACTOR].shade 7
ifvarg SHADEME 9 setactor[THISACTOR].shade 8
ifvarg SHADEME 10 setactor[THISACTOR].shade 9
ifvarg SHADEME 11 setactor[THISACTOR].shade 10
ifvarg SHADEME 12 setactor[THISACTOR].shade 11
ifvarg SHADEME 13 setactor[THISACTOR].shade 12
ifvarg SHADEME 14 setactor[THISACTOR].shade 13
ifvarg SHADEME 15 setactor[THISACTOR].shade 14
ifvarg SHADEME 16 setactor[THISACTOR].shade 15
ifvarg SHADEME 17 setactor[THISACTOR].shade 16
ifvarg SHADEME 18 setactor[THISACTOR].shade 15
ifvarg SHADEME 19 setactor[THISACTOR].shade 14
ifvarg SHADEME 20 setactor[THISACTOR].shade 13
ifvarg SHADEME 21 setactor[THISACTOR].shade 12
ifvarg SHADEME 22 setactor[THISACTOR].shade 11
ifvarg SHADEME 23 setactor[THISACTOR].shade 10
ifvarg SHADEME 24 setactor[THISACTOR].shade 9
ifvarg SHADEME 25 setactor[THISACTOR].shade 8
ifvarg SHADEME 26 setactor[THISACTOR].shade 7
ifvarg SHADEME 27 setactor[THISACTOR].shade 6
ifvarg SHADEME 28 setactor[THISACTOR].shade 5
ifvarg SHADEME 29 setactor[THISACTOR].shade 4
ifvarg SHADEME 30 setactor[THISACTOR].shade 3
ifvarg SHADEME 31 setactor[THISACTOR].shade 2
ifvarg SHADEME 32 setvar SHADEME 1
ends

actor 3839 
state shadestate 
enda

state shadefloor
addvar SHADEME 1 
ifvarg SHADEME 1 setsector[THISACTOR].visibility 18
ifvarg SHADEME 2 setsector[THISACTOR].visibility 20
ifvarg SHADEME 3 setsector[THISACTOR].visibility 22
ifvarg SHADEME 4 setsector[THISACTOR].visibility 24
ifvarg SHADEME 5 setsector[THISACTOR].visibility 26
ifvarg SHADEME 6 setsector[THISACTOR].visibility 28
ifvarg SHADEME 7 setsector[THISACTOR].visibility 30
ifvarg SHADEME 8 setsector[THISACTOR].visibility 32
ifvarg SHADEME 9 setsector[THISACTOR].visibility 34
ifvarg SHADEME 10 setsector[THISACTOR].visibility 36
ifvarg SHADEME 11 setsector[THISACTOR].visibility 38
ifvarg SHADEME 12 setsector[THISACTOR].visibility 40
ifvarg SHADEME 13 setsector[THISACTOR].visibility 42
ifvarg SHADEME 14 setsector[THISACTOR].visibility 44
ifvarg SHADEME 15 setsector[THISACTOR].visibility 46
ifvarg SHADEME 16 setsector[THISACTOR].visibility 48
ifvarg SHADEME 17 setsector[THISACTOR].visibility 50
ifvarg SHADEME 18 setsector[THISACTOR].visibility 48
ifvarg SHADEME 19 setsector[THISACTOR].visibility 46
ifvarg SHADEME 20 setsector[THISACTOR].visibility 44
ifvarg SHADEME 21 setsector[THISACTOR].visibility 42
ifvarg SHADEME 22 setsector[THISACTOR].visibility 40
ifvarg SHADEME 23 setsector[THISACTOR].visibility 38
ifvarg SHADEME 24 setsector[THISACTOR].visibility 36
ifvarg SHADEME 25 setsector[THISACTOR].visibility 34
ifvarg SHADEME 26 setsector[THISACTOR].visibility 32
ifvarg SHADEME 27 setsector[THISACTOR].visibility 30
ifvarg SHADEME 28 setsector[THISACTOR].visibility 28
ifvarg SHADEME 29 setsector[THISACTOR].visibility 26
ifvarg SHADEME 30 setsector[THISACTOR].visibility 24
ifvarg SHADEME 31 setsector[THISACTOR].visibility 22
ifvarg SHADEME 32 setsector[THISACTOR].visibility 20
ifvarg SHADEME 33 setsector[THISACTOR].visibility 18
ifvarg SHADEME 34 setsector[THISACTOR].visibility 16
ifvarg SHADEME 35 setvar SHADEME 1
ends

state shadewall 
addvar SHADEME 1 
ifvarg SHADEME 1 setwall[hitwall].shade 0
ifvarg SHADEME 2 setwall[hitwall].shade 1
ifvarg SHADEME 3 setwall[hitwall].shade 2
ifvarg SHADEME 4 setwall[hitwall].shade 3
ifvarg SHADEME 5 setwall[hitwall].shade 4
ifvarg SHADEME 6 setwall[hitwall].shade 5
ifvarg SHADEME 7 setwall[hitwall].shade 6
ifvarg SHADEME 8 setwall[hitwall].shade 7
ifvarg SHADEME 9 setwall[hitwall].shade 8
ifvarg SHADEME 10 setwall[hitwall].shade 9
ifvarg SHADEME 11 setwall[hitwall].shade 10
ifvarg SHADEME 12 setwall[hitwall].shade 11
ifvarg SHADEME 13 setwall[hitwall].shade 12
ifvarg SHADEME 14 setwall[hitwall].shade 13
ifvarg SHADEME 15 setwall[hitwall].shade 14
ifvarg SHADEME 16 setwall[hitwall].shade 15
ifvarg SHADEME 17 setwall[hitwall].shade 16
ifvarg SHADEME 18 setwall[hitwall].shade 15
ifvarg SHADEME 19 setwall[hitwall].shade 14
ifvarg SHADEME 20 setwall[hitwall].shade 13
ifvarg SHADEME 21 setwall[hitwall].shade 12
ifvarg SHADEME 22 setwall[hitwall].shade 11
ifvarg SHADEME 23 setwall[hitwall].shade 10
ifvarg SHADEME 24 setwall[hitwall].shade 9
ifvarg SHADEME 25 setwall[hitwall].shade 8
ifvarg SHADEME 26 setwall[hitwall].shade 7
ifvarg SHADEME 27 setwall[hitwall].shade 6
ifvarg SHADEME 28 setwall[hitwall].shade 5
ifvarg SHADEME 29 setwall[hitwall].shade 4
ifvarg SHADEME 30 setwall[hitwall].shade 3
ifvarg SHADEME 31 setwall[hitwall].shade 2
ifvarg SHADEME 32 setvar SHADEME 1
ends

state controlplayer

getactor[THISACTOR].x CUTSCENE_TEMP
setplayer[THISACTOR].posx CUTSCENE_TEMP

getactor[THISACTOR].y CUTSCENE_TEMP
setplayer[THISACTOR].posy CUTSCENE_TEMP

getactor[THISACTOR].sectnum CUTSCENE_TEMP
setplayer[THISACTOR].cursectnum CUTSCENE_TEMP

setvar CUTSCENE_TEMP 1
setplayer[THISACTOR].on_ground CUTSCENE_TEMP

getactor[THISACTOR].z z
addvar z -8192
setplayer[THISACTOR].posz z

getactor[THISACTOR].ang CUTSCENE_TEMP
setplayer[THISACTOR].ang CUTSCENE_TEMP

ends

actor KNEE KNEE_WEAPON_STRENGTH enda
actor SPIT SPIT_WEAPON_STRENGTH enda
actor CHAINGUN CHAINGUN_WEAPON_STRENGTH enda
actor SHOTGUN SHOTGUN_WEAPON_STRENGTH enda
actor FIRELASER FIRELASER_WEAPON_STRENGTH enda
actor HEAVYHBOMB HANDBOMB_WEAPON_STRENGTH enda
actor BOUNCEMINE BOUNCEMINE_WEAPON_STRENGTH enda
actor MORTER MORTER_WEAPON_STRENGTH enda
actor SHRINKSPARK SHRINKER_WEAPON_STRENGTH enda
actor GROWSPARK GROWSPARK_WEAPON_STRENGTH enda
actor RPG RPG_WEAPON_STRENGTH enda
actor FREEZEBLAST FREEZETHROWER_WEAPON_STRENGTH enda
actor DEVISTATORBLAST FREEZETHROWER_WEAPON_STRENGTH enda
actor COOLEXPLOSION1 COOL_EXPLOSION_STRENGTH enda
actor TRIPBOMB TRIPBOMB_STRENGTH enda
actor SHOTSPARK1 killit enda

actor SMALLSMOKE ifspawnedby KNEE { spawn EFFECT2 globalsound SOUND6 } killit enda

actor APLAYER
getplayer[THISACTOR].posz playerz
getsector[THISACTOR].ceilingz sectorz

subvarvar playerz sectorz

ifvarl playerz 2600
{ 
getplayer[THISACTOR].posz mz
addvar mz 800
setplayer[THISACTOR].posz mz
}

ifvare ATTACK_VAR 1 { shoot KNEE  setvar ATTACK_VAR 0 }

ifvare PRESS_VAR 1 ifhitspace { } else setvar PRESS_VAR 0
iffloordistl 2 { ifonwater { } else setplayer[THISACTOR].poszv 128 }
setplayer[THISACTOR].hard_landing 0
setplayer[THISACTOR].falling_counter 0
setuserdef[THISACTOR].clipping 0
setplayer[THISACTOR].knuckle_incs 0
setplayer[THISACTOR].over_shoulder_on 0
getactor[THISACTOR].htextra TEMP
ifvarg TEMP 0 { setactor[THISACTOR].htextra -1 }
setactor[THISACTOR].mdflags 16
ifvare STOPPLAYER 1 setplayer[THISACTOR].movement_lock 15
else setplayer[THISACTOR].movement_lock 0
ifvarg TEXTBRIGHTNESS3 0 subvar TEXTBRIGHTNESS3 1
ifvarg TEXT2BRIGHTNESS1 0 subvar TEXT2BRIGHTNESS1 2
ifvarg TEXT2BRIGHTNESS2 0 subvar TEXT2BRIGHTNESS2 2

getuserdef[THISACTOR].esc_key ESC_VAR
ifvare ESC_VAR 1 ifvare MENU_SPAWN 0 ifvare INTRO_VAR 0 ifvare TEXTVAR 0 ifvare MENU_VAR 0 ifvare STOPPLAYER 0 { globalsound SOUND25 setvar STOPPLAYER 1 setvar TEXTBRIGHTNESS 20 setvar TEXTBRIGHTNESS2 20 setvar PRESS_VAR 1 spawn MENU_SPRITE setvar MENU_SCREEN 2 setvar MENU_VAR 1 }

/*
ifvarg RUNNING 0 { 
setplayer[THISACTOR].runspeed 49500
subvar RUNNING 1 }
else 
*/

setplayer[THISACTOR].runspeed 48450

getplayer[THISACTOR].jumping_counter jump_temp
ifvare jump_temp 721 { setplayer[THISACTOR].jumping_counter 0 }

enda

action AMENU_SPRITE1 0 0 0 0 2
action AMENU_SPRITE2 0 0 0 0 2
action AMENU_SPRITE3 0 0 0 0 2
action AMENU_SPRITE4 0 0 0 0 2
action AMENU_SPRITE5 0 0 0 0 2
action AMENU_SPRITE6 0 0 0 0 2

action AMENU_SPRITE_EDUKE32CREDITS1 0 0 0 0 2
action AMENU_SPRITE_EDUKE32CREDITS2 0 0 0 0 2
actor MENU_SPRITE cstat 32768 sleeptime -1
getuserdef[THISACTOR].esc_key ESC_VAR

ifaction 0 { ifvare ESC_VAR 1 { } else action AMENU_SPRITE1 }

ifaction AMENU_SPRITE1 { 

setvar MENU_SPAWN 1


//continue
ifvarg mousex 7143424 ifvarg mousey 1867776 ifvarl mousex 13598720 ifvarl mousey 2752512 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 0
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
globalsound SOUND9
setvar PRESS_VAR 1 setvar MENU_SPAWN 0 setvar MENU_SCREEN 0 setvar MENU_VAR 0 setvar STOPPLAYER 0 killit
} 
}

else

//load game
ifvarg mousex 6815744 ifvarg mousey 3866624 ifvarl mousex 13959168 ifvarl mousey 4685824 ifvare SAVEDGAME_VAR 1 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 0 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
cmenu 1000 setplayer[THISACTOR].gm 1
} 
}

else

//invert aim
ifvarg mousex 5373952 ifvarg mousey 5832704 ifvarl mousex 15400960 ifvarl mousey 6651904 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 0 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
setvar PRESS_VAR 1 globalsound SOUND9 
ifvare INVERTION 0 setvar INVERTION 1 else
ifvare INVERTION 1 setvar INVERTION 0
savegamevar INVERTION
} 
}

else

//eduke 32 credits
ifvarg mousex 4096000 ifvarg mousey 7831552 ifvarl mousex 15990784 ifvarl mousey 8650752 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 0
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
globalsound SOUND9 setvar PRESS_VAR 1
setvar MENU_SCREEN 4 action AMENU_SPRITE_EDUKE32CREDITS1
} 
}

else

//quit
ifvarg mousex 8683520 ifvarg mousey 9732096 ifvarl mousex 11960320 ifvarl mousey 10616832 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 0 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
quitgame
} 
}

else

{ setvar COUNTER 0 setvar PRESS_VAR 1 
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

}


ifvare ESC_VAR 1 { globalsound SOUND25 setvar STOPPLAYER 0 setvar MENU_SCREEN 0 setvar MENU_VAR 0 action AMENU_SPRITE2 }

}

ifaction AMENU_SPRITE2 { ifvare ESC_VAR 1 { } else { setvar MENU_SPAWN 0 killit } }


ifaction AMENU_SPRITE_EDUKE32CREDITS1 {
ifvare ESC_VAR 1 { globalsound SOUND25 setvar STOPPLAYER 0 setvar MENU_SCREEN 0 setvar MENU_VAR 0 action AMENU_SPRITE2 }
ifvare PRESS_VAR 0 ifhitspace { globalsound SOUND9 setvar PRESS_VAR 1 setvar MENU_SCREEN 5 action AMENU_SPRITE_EDUKE32CREDITS2 }
}

ifaction AMENU_SPRITE_EDUKE32CREDITS2 {
ifvare ESC_VAR 1 { globalsound SOUND25 setvar STOPPLAYER 0 setvar MENU_SCREEN 0 setvar MENU_VAR 0 action AMENU_SPRITE2 }
ifvare PRESS_VAR 0 ifhitspace { setvar TEXTBRIGHTNESS5 20 setvar TEXTBRIGHTNESS4 20 setvar TEXTBRIGHTNESS33 20 setvar TEXTBRIGHTNESS2 20  setvar TEXTBRIGHTNESS 20 setvar TEXTVAR 0 setvar PRESS_VAR 1 setvar MENU_SCREEN 2 action AMENU_SPRITE1 }
}
enda

onevent EVENT_DISPLAYMENU
endevent

onevent EVENT_MOVEFORWARD
setvar RETURN -1 
endevent

onevent EVENT_MOVEBACKWARD
setvar RETURN -1 
endevent

onevent EVENT_STRAFERIGHT
setvar RETURN -1 
endevent

onevent EVENT_STRAFELEFT
setvar RETURN -1 
endevent

onevent EVENT_CROUCH
setvar RETURN -1
endevent

onevent EVENT_JUMP 
ifvare STOPPLAYER 1 setvar RETURN -1 else globalsound SOUND35
endevent

onevent EVENT_LOOKUP
//setvar RUNNING 2
setvar RETURN -1
endevent

onevent EVENT_QUICKKICK
setvar RETURN -1
endevent

onevent EVENT_AIMUP
ifvare MENU_VAR 1 {
setvar RETURN -1
addvar mousey -450000
}
endevent

onevent EVENT_AIMDOWN
ifvare MENU_VAR 1 {
setvar RETURN -1
addvar mousey 450000
}
endevent

onevent EVENT_DISPLAYSBAR setuserdef[THISACTOR].screen_size 0 setvar RETURN 1 endevent

state skybox_working
ifvare COUNTER 1 {

getactor[THISACTOR].x skybox_x
	getactor[THISACTOR].y skybox_y
	getactor[THISACTOR].z skybox_z
	updatesectorz skybox_x skybox_y skybox_z skybox_sect
	ifvare skybox_sect -1 setvar skybox 0

}
ends

actor SKYBOX_SPRITE cstat 32768 sleeptime -1

getactor[THISACTOR].extra EXTRASAVED
getactor[THISACTOR].hitag HITAGSAVED
getactor[THISACTOR].lotag LOTAGSAVED


ifvare COUNTER 0 {
//ifspritepal 0 setvar skybox 1 else
//ifspritepal 1 
	//{
 {
	ifvare HITAGSAVED 0 setvar skybox_scale 64 else
	setvarvar skybox_scale HITAGSAVED
	setvar skybox 2 }

	//}
setvar COUNTER 1
}

ifvare SKYBOX_VAR 10 setvar skybox 1

ifspritepal 1 ifvare SKYBOX_VAR 1 state skybox_working
ifspritepal 2 ifvare SKYBOX_VAR 2 state skybox_working
ifspritepal 3 ifvare SKYBOX_VAR 3 state skybox_working
ifspritepal 4 ifvare SKYBOX_VAR 4 state skybox_working
ifspritepal 5 ifvare SKYBOX_VAR 5 state skybox_working
ifspritepal 6 ifvare SKYBOX_VAR 6 state skybox_working
ifspritepal 7 ifvare SKYBOX_VAR 7 state skybox_working
ifspritepal 8 ifvare SKYBOX_VAR 8 state skybox_working
ifspritepal 9 ifvare SKYBOX_VAR 9 state skybox_working
ifspritepal 10 ifvare SKYBOX_VAR 10 state skybox_working
ifspritepal 11 ifvare SKYBOX_VAR 11 state skybox_working



	setvar TEMP_SKYBOX2 0
	whilevarvarn TEMP_SKYBOX2 numsectors
	{
	// CHECK FLOORS

		getsector[TEMP_SKYBOX2].floorpicnum TEMP_SKYBOX1 
		ifvare TEMP_SKYBOX1 4920
		{
		 setsector[TEMP_SKYBOX2].floorpicnum 4934
		}
	// CHECK CEILINGS

		getsector[TEMP_SKYBOX2].ceilingpicnum TEMP_SKYBOX1 
		ifvare TEMP_SKYBOX1 4920
		{
		 setsector[TEMP_SKYBOX2].ceilingpicnum 4934
		}
	  addvar TEMP_SKYBOX2 1
	}

	setvar TEMP_SKYBOX3 0
	whilevarvarn TEMP_SKYBOX3 NUMWALLS
	{
	// CHECK WALLS
		getwall[TEMP_SKYBOX3].picnum TEMP_SKYBOX1 
		ifvare TEMP_SKYBOX1 4920
		{
		 setwall[TEMP_SKYBOX3].picnum 4934
		}
	addvar TEMP_SKYBOX3 1
	}


enda

onevent EVENT_DISPLAYROOMS


ifvare INVERTION 1 {
setuserdef[THISACTOR].mouseflip 0
}
else { 
setuserdef[THISACTOR].mouseflip 1
}




// setaspect 90000 65536 

ifvarg camerahoriz 270 setvar camerahoriz 270
ifvarl camerahoriz -70 setvar camerahoriz -70 

subvar cameraz 1600

ifvarg SKYBOX_VAR 0 {
ifvarg skybox 0 
{
//getplayer[THISACTOR].horiz skybox_horiz
//getplayer[THISACTOR].horizoff TEMP
//addvarvar skybox_horiz TEMP
//getplayer[THISACTOR].ang skybox_angle

setvarvar skybox_horiz camerahoriz
setvarvar skybox_angle cameraang

ifvare skybox 1
{
setvarvar TEMP2 skybox_z
setvarvar TEMP3 skybox_x
setvarvar TEMP4 skybox_y
}
else
{
  getplayer[THISACTOR].posx TEMP3
  getplayer[THISACTOR].posy TEMP4
  getplayer[THISACTOR].posz TEMP2
  divvarvar TEMP2 skybox_scale // Z scale 
  addvarvar TEMP2 skybox_z 

  divvarvar TEMP3 skybox_scale // X scale

  divvarvar TEMP4 skybox_scale // Y scale

  addvarvar TEMP3 skybox_x 
  addvarvar TEMP4 skybox_y 
  }

ifvarn skybox_sect -1 showviewunbiased TEMP3 TEMP4 TEMP2 skybox_angle skybox_horiz skybox_sect 0 0 319 199 
}
}


ifvarn camerasprite -1 ifvare INTRO_VAR 2
{
getactor[camerasprite].x camerax
getactor[camerasprite].y cameray
getactor[camerasprite].z cameraz
getactor[camerasprite].ang cameraang
setactor[camerasprite].extra 80
getactor[camerasprite].extra camerahoriz
getactor[camerasprite].sectnum camerasect
}

ifvarn camerasprite -1 ifvare INTRO_VAR 3
{
getactor[camerasprite].x camerax
getactor[camerasprite].y cameray
getactor[camerasprite].z cameraz
getactor[camerasprite].ang cameraang
setactor[camerasprite].extra 80
getactor[camerasprite].extra camerahoriz
getactor[camerasprite].sectnum camerasect
}

ifvarn camerasprite -1 ifvare INTRO_VAR 5
{
getactor[camerasprite].x camerax
getactor[camerasprite].y cameray
getactor[camerasprite].z cameraz
getactor[camerasprite].ang cameraang
setactor[camerasprite].extra 100
getactor[camerasprite].extra camerahoriz
getactor[camerasprite].sectnum camerasect
}


ifvarn camerasprite -1 ifvare INTRO_VAR 8
{
getactor[camerasprite].x camerax
getactor[camerasprite].y cameray
getactor[camerasprite].z cameraz
getactor[camerasprite].ang cameraang
setactor[camerasprite].extra 130
getactor[camerasprite].extra camerahoriz
getactor[camerasprite].sectnum camerasect
}


endevent

actor CAMERA_SPRITE cstat 32768 sleeptime -1

ifspritepal 1 ifvare INTRO_VAR 2 {
setvarvar camerasprite THISACTOR
}

ifspritepal 1 ifvare INTRO_VAR 3 {
setvarvar camerasprite THISACTOR
}

ifspritepal 2 ifvare INTRO_VAR 8 {
setvarvar camerasprite THISACTOR
}

ifspritepal 3 ifvare INTRO_VAR 5 {
setvarvar camerasprite THISACTOR
}



enda

actor STUFF_SPRITE cstat 32768 sleeptime -1
getactor[THISACTOR].extra EXTRASAVED
getactor[THISACTOR].hitag HITAGSAVED
getactor[THISACTOR].lotag LOTAGSAVED

ifspritepal 1 ifcansee {
setvarvar SKYBOX_VAR HITAGSAVED
}


ifspritepal 2 {
ifvare VIRTUALVAR 1 { setsector[THISACTOR].floorpal 0 setsector[THISACTOR].ceilingpal 0 }
ifvare VIRTUALVAR 2 { setsector[THISACTOR].floorpal 11 setsector[THISACTOR].ceilingpal 11 }
ifvare VIRTUALVAR 3 { setsector[THISACTOR].floorpal 12 setsector[THISACTOR].ceilingpal 12 }
ifvare VIRTUALVAR 4 { setsector[THISACTOR].floorpal 15 setsector[THISACTOR].ceilingpal 15 }
ifvare VIRTUALVAR 5 { setsector[THISACTOR].floorpal 18 setsector[THISACTOR].ceilingpal 18 }
ifvare VIRTUALVAR 6 { setsector[THISACTOR].floorpal 21 setsector[THISACTOR].ceilingpal 21 }
ifvare VIRTUALVAR 7 { setsector[THISACTOR].floorpal 22 setsector[THISACTOR].ceilingpal 22 }
ifvare VIRTUALVAR 8 { setsector[THISACTOR].floorpal 23 setsector[THISACTOR].ceilingpal 23 }
ifvare VIRTUALVAR 9 { setsector[THISACTOR].floorpal 10 setsector[THISACTOR].ceilingpal 10 }
ifvare VIRTUALVAR 10 { setsector[THISACTOR].floorpal 17 setsector[THISACTOR].ceilingpal 17 }
}

ifspritepal 3 state shadefloor

ifspritepal 4 { 
addvar COUNTER 1
ifvarg COUNTER 140 {
setvar COUNTER 0
operateactivators HITAGSAVED myconnectindex
}

}

ifspritepal 5 { ifcount 80 ifrnd 16 { spawn LIGHT_SPRITE resetcount } }

ifspritepal 6 { }

ifspritepal 7 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { globalsound SOUND31 palfrom 60 63 63 63 setvarvar PORTAL_VAR HITAGSAVED }
}

ifspritepal 8 {
ifvarvare PORTAL_VAR HITAGSAVED { setvar PORTAL_VAR 0 state controlplayer } 
}

ifspritepal 9 {
ifvare STUFF_VAR 1 ifaction 0 { 
setsector[THISACTOR].floorpicnum 2921
setvar STUFF_VAR 0 action ZERO }
}


ifaction ZERO {
getsector[THISACTOR].floorz mz
subvar mz 512
setsector[THISACTOR].floorz mz
ifvarl mz -4096 { setsector[THISACTOR].floorz -4096 killit  }
}



ifspritepal 10 ifaction 0 {
ifvare HITAGSAVED 1 ifvare ELEVATOR_VAR 1 action ZERO2
ifvare HITAGSAVED 2 ifvare ELEVATOR_VAR 2 action ZERO2
ifvare HITAGSAVED 3 ifvare ELEVATOR_VAR 3 action ZERO2
}

ifaction ZERO2 { 

getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 {

getplayer[THISACTOR].posz mz
getactor[THISACTOR].z z
ifvarvarl z mz {
getplayer[THISACTOR].posz TEMP
addvar TEMP -180
setplayer[THISACTOR].posz TEMP


getplayer[THISACTOR].Poszv TEMP
setvar TEMP -1400
setplayer[THISACTOR].Poszv TEMP }

}

ifactioncount 20 {
ifvare HITAGSAVED 1 ifvare ELEVATOR_VAR 1 setvar ELEVATOR_VAR 0
ifvare HITAGSAVED 2 ifvare ELEVATOR_VAR 2 setvar ELEVATOR_VAR 0
ifvare HITAGSAVED 3 ifvare ELEVATOR_VAR 3 setvar ELEVATOR_VAR 0
}

}


ifspritepal 11 ifaction 0 {

ifvare HITAGSAVED 1 ifvare ELEVATOR_VAR 1 action ZERO3
ifvare HITAGSAVED 2 ifvare ELEVATOR_VAR 2 action ZERO3
ifvare HITAGSAVED 3 ifvare ELEVATOR_VAR 3 action ZERO3
}

ifaction ZERO3 { ifactioncount 10 ifrnd 8 {  spawn ELEVATOREFFECT resetactioncount } }


ifspritepal 12 { ifcount 50 ifrnd 10 { spawn DRIP_SPRITE resetcount } }

ifspritepal 13 ifvarg VIRTUALVAR 2 ifvarl VIRTUALVAR 5 { ifcount 70 ifrnd 8 { spawn EFFECT3 resetcount } }

ifspritepal 14 {
move MOVEZERO randomangle
ifrnd 5 { ifpdistl 9600 ifcansee sound SOUND40 spawn SPARK_SPRITE spawn SPARK_SPRITE spawn SPARK_SPRITE }
}


ifspritepal 15 ifvare STUFF_VAR 2 ifaction 0 action ZERO4 

ifaction ZERO4 { 
ifvare HITAGSAVED 1 ifactioncount 3 { setsector[THISACTOR].visibility 240 action ZERO5 }
ifvare HITAGSAVED 2 ifactioncount 6 { setsector[THISACTOR].visibility 240 action ZERO5 }
ifvare HITAGSAVED 3 ifactioncount 9 { setsector[THISACTOR].visibility 240 action ZERO5 }
ifvare HITAGSAVED 4 ifactioncount 12  { setsector[THISACTOR].visibility 240 action ZERO5 }
ifvare HITAGSAVED 5 ifactioncount 15 { setsector[THISACTOR].visibility 240 action ZERO5 }
ifvare HITAGSAVED 6 ifactioncount 18 { setsector[THISACTOR].visibility 240 action ZERO5 }
}


ifaction ZERO5 ifactioncount 2 { setsector[THISACTOR].visibility 60 setvar STUFF_VAR 0 killit }

ifspritepal 16 ifcount 8 { spawn BIGSMOKE_SPRITE resetcount }

ifspritepal 17 { 

ifvare STUFF_VAR 0 ifvare COUNTER 0 setsector[THISACTOR].floorpicnum 3597

ifvare STUFF_VAR 3 { setsector[THISACTOR].floorpicnum 5000
addvar COUNTER 1 ifvarg COUNTER 20 { setvar STUFF_VAR 0 killit }
}

}

ifspritepal 18 ifvare VIRTUALVAR 6 { ifcount 22 ifrnd 18 { spawn LASERDRIP_SPRITE resetcount } }

ifspritepal 19 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { palfrom 0 0 }
}

ifspritepal 20 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { palfrom 20 63 63 63 }
}

ifspritepal 21 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { palfrom 40 63 63 63 }
}


ifspritepal 22 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { palfrom 60 63 63 63 }
}



ifspritepal 23 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { palfrom 15 64 0 64 }
}

ifspritepal 24 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { palfrom 30 64 0 64 }
}


ifspritepal 25 {
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 { palfrom 45 64 0 64 }
}

ifspritepal 26 { 
ifcansee setvar COUNTER 1
ifvare COUNTER 1 ifcount 18 { spawn BLUESMOKE_SPRITE resetcount } }

ifspritepal 27 { ifcount 80 ifrnd 16 { spawn BALL_SPRITE resetcount } }

ifspritepal 28 { ifvare VIRTUALVAR 3 ifvare COUNTER 0 { setvar COUNTER 1 }
ifvarg COUNTER 0 addvar COUNTER 1
ifvarg COUNTER 25 { operateactivators 55 myconnectindex globalsound SOUND56 quake 15 killit } 
}

ifspritepal 29 { fall
move MOVEZERO randomangle
ifvare VIRTUALVAR 3 ifvare COUNTER 0 { 
setsector[THISACTOR].floorpicnum 2921
getsector[THISACTOR].floorz mz
addvar mz 2048
setsector[THISACTOR].floorz mz
setvar COUNTER 1 }

ifvare COUNTER 1 { soundonce SOUND57
ifrnd 200 ifvare VIRTUALVAR 3 { spawn WATER_SPRITE } }

ifvare MUSIC_VAR 3 killit
} 

ifspritepal 30 ifvare SWITCH1_VAR 10 ifvare SWITCH2_VAR 18 ifvare SWITCH3_VAR 17
ifvare SWITCH4_VAR 16 ifvare SWITCH5_VAR 14 { quake 10
setvar DOOROPEN_VAR 1 starttrack 0 operateactivators 99 myconnectindex globalsound SOUND63 killit
}

ifspritepal 31 {
ifcount 60 ifrnd 26 ifpdistg 10000 { spawn LASERSTREAM_SPRITE resetcount }
}

ifspritepal 32 ifvare STUFF_VAR 13 { spawn BLAST_SPRITE setvar STUFF_VAR 0 }
ifspritepal 33 { ifvare INTRO_VAR 5 ifcount 40 { spawn DIGITALEFFECT_SPRITE resetcount } }
enda

move LASERSTREAM_MOVE 0 -320
action ALASERSTREAM_SPRITE1 0 0 0 0 2
actor LASERSTREAM_SPRITE 
ifaction 0 { sizeat 152 88 action ALASERSTREAM_SPRITE1 }
ifaction ALASERSTREAM_SPRITE1 {
move LASERSTREAM_MOVE geth getv
sizeto 12 255 sizeto 12 255 sizeto 12 255 sizeto 12 255
ifactioncount 20 cstat 2
ifactioncount 23 cstat 514
ifactioncount 26 killit
}
enda

move WATER_MOVE 33

action AWATER_SPRITE 0 3 1 1 6
actor WATER_SPRITE

clipdist 1

ifaction 0 {

ifspritepal 0 { 
randvar ZVEL 2024
addvar ZVEL 5524
mulvar ZVEL -1
cstat 129
sizeat 128 100
setvar COUNTER 9 spritepal 3 }

ifspritepal 3 { sizeat 128 200 ifvarg COUNTER 0 cstat 129 else cstat 128 }

getactor[THISACTOR].z myz
addvarvar myz ZVEL
setactor[THISACTOR].z myz
addvarvar ZVEL GRAVITY
move WATER_MOVE geth getv


getactor[THISACTOR].z myz
getsector[THISACTOR].floorz sectorz
subvarvar sectorz myz

ifvarl sectorz 20 ifvare COUNTER 0 { cstat 0 sizeat 128 128 move 0 action AWATER_SPRITE setvar ZVEL 0 } 


ifspritepal 21 spritepal 3
ifnotmoving killit 
ifvarg COUNTER 0 subvar COUNTER 1
}

ifaction AWATER_SPRITE ifactioncount 3 killit
enda


move ELEVATOREFFECT_MOVE 0 -256
actor ELEVATOREFFECT sizeat 56 248 
ifaction 0 { 
ifrnd 128 cstat 138 else cstat 142
action ZERO 
}

ifaction ZERO {
move ELEVATOREFFECT_MOVE geth getv
ifceilingdistl 40 killit
}
enda

actor ELEVATORACTIVATE1 setvar ELEVATOR_VAR 1 killit enda
actor ELEVATORACTIVATE2 setvar ELEVATOR_VAR 2 killit enda
actor ELEVATORACTIVATE3 setvar ELEVATOR_VAR 3 killit enda

action AGAME_SPRITE1 0 0 0 0 2
action AGAME_SPRITE2 0 0 0 0 2
action AGAME_SPRITE3 0 0 0 0 2
action AGAME_SPRITE4 0 0 0 0 2
action AGAME_SPRITE5 0 0 0 0 2
action AGAME_SPRITE6 0 0 0 0 2
action AGAME_SPRITE7 0 0 0 0 2
action AGAME_SPRITE8 0 0 0 0 2
action AGAME_SPRITE9 0 0 0 0 2
action AGAME_SPRITE10 0 0 0 0 2
action AGAME_SPRITE11 0 0 0 0 2
action AGAME_SPRITE12 0 0 0 0 2
action AGAME_SPRITE13 0 0 0 0 2
action AGAME_SPRITE14 0 0 0 0 2
action AGAME_SPRITE15 0 0 0 0 2
action AGAME_SPRITE16 0 0 0 0 2

action AGAME_SPRITE17 0 0 0 0 2
action AGAME_SPRITE18 0 0 0 0 2
action AGAME_SPRITE19 0 0 0 0 2
action AGAME_SPRITE20 0 0 0 0 2

action AGAME_SPRITE_LOADGAME 0 0 0 0 2
action AGAME_SPRITE_LOADGAME2 0 0 0 0 2

action AGAME_SPRITE_EDUKE32CREDITS1 0 0 0 0 2
action AGAME_SPRITE_EDUKE32CREDITS2 0 0 0 0 2

action AGAME_SPRITE_HIGHWAY 0 0 0 0 2
action AGAME_SPRITE_HIGHWAY2 0 0 0 0 2
action AGAME_SPRITE_HIGHWAY3 0 0 0 0 2
action AGAME_SPRITE_HIGHWAY4 0 0 0 0 2
action AGAME_SPRITE_HIGHWAY5 0 0 0 0 2
action AGAME_SPRITE_HIGHWAY6 0 0 0 0 2

action AGAME_SPRITE_ERROR 0 0 0 0 10
action AGAME_SPRITE_ERROR2 0 0 0 0 2
action AGAME_SPRITE_ERROR3 0 0 0 0 2

action AGAME_SPRITE_ENDING 0 0 0 0 2
action AGAME_SPRITE_ENDING2 0 0 0 0 8
action AGAME_SPRITE_ENDING3 0 0 0 0 2
action AGAME_SPRITE_ENDING4 0 0 0 0 2
action AGAME_SPRITE_ENDING5 0 0 0 0 2
action AGAME_SPRITE_ENDING6 0 0 0 0 2
action AGAME_SPRITE_ENDING7 0 0 0 0 2
action AGAME_SPRITE_ENDING8 0 0 0 0 2
action AGAME_SPRITE_ENDING9 0 0 0 0 2
action AGAME_SPRITE_ENDING10 0 0 0 0 2
action AGAME_SPRITE_ENDING11 0 0 0 0 2
action AGAME_SPRITE_ENDING12 0 0 0 0 2
action AGAME_SPRITE_ENDING12_1 0 0 0 0 2
action AGAME_SPRITE_ENDING12_2 0 0 0 0 2
action AGAME_SPRITE_ENDING13 0 0 0 0 2
action AGAME_SPRITE_ENDING14 0 0 0 0 2
action AGAME_SPRITE_ENDING14_2 0 0 0 0 2
action AGAME_SPRITE_ENDING15 0 0 0 0 2
action AGAME_SPRITE_ENDING16 0 0 0 0 6
action AGAME_SPRITE_ENDING17 0 0 0 0 2

actor GAME_SPRITE cstat 32768 sleeptime -1
ifaction 0 {
ifspritepal 1 ifcansee action AGAME_SPRITE1 
ifspritepal 2 ifvare TELEPORT_VAR 1 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 3 ifvare TELEPORT_VAR 2 { setvar TEXTVAR2 21 setvar SAVEDGAME_VAR 1 savegamevar SAVEDGAME_VAR save 0 setvar TEXTVAR 10 palfrom 60 0 starttrack 1 setvar TELEPORT_VAR 0 state controlplayer action AGAME_SPRITE17 }
ifspritepal 4 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 1 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 5 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 2 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 6 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 3 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 7 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 4 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 8 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 5 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 9 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 6 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 10 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 7 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 11 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 8 { setvar TELEPORT_VAR 0 state controlplayer killit }
ifspritepal 12 ifvare TELEPORT_VAR 3 ifvare VIRTUALVAR 9 { setvar TELEPORT_VAR 0 state controlplayer killit }

ifspritepal 13 ifcansee {
palfrom 63 63 63 63 
state controlplayer
setplayer[THISACTOR].horiz 100
setvar STOPPLAYER 1 
action AGAME_SPRITE_HIGHWAY
}

ifspritepal 14 ifvare TELEPORT_VAR 4 { setvar TELEPORT_VAR 0 state controlplayer killit }

ifspritepal 15 ifvare STUFF_VAR 11 ifvare MENU_VAR 0 { setvar INTRO_VAR 777 setvar STUFF_VAR 0 action AGAME_SPRITE_ENDING }
ifspritepal 16 ifvare STUFF_VAR 12 ifvare MENU_VAR 0 { setvar STUFF_VAR 0 action AGAME_SPRITE_ERROR }

ifspritepal 17 ifvare TELEPORT_VAR 5 { setvar TELEPORT_VAR 0 state controlplayer killit }
}


ifaction AGAME_SPRITE_ERROR {
ifactioncount 1 palfrom 4 0
ifactioncount 2 palfrom 8 0
ifactioncount 3 palfrom 12 0
ifactioncount 4 palfrom 16 0
ifactioncount 5 palfrom 20 0
ifactioncount 6 palfrom 24 0
ifactioncount 7 palfrom 28 0
ifactioncount 8 palfrom 32 0
ifactioncount 9 palfrom 36 0
ifactioncount 10 palfrom 40 0
ifactioncount 11 palfrom 44 0
ifactioncount 12 palfrom 48 0
ifactioncount 13 palfrom 52 0
ifactioncount 14 palfrom 56 0
ifactioncount 15 palfrom 60 0
ifactioncount 16 { setvar WEAPON_VAR 0 palfrom 63 0 action AGAME_SPRITE_ERROR2 }
}

ifaction AGAME_SPRITE_ERROR2 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 90 ifvare TEXTVAR2 0 setvar TEXTVAR2 16
ifactioncount 180 ifvare TEXTVAR2 16 { globalsound SOUND22 globalsound SOUND72 setvar TEXTVAR2 17 }
ifactioncount 280 { starttrack 18 setvar TEXTVAR2 0 setvar STOPPLAYER 0 setvar TELEPORT_VAR 5 killit }
}

ifaction AGAME_SPRITE_ENDING {
ifactioncount 180 action AGAME_SPRITE_ENDING2
}

ifaction AGAME_SPRITE_ENDING2 {
ifactioncount 1 palfrom 4 0
ifactioncount 2 palfrom 8 0
ifactioncount 3 palfrom 12 0
ifactioncount 4 palfrom 16 0
ifactioncount 5 palfrom 20 0
ifactioncount 6 palfrom 24 0
ifactioncount 7 palfrom 28 0
ifactioncount 8 palfrom 32 0
ifactioncount 9 palfrom 36 0
ifactioncount 10 palfrom 40 0
ifactioncount 11 palfrom 44 0
ifactioncount 12 palfrom 48 0
ifactioncount 13 palfrom 52 0
ifactioncount 14 palfrom 56 0
ifactioncount 15 palfrom 60 0
ifactioncount 16 { setvar WEAPON_VAR 0 palfrom 63 0 setvar STOPPLAYER 1 setvar INTRO_VAR 10 action AGAME_SPRITE_ENDING3 }
}

ifaction AGAME_SPRITE_ENDING3 {
state controlplayer
setplayer[THISACTOR].horiz 100
palfrom 63 0

ifactioncount 50 { starttrack 17 action AGAME_SPRITE_ENDING4 setvar TEXTVAR 1 }
}

ifaction AGAME_SPRITE_ENDING4 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 50 ifvare TEXTVAR 1 { setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 11 setvar PRESS_VAR 1 action AGAME_SPRITE_ENDING5 }
}

ifaction AGAME_SPRITE_ENDING5 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { globalsound SOUND71 setvar TEXTVAR 1 setvar INTRO_VAR 6 action AGAME_SPRITE_ENDING6 } 
}

ifaction AGAME_SPRITE_ENDING6 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 2 ifvare INTRO_VAR 6 { setvar ALPHA_VAR 0 setvar INTRO_VAR 11 }
ifvare INTRO_VAR 11 ifvarl ALPHA_VAR 250 addvar ALPHA_VAR 6
ifvarg ALPHA_VAR 249 { globalsound SOUND72 setvar ALPHA_VAR 0 setvar INTRO_VAR 6 action AGAME_SPRITE_ENDING7 }
}

ifaction AGAME_SPRITE_ENDING7 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 2 ifvare INTRO_VAR 6 { setvar ALPHA_VAR 0 setvar INTRO_VAR 12 }
ifvare INTRO_VAR 12 ifvarl ALPHA_VAR 250 addvar ALPHA_VAR 6
ifvarg ALPHA_VAR 249 { setvar ALPHA_VAR 0 setvar INTRO_VAR 13 action AGAME_SPRITE_ENDING8 }
}

ifaction AGAME_SPRITE_ENDING8 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 30 { ifvarl ALPHA_VAR 254 addvar ALPHA_VAR 5 }
ifvarg ALPHA_VAR 253 { setvar INTRO_VAR 0 setvar ALPHA_VAR 0 setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 12 setvar PRESS_VAR 1 action AGAME_SPRITE_ENDING9 } 
}

ifaction AGAME_SPRITE_ENDING9 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar PRESS_VAR 1 setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 13 action AGAME_SPRITE_ENDING10 } 
}

ifaction AGAME_SPRITE_ENDING10 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar PRESS_VAR 1 setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 14 action AGAME_SPRITE_ENDING11 } 
}

ifaction AGAME_SPRITE_ENDING11 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar TEXTVAR 1 action AGAME_SPRITE_ENDING12 } 
}

ifaction AGAME_SPRITE_ENDING12 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 50 ifvare TEXTVAR 1 { setvar PRESS_VAR 1 setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 15 }
ifactioncount 55 ifvare TEXTVAR 15
ifhitspace ifvare PRESS_VAR 0 { setvar TEXTVAR 1 setvar ALPHA_VAR 255 setvar INTRO_VAR 13 action AGAME_SPRITE_ENDING12_1 }
}

ifaction AGAME_SPRITE_ENDING12_1 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifvarg ALPHA_VAR 0 subvar ALPHA_VAR 5
ifvarl ALPHA_VAR 1 { setvar ALPHA_VAR 0 action AGAME_SPRITE_ENDING12_2 }
}

ifaction AGAME_SPRITE_ENDING12_2 {

ifactioncount 30 ifvare INTRO_VAR 13 { setvar ALPHA_VAR 0 setvar INTRO_VAR 2 }
ifvare INTRO_VAR 2 ifvarl ALPHA_VAR 250 addvar ALPHA_VAR 6
ifvarg ALPHA_VAR 249 setvar ALPHA_VAR 255

ifactioncount 140 ifvare INTRO_VAR 2
{ setvar TEXTVAR 0 setvar ALPHA_VAR 0 starttrack 0 globalsound SOUND70 setvar INTRO_VAR 6 action AGAME_SPRITE_ENDING13 } 
}



ifaction AGAME_SPRITE_ENDING13 {
state controlplayer
setplayer[THISACTOR].horiz 100

ifactioncount 2 setvar INTRO_VAR 14 
ifactioncount 4 setvar INTRO_VAR 15
ifactioncount 6 setvar INTRO_VAR 16
ifactioncount 8 setvar INTRO_VAR 17
ifactioncount 10 setvar INTRO_VAR 18
ifactioncount 12 setvar INTRO_VAR 19
ifactioncount 14 setvar INTRO_VAR 20
ifactioncount 16 setvar INTRO_VAR 21
ifactioncount 18 setvar INTRO_VAR 13

ifactioncount 125 { setvar PRESS_VAR 1 setvar INTRO_VAR 0 palfrom 63 0 setvar TEXTVAR2 12 action AGAME_SPRITE_ENDING14 }
}

ifaction AGAME_SPRITE_ENDING14 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 15 ifhitspace ifvare PRESS_VAR 0 { setvar PRESS_VAR 1 palfrom 63 0 setvar TEXTVAR2 15 action AGAME_SPRITE_ENDING14_2 }
}

ifaction AGAME_SPRITE_ENDING14_2 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 15 ifhitspace ifvare PRESS_VAR 0 { setvar PRESS_VAR 1 setvar INTRO_VAR 13 setvar TEXTVAR2 0 action AGAME_SPRITE_ENDING15 }
}


ifaction AGAME_SPRITE_ENDING15 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 20 ifvare TEXTVAR2 0 { setvar INTRO_VAR 0 setvar TEXT2BRIGHTNESS1 35 setvar TEXTVAR2 13 }
ifactioncount 90 ifvare TEXTVAR2 13 { setvar TEXT2BRIGHTNESS1 35 setvar TEXTVAR2 14 }

ifactioncount 170 action AGAME_SPRITE_ENDING16
}

ifaction AGAME_SPRITE_ENDING16 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 1 palfrom 4 0
ifactioncount 2 palfrom 8 0
ifactioncount 3 palfrom 12 0
ifactioncount 4 palfrom 16 0
ifactioncount 5 palfrom 20 0
ifactioncount 6 palfrom 24 0
ifactioncount 7 palfrom 28 0
ifactioncount 8 palfrom 32 0
ifactioncount 9 palfrom 36 0
ifactioncount 10 palfrom 40 0
ifactioncount 11 palfrom 44 0
ifactioncount 12 palfrom 48 0
ifactioncount 13 palfrom 52 0
ifactioncount 14 palfrom 56 0
ifactioncount 15 palfrom 60 0
ifactioncount 16 palfrom 63 0
ifactioncount 46 quitgame
}



ifaction AGAME_SPRITE_HIGHWAY {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 40 ifvare COUNTER 0 { globalsound SOUND67 setvar COUNTER 1 } 
ifactioncount 100 { palfrom 63 0 action AGAME_SPRITE_HIGHWAY2 }
}

ifaction AGAME_SPRITE_HIGHWAY2 {
setvar INTRO_VAR 8
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 220 { stopsound SOUND67 globalsound SOUND66 setvar STUFF_VAR 9 action AGAME_SPRITE_HIGHWAY3 }
}

ifaction AGAME_SPRITE_HIGHWAY3 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 63 ifvare STUFF_VAR 9 setvar STUFF_VAR 10
ifactioncount 160 { palfrom 63 0 setvar INTRO_VAR 0 action AGAME_SPRITE_HIGHWAY4 }
}

ifaction AGAME_SPRITE_HIGHWAY4 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 0 setvar INTRO_VAR 9
ifactioncount 200 action AGAME_SPRITE_HIGHWAY5
}

ifaction AGAME_SPRITE_HIGHWAY5 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 1 palfrom 4 0
ifactioncount 2 palfrom 8 0
ifactioncount 3 palfrom 12 0
ifactioncount 4 palfrom 16 0
ifactioncount 5 palfrom 20 0
ifactioncount 6 palfrom 24 0
ifactioncount 7 palfrom 28 0
ifactioncount 8 palfrom 32 0
ifactioncount 9 palfrom 36 0
ifactioncount 10 palfrom 40 0
ifactioncount 11 palfrom 44 0
ifactioncount 12 palfrom 48 0
ifactioncount 13 palfrom 52 0
ifactioncount 14 palfrom 56 0
ifactioncount 15 palfrom 60 0
ifactioncount 16 { palfrom 63 0 setvar INTRO_VAR 0 action AGAME_SPRITE_HIGHWAY6 }
}

ifaction AGAME_SPRITE_HIGHWAY6 {
state controlplayer palfrom 63 0
setplayer[THISACTOR].horiz 100
ifactioncount 40
{ palfrom 63 0 setvar STOPPLAYER 0 setvar TELEPORT_VAR 4 killit }
}

ifaction AGAME_SPRITE1 {
readgamevar SAVEDGAME_VAR
readgamevar INVERTION
palfrom 60 0
state controlplayer
setplayer[THISACTOR].horiz 100
setvar STOPPLAYER 1 
ifactioncount 20 { 
starttrack 15

setvar MENU_VAR 1 palfrom 60 0
setvar PRESS_VAR 0 setvar MENU_SCREEN 1 action AGAME_SPRITE2 }
}


ifaction AGAME_SPRITE2 {
state controlplayer
readgamevar SAVEDGAME_VAR
setplayer[THISACTOR].horiz 100

ifvarg mousex 2064384 ifvarg mousey 10354688 ifvarl mousex 7536640 ifvarl mousey 11272192 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 0 setvar TEXTBRIGHTNESS2 20 ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
setvar TEXTBRIGHTNESS 0 setvar TEXTBRIGHTNESS2 0 setvar TEXTVAR 0
globalsound SOUND9 setvar PRESS_VAR 1 setvar LANGUAGE_VAR 0 setvar MENU_SCREEN 0 
setvar MENU_SCREEN 0 action AGAME_SPRITE_LOADGAME
} 
}

else

ifvarg mousex 12517376 ifvarg mousey 10387456 ifvarl mousex 18350080 ifvarl mousey 11337728 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20 setvar TEXTBRIGHTNESS2 0 ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
setvar TEXTBRIGHTNESS 0 setvar TEXTBRIGHTNESS2 0 setvar TEXTVAR 0
globalsound SOUND9 setvar PRESS_VAR 1 setvar LANGUAGE_VAR 1 setvar MENU_SCREEN 0 
 setvar MENU_SCREEN 0 action AGAME_SPRITE_LOADGAME
} 
}

else

{ setvar COUNTER 0 setvar PRESS_VAR 1 setvar TEXTBRIGHTNESS 20 setvar TEXTBRIGHTNESS2 20 }


}

ifaction AGAME_SPRITE_LOADGAME {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 20 { setvar TEXTVAR 0 setvar PRESS_VAR 1 setvar MENU_SCREEN 3 action AGAME_SPRITE_LOADGAME2 }
}


ifaction AGAME_SPRITE_LOADGAME2 {
state controlplayer
readgamevar SAVEDGAME_VAR
setplayer[THISACTOR].horiz 100


//new game
ifvarg mousex 7143424 ifvarg mousey 1867776 ifvarl mousex 13598720 ifvarl mousey 2752512 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 0
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
globalsound SOUND9 setvar PRESS_VAR 1 setvar MENU_SCREEN 0 
setvar MENU_SCREEN 0 setvar TEXTVAR 0 setvar MENU_VAR 0 action AGAME_SPRITE3
} 
}

else

//load game
ifvarg mousex 6815744 ifvarg mousey 3866624 ifvarl mousex 13959168 ifvarl mousey 4685824 ifvare SAVEDGAME_VAR 1 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 0 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
cmenu 1000 setplayer[THISACTOR].gm 1
} 
}

else

//invert aim
ifvarg mousex 5373952 ifvarg mousey 5832704 ifvarl mousex 15400960 ifvarl mousey 6651904 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 0 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
setvar PRESS_VAR 1 globalsound SOUND9 
ifvare INVERTION 0 setvar INVERTION 1 else
ifvare INVERTION 1 setvar INVERTION 0
savegamevar INVERTION
} 
}

else

//eduke 32 credits
ifvarg mousex 4096000 ifvarg mousey 7831552 ifvarl mousex 15990784 ifvarl mousey 8650752 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 0
setvar TEXTBRIGHTNESS5 20 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
globalsound SOUND9 setvar PRESS_VAR 1
setvar MENU_SCREEN 4 action AGAME_SPRITE_EDUKE32CREDITS1
} 
}

else

//quit
ifvarg mousex 8683520 ifvarg mousey 9732096 ifvarl mousex 11960320 ifvarl mousey 10616832 ifvare PRESS_VAR 0
{
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 0 

ifvare COUNTER 0 { setvar COUNTER 1  globalsound SOUND8 }
ifhitspace ifvare PRESS_VAR 0 { 
quitgame
} 
}

else

{ setvar COUNTER 0 setvar PRESS_VAR 1 
setvar TEXTBRIGHTNESS 20
ifvare SAVEDGAME_VAR 1 setvar TEXTBRIGHTNESS2 20 else setvar TEXTBRIGHTNESS2 28 
setvar TEXTBRIGHTNESS33 20 
setvar TEXTBRIGHTNESS4 20
setvar TEXTBRIGHTNESS5 20 

}


}



ifaction AGAME_SPRITE_EDUKE32CREDITS1 {
state controlplayer
setplayer[THISACTOR].horiz 100

ifvare PRESS_VAR 0 ifhitspace { globalsound SOUND9 setvar PRESS_VAR 1 setvar MENU_SCREEN 5 action AGAME_SPRITE_EDUKE32CREDITS2 }
}

ifaction AGAME_SPRITE_EDUKE32CREDITS2 {
state controlplayer
setplayer[THISACTOR].horiz 100

ifvare PRESS_VAR 0 ifhitspace {  setvar TEXTBRIGHTNESS5 20 setvar TEXTBRIGHTNESS4 20 setvar TEXTBRIGHTNESS33 20 setvar TEXTBRIGHTNESS2 20  setvar TEXTBRIGHTNESS 20 setvar TEXTVAR 0 setvar PRESS_VAR 1 setvar MENU_SCREEN 3 action AGAME_SPRITE_LOADGAME2 }
}


ifaction AGAME_SPRITE3 {
state controlplayer
setplayer[THISACTOR].horiz 100
setvar PRESS_VAR 1
ifactioncount 20 { setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 2 action AGAME_SPRITE4 }
}

ifaction AGAME_SPRITE4 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 3 setvar PRESS_VAR 1 action AGAME_SPRITE5 }
}

ifaction AGAME_SPRITE5 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar ALPHA_VAR 255 setvar INTRO_VAR 1 setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 4 setvar PRESS_VAR 1 action AGAME_SPRITE6 }
}

ifaction AGAME_SPRITE6 {
ifvarg ALPHA_VAR 0 subvar ALPHA_VAR 10
ifvarl ALPHA_VAR 0 setvar ALPHA_VAR 0
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 ifvare ALPHA_VAR 0 { setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 5 setvar PRESS_VAR 1 action AGAME_SPRITE7 }
}

ifaction AGAME_SPRITE7 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 6 setvar PRESS_VAR 1 action AGAME_SPRITE8 }
}

ifaction AGAME_SPRITE8 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar INTRO_VAR 2 setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 7 setvar PRESS_VAR 1 action AGAME_SPRITE9 }
}

ifaction AGAME_SPRITE9 {
ifvarl ALPHA_VAR 255 addvar ALPHA_VAR 10
ifvarg ALPHA_VAR 255 setvar ALPHA_VAR 255
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 ifvare ALPHA_VAR 255 { setvar ALPHA_VAR2 255 setvar GLASSESY -60 setvar TEXTVAR 1 setvar INTRO_VAR 3 setvar PRESS_VAR 1 action AGAME_SPRITE10 }
}

ifaction AGAME_SPRITE10 {
ifvarg ALPHA_VAR2 0 subvar ALPHA_VAR2 10
ifvarl ALPHA_VAR2 0 setvar ALPHA_VAR2 0
state controlplayer
setplayer[THISACTOR].horiz 100
ifvare ALPHA_VAR2 0 { 
ifvarg GLASSESY -61 ifvarl GLASSESY 40 addvar GLASSESY 2 else
ifvarg GLASSESY 39 ifvarl GLASSESY 79 addvar GLASSESY 1 
}
ifactioncount 130 { setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 8 setvar PRESS_VAR 1 action AGAME_SPRITE11 }
}


ifaction AGAME_SPRITE11 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 { setvar ALPHA_VAR 255 setvar INTRO_VAR 4 setvar TEXTBRIGHTNESS3 35 setvar TEXTVAR 9 setvar PRESS_VAR 1 action AGAME_SPRITE12 }
}

ifaction AGAME_SPRITE12 {
ifvarg ALPHA_VAR 0 subvar ALPHA_VAR 10
ifvarl ALPHA_VAR 0 setvar ALPHA_VAR 0
state controlplayer
setplayer[THISACTOR].horiz 100
ifhitspace ifvare PRESS_VAR 0 ifvare ALPHA_VAR 0 { setvar PRESS_VAR 1 action AGAME_SPRITE13 }
}

ifaction AGAME_SPRITE13 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 1 palfrom 4 0
ifactioncount 2 palfrom 8 0
ifactioncount 3 palfrom 12 0
ifactioncount 4 palfrom 16 0
ifactioncount 5 palfrom 20 0
ifactioncount 6 palfrom 24 0
ifactioncount 7 palfrom 28 0
ifactioncount 8 palfrom 32 0
ifactioncount 9 palfrom 36 0
ifactioncount 10 palfrom 40 0
ifactioncount 11 palfrom 44 0
ifactioncount 12 palfrom 48 0
ifactioncount 13 palfrom 52 0
ifactioncount 14 palfrom 56 0
ifactioncount 15 { palfrom 60 0 setvar PRESS_VAR 1 setvar INTRO_VAR 5 setvar TEXTVAR 0 action AGAME_SPRITE14 }
}

ifaction AGAME_SPRITE14 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 1 palfrom 56 0
ifactioncount 2 palfrom 52 0
ifactioncount 3 palfrom 48 0
ifactioncount 4 palfrom 44 0
ifactioncount 5 palfrom 40 0
ifactioncount 6 palfrom 36 0
ifactioncount 7 palfrom 32 0
ifactioncount 8 palfrom 28 0
ifactioncount 9 palfrom 24 0
ifactioncount 10 palfrom 20 0
ifactioncount 11 palfrom 16 0
ifactioncount 12 palfrom 12 0
ifactioncount 13 palfrom 8 0
ifactioncount 14 palfrom 4 0
ifactioncount 15 palfrom 0 0
ifactioncount 30 ifhitspace ifvare PRESS_VAR 0 { starttrack 0 globalsound SOUND21 action AGAME_SPRITE15 }
}

ifaction AGAME_SPRITE15 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 1 palfrom 4 63 63 63
ifactioncount 2 palfrom 8 63 63 63
ifactioncount 3 palfrom 12 63 63 63
ifactioncount 4 palfrom 16 63 63 63
ifactioncount 5 palfrom 20 63 63 63
ifactioncount 6 palfrom 24 63 63 63
ifactioncount 7 palfrom 28 63 63 63
ifactioncount 8 palfrom 32 63 63 63
ifactioncount 9 palfrom 36 63 63 63
ifactioncount 10 palfrom 40 63 63 63
ifactioncount 11 palfrom 44 63 63 63
ifactioncount 12 palfrom 48 63 63 63
ifactioncount 13 palfrom 52 63 63 63
ifactioncount 14 palfrom 56 63 63 63 
ifactioncount 15 { palfrom 60 63 63 63 setvar INTRO_VAR 6 action AGAME_SPRITE16 }
}

ifaction AGAME_SPRITE16 {
palfrom 60 63 63 63
ifactioncount 20 { setvar MUSIC_VAR 666
setvar INTRO_VAR 0 setvar TEXTVAR 0
setvar INTRO_VAR 0 setvar TEXTBRIGHTNESS 0 setvar TEXTBRIGHTNESS2 0
setvar STOPPLAYER 0 setvar MENU_VAR 0 setvar MENU_SCREEN 0 setvar TELEPORT_VAR 1 killit
}
}

ifaction AGAME_SPRITE17 {
state controlplayer
setplayer[THISACTOR].horiz 100

ifactioncount 50 ifhitspace ifvare PRESS_VAR 0 { setvar TEXTVAR2 0 globalsound SOUND27 action AGAME_SPRITE18 }

ifactioncount 80 setvar TEXTVAR2 0
}

ifaction AGAME_SPRITE18 {
state controlplayer
setplayer[THISACTOR].horiz 100
ifactioncount 1 palfrom 4 63 63 63
ifactioncount 2 palfrom 8 63 63 63
ifactioncount 3 palfrom 12 63 63 63
ifactioncount 4 palfrom 16 63 63 63
ifactioncount 5 palfrom 20 63 63 63
ifactioncount 6 palfrom 24 63 63 63
ifactioncount 7 palfrom 28 63 63 63
ifactioncount 8 palfrom 32 63 63 63
ifactioncount 9 palfrom 36 63 63 63
ifactioncount 10 palfrom 40 63 63 63
ifactioncount 11 palfrom 44 63 63 63
ifactioncount 12 palfrom 48 63 63 63
ifactioncount 13 palfrom 52 63 63 63
ifactioncount 14 palfrom 56 63 63 63 
ifactioncount 15 { palfrom 60 63 63 63 setvar INTRO_VAR 6 }

ifactioncount 25 { 
palfrom 60 63 63 63 setvar TEXTVAR 0
setvar INTRO_VAR 0 starttrack 0
setvar STOPPLAYER 0 setvar TELEPORT_VAR 3 action 0
}
}

enda



eventloadactor WALLSCROLL_SPRITE
{
    changespritestat THISACTOR 5
    getactor[THISACTOR].hitag HITAGSAVED
    getactor[THISACTOR].lotag LOTAGSAVED
    setactor[THISACTOR].hitag 0
    setactor[THISACTOR].lotag 0
}
enda

useractor notenemy WALLSCROLL_SPRITE
cstat 32768 sleeptime -1

ifaction 0
{
getactor[THISACTOR].x x
getactor[THISACTOR].y y
getactor[THISACTOR].sectnum TEMP
getactor[THISACTOR].ang TEMP3

sin my TEMP3
cos mx TEMP3
getactor[THISACTOR].z z

hitscan x y z TEMP mx my 0 hitsect hitwall hitsprite hitx hity hitz 16777280
action ZERO
}

ifvarn hitwall -1
{
	ifspritepal 0
	{
	getwall[hitwall].xpanning TEMP2
	subvarvar TEMP2 LOTAGSAVED
	setwall[hitwall].xpanning TEMP2
	getwall[hitwall].ypanning TEMP2
	subvarvar TEMP2 HITAGSAVED
	setwall[hitwall].ypanning TEMP2
	}
	else
	ifspritepal 1
	{
	getwall[hitwall].xpanning TEMP2
	addvarvar TEMP2 LOTAGSAVED
	setwall[hitwall].xpanning TEMP2
	getwall[hitwall].ypanning TEMP2
	addvarvar TEMP2 HITAGSAVED
	setwall[hitwall].ypanning TEMP2
	}
	else
	ifspritepal 2
	{
	addvar LOTAGSAVED 1
	getwall[hitwall].xpanning TEMP2
	addvarvar TEMP2 LOTAGSAVED
	setwall[hitwall].xpanning TEMP2
	getwall[hitwall].ypanning TEMP2
	addvarvar TEMP2 HITAGSAVED
	setwall[hitwall].ypanning TEMP2
	}
	else
	ifspritepal 3
	{
	addvar HITAGSAVED 1
	getwall[hitwall].xpanning TEMP2
	addvarvar TEMP2 LOTAGSAVED
	setwall[hitwall].xpanning TEMP2
	getwall[hitwall].ypanning TEMP2
	addvarvar TEMP2 HITAGSAVED
	setwall[hitwall].ypanning TEMP2
	}
	else
	ifspritepal 4
	{
state shadewall 
	}
	else
	ifspritepal 5
	{
	getwall[hitwall].shade TEMP2
	ifvarg TEMP2 20 setvar TEMP2 -16 else addvarvar TEMP2 LOTAGSAVED
	setwall[hitwall].shade TEMP2
	}
}

enda
action ABLOCKER 1 0 0 0 2
actor BLOCKER sleeptime -1 
ifaction 0 action ABLOCKER
enda

spritenoshade EFFECT1
spritenoshade EFFECT2
spritenoshade BIGSMOKE_SPRITE
spritenoshade FLAME_SPRITE

action EFFECT1_ACTION 0 5 1 1 6
actor EFFECT1 ifspawnedby WEAPON_SPRITE cstat 130 else cstat 2 sizeat 42 36
ifaction 0 action EFFECT1_ACTION 
ifactioncount 5 killit
enda

action FLAME_SPRITE_ACTION 0 9 1 1 6
actor FLAME_SPRITE cstat 2 sizeat 80 80 spritepal 17
ifaction 0 { sound SOUND54 action FLAME_SPRITE_ACTION } 
ifactioncount 9 killit
enda

move EFFECT2_MOVE 60 
action EFFECT2_ACTION 0 6 1 1 4
actor EFFECT2 cstat 2 clipdist 1
ifspawnedby SMALLSMOKE sizeat 12 12 else sizeat 48 48
ifaction 0 { 
state lookatplayer
move EFFECT2_MOVE geth getv
action EFFECT2_ACTION 
}
ifspawnedby BLAST_SPRITE shoot FIRELASER
ifactioncount 6 killit

ifspawnedby SMALLSMOKE {
state lookatplayer
ifactioncount 2 move 0
}
enda

action EFFECT3_ACTION 0 7 1 1 8
actor EFFECT3

ifaction 0 { ifrnd 128 sizeat 140 140 else sizeat 200 200 ifvare WEAPON_VAR 1 spritepal 8 else spritepal 4 cstat 34  action EFFECT3_ACTION }
ifaction EFFECT3_ACTION {
sizeto 255 255 
getactor[THISACTOR].y my
subvar my 32
setactor[THISACTOR].y my

ifactioncount 6 cstat 546
ifactioncount 7 killit
}
enda

move BIGSMOKE_MOVE 0 -250
action BIGSMOKE_ACTION 0 7 1 1 5
actor BIGSMOKE_SPRITE cstat 2 sizeat 32 24
move BIGSMOKE_MOVE geth getv
ifaction 0 action BIGSMOKE_ACTION  
ifaction BIGSMOKE_ACTION ifactioncount 7 killit
enda

spritenoshade BLAST_SPRITE
move BLAST_MOVE 80
actor BLAST_SPRITE sleeptime -1 clipdist 0 spritepal 12 sizeat 255 255
ifaction 0 action ZERO
ifaction ZERO {
soundonce SOUND28
move BLAST_MOVE geth getv
ifnotmoving ifvarl COUNTER2 6 { setvar COUNTER2 0 setvar STUFF_VAR 13 palfrom 30 63 63 63 globalsound SOUND7 killit }
findnearactor STUFF_SPRITE 180 TEMP
ifvarn TEMP -1 
{
getactor[TEMP].ang ANGVAR
setactor[THISACTOR].ang ANGVAR

getactor[TEMP].x mx
setactor[THISACTOR].x mx

getactor[TEMP].y my
setactor[THISACTOR].y my

addvar COUNTER2 1
action ZERO2

} 
}

ifaction ZERO2 { 
ifvare COUNTER2 7 { stopsound SOUND28 shoot FIRELASER sound SOUND7 spawn EFFECT2 killit }
move BLAST_MOVE geth getv ifactioncount 10 action ZERO }

addvar COUNTER 1 
ifvarg COUNTER 3 cstat 2 
ifvarg COUNTER 6 cstat 512 
ifvarg COUNTER 9 cstat 2 
ifvarg COUNTER 12 { cstat 0 setvar COUNTER 0 }

enda

action AWEAPON_SPRITE1 0 0 0 0 2
action AWEAPON_SPRITE2 0 0 0 0 2
action AWEAPON_SPRITE3 0 0 0 0 2
action AWEAPON_SPRITE4 0 0 0 0 2
actor WEAPON_SPRITE sleeptime -1 
addvar ANGVAR 40
setactor[THISACTOR].ang ANGVAR
ifaction 0 ifpdistl 22000 soundonce SOUND38
ifpdistl 700 ifcansee ifaction 0 {
setvar WEAPON_VAR 1 globalsound SOUND26 stopsound SOUND38
guts JIBS1 8
spawn EFFECT1
cstat 32768
setvar PRESS_VAR 1

ifvare VIRTUALVAR 3 {
starttrack 14 palfrom 52 0 42
operateactivators 9 myconnectindex
quake 14 globalsound SOUND36
}

setvar ALPHA_VAR2 33
setvar WEAPONX_VAR 160
setvar WEAPONY_VAR 120
action AWEAPON_SPRITE1
}

ifaction AWEAPON_SPRITE1 {
ifactioncount 6 ifvare ALPHA_VAR2 33 setvar ALPHA_VAR2 1
ifactioncount 12 ifvare ALPHA_VAR2 1 setvar ALPHA_VAR2 0


ifvare WEAPON_VAR 0 { setvar ALPHA_VAR2 0 killit }
ifvare TEXTVAR 0 ifvare MENU_VAR 0 ifvare INTRO_VAR 0 ifvare STOPPLAYER 0 ifvare ALPHA_VAR2 0 
ifhitspace ifvare PRESS_VAR 0 ifvare NOWEAPONS_VAR - { setvar WEAPONFRAMES_VAR 1 action AWEAPON_SPRITE2 }
}

ifaction AWEAPON_SPRITE2 {
ifvare WEAPON_VAR 0 killit 
ifactioncount 2 ifvare WEAPONFRAMES_VAR 1 setvar WEAPONFRAMES_VAR 2
ifactioncount 4 ifvare WEAPONFRAMES_VAR 2 setvar WEAPONFRAMES_VAR 3
ifactioncount 6 ifvare WEAPONFRAMES_VAR 3 { setplayer[THISACTOR].horizoff -7 globalsound SOUND5 setvar WEAPONFRAMES_VAR 4 }
ifactioncount 8 ifvare WEAPONFRAMES_VAR 4 setvar WEAPONFRAMES_VAR 5
ifactioncount 10 ifvare WEAPONFRAMES_VAR 5 { setvar PRESS_VAR 1 setvar WEAPONFRAMES_VAR 6 setvar ATTACK_VAR 1 }
ifactioncount 12 ifvare WEAPONFRAMES_VAR 6 setvar WEAPONFRAMES_VAR 7
ifactioncount 14 ifvare WEAPONFRAMES_VAR 7 setvar WEAPONFRAMES_VAR 8
ifactioncount 16 ifvare WEAPONFRAMES_VAR 8 setvar WEAPONFRAMES_VAR 9
ifactioncount 18 ifvare WEAPONFRAMES_VAR 9 { setvar WEAPONFRAMES_VAR 0  action AWEAPON_SPRITE1 }
}
enda

state controlweapon
ifactioncount 1 { addvar COUNTER 1 resetactioncount }
ifvare COUNTER 1 { setvar WEAPONX_VAR 158 setvar WEAPONY_VAR 119 }
ifvare COUNTER 2 { setvar WEAPONX_VAR 156 setvar WEAPONY_VAR 118 }
ifvare COUNTER 3 { setvar WEAPONX_VAR 154 setvar WEAPONY_VAR 117 }
ifvare COUNTER 4 { setvar WEAPONX_VAR 153 setvar WEAPONY_VAR 116 }
ifvare COUNTER 5 { setvar WEAPONX_VAR 152 setvar WEAPONY_VAR 115 }

ifvare COUNTER 6 { setvar WEAPONX_VAR 153  setvar WEAPONY_VAR 116 }
ifvare COUNTER 7 { setvar WEAPONX_VAR 154  setvar WEAPONY_VAR 117 }
ifvare COUNTER 8 { setvar WEAPONX_VAR 156  setvar WEAPONY_VAR 118 }
ifvare COUNTER 9 { setvar WEAPONX_VAR 158  setvar WEAPONY_VAR 119 }
ifvare COUNTER 10 { setvar WEAPONX_VAR 160 setvar WEAPONY_VAR 120 }

ifvare COUNTER 11 { setvar WEAPONX_VAR 162   setvar WEAPONY_VAR 119  }
ifvare COUNTER 12 { setvar WEAPONX_VAR 164   setvar WEAPONY_VAR 118  }
ifvare COUNTER 13 { setvar WEAPONX_VAR 166   setvar WEAPONY_VAR 117  }
ifvare COUNTER 14 { setvar WEAPONX_VAR 167   setvar WEAPONY_VAR 116  }
ifvare COUNTER 15 { setvar WEAPONX_VAR 168   setvar WEAPONY_VAR 115  }

ifvare COUNTER 16 { setvar WEAPONX_VAR 167    setvar WEAPONY_VAR 116   }
ifvare COUNTER 17 { setvar WEAPONX_VAR 166    setvar WEAPONY_VAR 117   }
ifvare COUNTER 18 { setvar WEAPONX_VAR 164    setvar WEAPONY_VAR 118  }
ifvare COUNTER 19 { setvar WEAPONX_VAR 162    setvar WEAPONY_VAR 119  }
ifvare COUNTER 20 { setvar WEAPONX_VAR 160 setvar WEAPONY_VAR 120 setvar COUNTER 0 }
ends

action AWEAPCONTROL_SPRITE1 0 0 0 0 4
action AWEAPCONTROL_SPRITE2 0 0 0 0 3
actor WEAPCONTROL_SPRITE sleeptime -1 cstat 32768
ifaction 0 ifvare WEAPON_VAR 1 action AWEAPCONTROL_SPRITE1
ifaction AWEAPCONTROL_SPRITE1 { 
ifvarg RUNNING 0 action AWEAPCONTROL_SPRITE2
ifp prunning ifp ponground state controlweapon }

ifaction AWEAPCONTROL_SPRITE2 { 
ifvare RUNNING 0 action AWEAPCONTROL_SPRITE1
ifp prunning ifp ponground state controlweapon }
enda

state vestate
sleeptime -1
ifspritepal 0 { 
cstat 18
addvar ANGVAR 40
setactor[THISACTOR].ang ANGVAR
ifpdistl 700 ifcansee  {
ifactor VIRTUALELEMENT1 setvar VIRTUALVAR 1
ifactor VIRTUALELEMENT2 { operateactivators 4 myconnectindex setvar VIRTUALVAR 2 }
ifactor VIRTUALELEMENT3 setvar VIRTUALVAR 3
ifactor VIRTUALELEMENT4 setvar VIRTUALVAR 4
ifactor VIRTUALELEMENT5 setvar VIRTUALVAR 5
ifactor VIRTUALELEMENT6 setvar VIRTUALVAR 6
ifactor VIRTUALELEMENT7 setvar VIRTUALVAR 7
ifactor VIRTUALELEMENT8 setvar VIRTUALVAR 8
ifactor VIRTUALELEMENT9 setvar VIRTUALVAR 9
ifactor VIRTUALELEMENT10 setvar VIRTUALVAR 10
globalsound SOUND26
guts JIBS1 8
spawn EFFECT1
killit
} }

ifspritepal 3 {
state shadestate 
ifactor VIRTUALELEMENT1 ifvare VIRTUALVAR 1 killit
ifactor VIRTUALELEMENT2 ifvare VIRTUALVAR 2 killit
ifactor VIRTUALELEMENT3 ifvare VIRTUALVAR 3 killit
ifactor VIRTUALELEMENT4 ifvare VIRTUALVAR 4 killit
ifactor VIRTUALELEMENT5 ifvare VIRTUALVAR 5 killit
ifactor VIRTUALELEMENT6 ifvare VIRTUALVAR 6 killit
ifactor VIRTUALELEMENT7 ifvare VIRTUALVAR 7 killit
ifactor VIRTUALELEMENT8 ifvare VIRTUALVAR 8 killit
ifactor VIRTUALELEMENT9 ifvare VIRTUALVAR 9 killit
ifactor VIRTUALELEMENT10 ifvare VIRTUALVAR 10 killit
}
ends

actor VIRTUALELEMENT1
state vestate
enda

actor VIRTUALELEMENT2
state vestate
enda

actor VIRTUALELEMENT3
state vestate
enda

actor VIRTUALELEMENT4
state vestate
enda

actor VIRTUALELEMENT5
state vestate
enda

actor VIRTUALELEMENT6
state vestate
enda

actor VIRTUALELEMENT7
ifspawnedby RESPAWN sizeat 40 40
state vestate
enda

actor VIRTUALELEMENT8
state vestate
enda

actor VIRTUALELEMENT9
state vestate
enda

actor VIRTUALELEMENT10
state vestate
enda


action AMUSIC_SPRITE1 0 0 0 0 2
actor MUSIC_SPRITE cstat 32768 sleeptime -1
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifvarvare rr0 rr1 {
ifspritepal 0 { ifvare MUSIC_VAR 666 { } else { setvar MUSIC_VAR 666 starttrack 0 } }
ifspritepal 1 { ifvare MUSIC_VAR 0 { } else { setvar MUSIC_VAR 0 starttrack 2 } }
ifspritepal 2 { ifvare MUSIC_VAR 1 { } else { setvar MUSIC_VAR 1 starttrack 3 } }
ifspritepal 3 { ifvare MUSIC_VAR 2 { } else { setvar MUSIC_VAR 2 starttrack 4 } }
ifspritepal 4 { ifvare MUSIC_VAR 3 { } else { setvar MUSIC_VAR 3 starttrack 5 } }
ifspritepal 5 { ifvare MUSIC_VAR 4 { } else { setvar MUSIC_VAR 4 starttrack 6 } }
ifspritepal 6 { ifvare MUSIC_VAR 5 { } else { setvar MUSIC_VAR 5 starttrack 7 } }
ifspritepal 7 { ifvare MUSIC_VAR 6 { } else { setvar MUSIC_VAR 6 starttrack 8 } }
ifspritepal 8 { ifvare MUSIC_VAR 7 { } else { setvar MUSIC_VAR 7 starttrack 9 } }
ifspritepal 9 { ifvare MUSIC_VAR 8 { } else { setvar MUSIC_VAR 8 starttrack 10 } }
ifspritepal 10 { ifvare MUSIC_VAR 9 { } else { setvar MUSIC_VAR 9 starttrack 11 } }
ifspritepal 11 { ifvare MUSIC_VAR 10 { } else { setvar MUSIC_VAR 10 starttrack 12 } }
ifspritepal 12 { ifvare MUSIC_VAR 11 { } else { setvar MUSIC_VAR 11 starttrack 13 } }
ifspritepal 13 { ifvare MUSIC_VAR 12 { } else { setvar MUSIC_VAR 12 starttrack 16 } }
}
enda



eventloadactor SECTORSCROLL_SPRITE
{
    changespritestat THISACTOR 5
    getactor[THISACTOR].hitag HITAGSAVED
    getactor[THISACTOR].lotag LOTAGSAVED
    setactor[THISACTOR].hitag 0
    setactor[THISACTOR].lotag 0
}
enda

useractor notenemy SECTORSCROLL_SPRITE
cstat 32768 sleeptime -1
ifaction 0 {
getactor[THISACTOR].xvel XVELVAR
getactor[THISACTOR].yvel YVELVAR
getactor[THISACTOR].zvel ZVELVAR
action ZERO }

ifspritepal 0 {
ifvare LOTAGSAVED 0 {
getsector[THISACTOR].floorxpanning myx 
ifvare XVELVAR 0 addvarvar myx HITAGSAVED else subvarvar myx HITAGSAVED
setsector[THISACTOR].floorxpanning myx 
}
ifvare LOTAGSAVED 1 {
getsector[THISACTOR].floorypanning myy 
ifvare XVELVAR 0 addvarvar myy HITAGSAVED else subvarvar myy HITAGSAVED
setsector[THISACTOR].floorypanning myy
}
}

ifspritepal 1 {
ifvare LOTAGSAVED 0 {
getsector[THISACTOR].ceilingxpanning myx 
ifvare XVELVAR 0 addvarvar myx HITAGSAVED else subvarvar myx HITAGSAVED
setsector[THISACTOR].ceilingxpanning myx 
}
ifvare LOTAGSAVED 1 {
getsector[THISACTOR].ceilingypanning myy 
ifvare XVELVAR 0 addvarvar myy HITAGSAVED else subvarvar myy HITAGSAVED
setsector[THISACTOR].ceilingypanning myy
}
}

enda




actor DOOR_SPRITE cstat 32768 sleeptime -1
ifaction 0 { getactor[THISACTOR].hitag HITAGSAVED action ZERO }

ifaction ZERO {
ifspritepal 1 {
getsector[THISACTOR].floorz myz
ifvare HITAGSAVED 1 setvarvar myz doorz1 
ifvare HITAGSAVED 2 setvarvar myz doorz2 
ifvare HITAGSAVED 3 setvarvar myz doorz3 
ifvare HITAGSAVED 4 setvarvar myz doorz4 
ifvare HITAGSAVED 5 setvarvar myz doorz5 
ifvare HITAGSAVED 6 setvarvar myz doorz6 
ifvare HITAGSAVED 7 setvarvar myz doorz7 
ifvare HITAGSAVED 8 setvarvar myz doorz8 
ifvare HITAGSAVED 9 setvarvar myz doorz9 
ifvare HITAGSAVED 10 setvarvar myz doorz10 
setsector[THISACTOR].floorz myz

ifpdistl 5000 {

ifvare HITAGSAVED 1 ifvare VIRTUALVAR 1 { setvar GODOOR 1 action ZERO2 }
ifvare HITAGSAVED 2  ifvare VIRTUALVAR 2 { setvar GODOOR 2 action ZERO2 } 
ifvare HITAGSAVED 3  ifvare VIRTUALVAR 3 { setvar GODOOR 3 action ZERO2 } 
ifvare HITAGSAVED 4  ifvare VIRTUALVAR 4 { setvar GODOOR 4 action ZERO2 } 
ifvare HITAGSAVED 5  ifvare VIRTUALVAR 5 { setvar GODOOR 5 action ZERO2 } 
ifvare HITAGSAVED 6  ifvare VIRTUALVAR 6 { setvar GODOOR 6 action ZERO2 } 
ifvare HITAGSAVED 7  ifvare VIRTUALVAR 7 { setvar GODOOR 7 action ZERO2 } 
ifvare HITAGSAVED 8  ifvare VIRTUALVAR 8 { setvar GODOOR 8 action ZERO2 } 
ifvare HITAGSAVED 9  ifvare VIRTUALVAR 9 { setvar GODOOR 9 action ZERO2 } 
ifvare HITAGSAVED 10  ifvare VIRTUALVAR 10 { setvar GODOOR 10 action ZERO2 } 
}

}

ifspritepal 2 {
getactor[THISACTOR].z myz
ifvare HITAGSAVED 1 setvarvar doorz1 myz
ifvare HITAGSAVED 2 setvarvar doorz2 myz
ifvare HITAGSAVED 3 setvarvar doorz3 myz
ifvare HITAGSAVED 4 setvarvar doorz4 myz
ifvare HITAGSAVED 5 setvarvar doorz5 myz
ifvare HITAGSAVED 6 setvarvar doorz6 myz
ifvare HITAGSAVED 7 setvarvar doorz7 myz
ifvare HITAGSAVED 8 setvarvar doorz8 myz
ifvare HITAGSAVED 9 setvarvar doorz9 myz
ifvare HITAGSAVED 10 setvarvar doorz10 myz

ifvare HITAGSAVED 1 ifvare GODOOR 1 { setvar GODOOR 0 action ZERO2 }
ifvare HITAGSAVED 2  ifvare GODOOR 2 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 3  ifvare GODOOR 3 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 4  ifvare GODOOR 4 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 5  ifvare GODOOR 5 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 6  ifvare GODOOR 6 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 7  ifvare GODOOR 7 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 8  ifvare GODOOR 8 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 9  ifvare GODOOR 9 { setvar GODOOR 0 action ZERO2 } 
ifvare HITAGSAVED 10  ifvare GODOOR 10 { setvar GODOOR 0 action ZERO2 } 
}

}

ifaction ZERO2 {

ifspritepal 1 {
getsector[THISACTOR].floorz myz
ifvare HITAGSAVED 1 setvarvar myz doorz1 
ifvare HITAGSAVED 2 setvarvar myz doorz2 
ifvare HITAGSAVED 3 setvarvar myz doorz3 
ifvare HITAGSAVED 4 setvarvar myz doorz4 
ifvare HITAGSAVED 5 setvarvar myz doorz5 
ifvare HITAGSAVED 6 setvarvar myz doorz6 
ifvare HITAGSAVED 7 setvarvar myz doorz7 
ifvare HITAGSAVED 8 setvarvar myz doorz8 
ifvare HITAGSAVED 9 setvarvar myz doorz9 
ifvare HITAGSAVED 10 setvarvar myz doorz10 
setsector[THISACTOR].floorz myz
}

ifspritepal 2 {

ifvare COUNTER 0 {
//randvar ZVEL 1024
//addvar ZVEL 750
//setvar ZVEL 0
mulvar ZVEL -1
setvar COUNTER 3 }

getactor[THISACTOR].z myz
addvarvar myz ZVEL
setactor[THISACTOR].z myz
addvarvar ZVEL GRAVITY

getactor[THISACTOR].z myz
ifvare HITAGSAVED 1 setvarvar doorz1 myz
ifvare HITAGSAVED 2 setvarvar doorz2 myz
ifvare HITAGSAVED 3 setvarvar doorz3 myz
ifvare HITAGSAVED 4 setvarvar doorz4 myz
ifvare HITAGSAVED 5 setvarvar doorz5 myz
ifvare HITAGSAVED 6 setvarvar doorz6 myz
ifvare HITAGSAVED 7 setvarvar doorz7 myz
ifvare HITAGSAVED 8 setvarvar doorz8 myz
ifvare HITAGSAVED 9 setvarvar doorz9 myz
ifvare HITAGSAVED 10 setvarvar doorz10 myz

iffloordistl 1 { 
ifvare COUNTER 3 { fall
ifvarl ZVEL 512 { killit //setvar COUNTER 24 setvar ZVEL 0 
}
else { sound SOUND32 quake 3 mulvar ZVEL -1 divvar ZVEL 2 setvar COUNTER 21 } } }
ifvare COUNTER 21 setvar COUNTER 3

}

}
enda


action TRIGGER_SPRITE1 0 0 0 0 2
action TRIGGER_SPRITE2 0 0 0 0 2
action TRIGGER_SPRITE3 0 0 0 0 2
action TRIGGER_SPRITE4 0 0 0 0 2
action TRIGGER_SPRITE5 0 0 0 0 2
actor TRIGGER_SPRITE cstat 32768 sleeptime -1
getplayer[THISACTOR].cursectnum rr0
getactor[THISACTOR].sectnum rr1
ifaction 0 ifvarvare rr0 rr1 {
ifspritepal 1 { action TRIGGER_SPRITE1 }
ifspritepal 2 { globalsound SOUND21 starttrack 0 setvar STOPPLAYER 1 action TRIGGER_SPRITE3 }
ifspritepal 3 { setvar STUFF_VAR 1 killit }
ifspritepal 4 { setvar STUFF_VAR 2 killit }
ifspritepal 5 ifp ponground { operateactivators 16 myconnectindex setvar STUFF_VAR 3 killit }
ifspritepal 6 { setvar TEXT2BRIGHTNESS2 36 setvar TEXTVAR2 1 setvar GLASSESY 20 setvar GLASSESY2 -20 action TRIGGER_SPRITE4 }
ifspritepal 7 { setvar TEXTVAR2 2 setvar GLASSESY 150 action TRIGGER_SPRITE5 }
ifspritepal 8 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 7 }
ifspritepal 9 { setvar TEXTVAR2 0 }
ifspritepal 10 { setvar STUFF_VAR 4 killit }
ifspritepal 11 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 8 }
ifspritepal 12 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 9 }
ifspritepal 13 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 10 }
ifspritepal 14 { setvar STUFF_VAR 7 killit }
ifspritepal 15 { setvar NOWEAPONS_VAR 1 }
ifspritepal 16 { setvar NOWEAPONS_VAR 0 }
ifspritepal 17 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 11 }
ifspritepal 18 ifvare VIRTUALVAR 10 { setvar STUFF_VAR 8 killit }
ifspritepal 19 { setvar STUFF_VAR 12 setvar STOPPLAYER 1 killit }
ifspritepal 20 ifvare WEAPON_VAR 0 { starttrack 0 operateactivators 99 myconnectindex spawn WEAPON_SPRITE killit }
ifspritepal 21 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 18 }
ifspritepal 22 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 19 }
ifspritepal 23 ifvare TEXTVAR2 0 { setvar TEXT2BRIGHTNESS1 36 setvar TEXTVAR2 20 }

ifspritepal 24 { setvar STUFF_VAR 20 killit }
ifspritepal 25 { setvar STUFF_VAR 21 killit }
ifspritepal 26 { setvar STUFF_VAR 22 killit }
ifspritepal 27 { setvar STUFF_VAR 23 killit }
}

ifaction TRIGGER_SPRITE1 ifactioncount 18 { setvar ALPHA_VAR 33 setvar INTRO_VAR 7 action TRIGGER_SPRITE2 }
ifaction TRIGGER_SPRITE2 {
ifactioncount 5 setvar ALPHA_VAR 1
ifactioncount 10 setvar ALPHA_VAR 0

ifactioncount 80 setvar ALPHA_VAR 1
ifactioncount 85 setvar ALPHA_VAR 33
ifactioncount 90 { setvar INTRO_VAR 0 setvar ALPHA_VAR 0 killit }
}

ifaction TRIGGER_SPRITE3 {
ifactioncount 1 palfrom 4 63 63 63
ifactioncount 2 palfrom 8 63 63 63
ifactioncount 3 palfrom 12 63 63 63
ifactioncount 4 palfrom 16 63 63 63
ifactioncount 5 palfrom 20 63 63 63
ifactioncount 6 palfrom 24 63 63 63
ifactioncount 7 palfrom 28 63 63 63
ifactioncount 8 palfrom 32 63 63 63
ifactioncount 9 palfrom 36 63 63 63
ifactioncount 10 palfrom 40 63 63 63
ifactioncount 11 palfrom 44 63 63 63
ifactioncount 12 palfrom 48 63 63 63
ifactioncount 13 palfrom 52 63 63 63
ifactioncount 14 palfrom 56 63 63 63 
ifactioncount 15 palfrom 60 63 63 63
ifactioncount 16 setvar INTRO_VAR 6
ifactioncount 25 { setvar WEAPON_VAR 0 setvar PRESS_VAR 1 setvar ALPHA_VAR 255 palfrom 60 0 setvar INTRO_VAR 2 setvar TELEPORT_VAR 2 killit }
}

ifaction TRIGGER_SPRITE4 {
ifactioncount 30 { ifvare GLASSESY2 -20 { setvar TEXT2BRIGHTNESS1 36 setvar GLASSESY2 40 } }
ifactioncount 60 { ifvare GLASSESY 20 { setvar TEXT2BRIGHTNESS2 36 setvar GLASSESY 60 } }
ifactioncount 90 { ifvare GLASSESY2 40 { setvar TEXT2BRIGHTNESS1 36 setvar GLASSESY2 80 } }
ifactioncount 120 { ifvare GLASSESY 60 { setvar TEXT2BRIGHTNESS2 36 setvar GLASSESY 100 } }
ifactioncount 150 { ifvare GLASSESY2 80 { setvar TEXT2BRIGHTNESS1 36 setvar GLASSESY2 120 } }
ifactioncount 180 { ifvare GLASSESY 100 { setvar TEXT2BRIGHTNESS2 36 setvar GLASSESY 140 } }
ifactioncount 210 { ifvare GLASSESY2 120 { setvar TEXT2BRIGHTNESS1 36 setvar GLASSESY2 160 } }
ifactioncount 240 { ifvare GLASSESY 140 { setvar TEXT2BRIGHTNESS2 36 setvar GLASSESY 180 } }
ifactioncount 270 { ifvare GLASSESY2 160 { setvar TEXT2BRIGHTNESS1 36 setvar GLASSESY2 220 } }
ifactioncount 300 { setvar GLASSESY 0 setvar GLASSESY2 0 setvar TEXTVAR2 0 killit }
}

ifaction TRIGGER_SPRITE5 {
ifactioncount 4 ifvare TEXTVAR2 2 setvar TEXTVAR2 3
ifactioncount 8 ifvare TEXTVAR2 3 setvar TEXTVAR2 4
ifactioncount 12 ifvare TEXTVAR2 4 setvar TEXTVAR2 5
ifactioncount 16 ifvare TEXTVAR2 5 setvar TEXTVAR2 6
ifactioncount 40 addvar GLASSESY 1
ifactioncount 60 { setvar TEXTVAR2 0 setvar GLASSESY 0 killit }
}
enda


actor FAKEWALL_SPRITE ifspritepal 3 { 
sleeptime -1
ifaction 0 ifvare STUFF_VAR 4 action ZERO
ifaction ZERO {
ifactioncount 3 cstat 19
ifactioncount 6 cstat 531
ifactioncount 9 { setvar STUFF_VAR 0 killit }
}
}
enda

action BLUEDOOR_SPRITE1 0 0 0 0 0 //closed door
action BLUEDOOR_SPRITE2 1 4 1 1 9 //open door
action BLUEDOOR_SPRITE3 4 1 1 1 0 //opened door
action BLUEDOOR_SPRITE4 4 4 1 -1 9 //close door
useractor notenemy BLUEDOOR_SPRITE sleeptime -1

ifaction 0 action BLUEDOOR_SPRITE1

ifaction BLUEDOOR_SPRITE1 {
spawn DOORSPAWN_SPRITE
ifpdistl 1800 ifcansee { sound SOUND10 action BLUEDOOR_SPRITE2 } else cstat 273 }

ifaction BLUEDOOR_SPRITE2 { ifactioncount 3 cstat 16 ifactioncount 4 { resetactioncount action BLUEDOOR_SPRITE3 cstat 16 } }
ifaction BLUEDOOR_SPRITE3 ifactioncount 100 { ifpdistl 1800 cstat 16 else { sound SOUND10 resetactioncount action BLUEDOOR_SPRITE4 cstat 16 } }
ifaction BLUEDOOR_SPRITE4 { ifactioncount 3 cstat 273 ifactioncount 4 { resetactioncount action BLUEDOOR_SPRITE1 cstat 273 } }

enda

spritenoshade LIGHT_SPRITE 
actor LIGHT_SPRITE cstat 16 clipdist 1 sizeat 112 64
ifvare COUNTER2 0 {
getactor[THISACTOR].ang ANGVAR 
addvar ANGVAR 512
setactor[THISACTOR].ang ANGVAR 
setvar COUNTER2 1
}

addvar COUNTER 1
ifvarg COUNTER 200 killit

getactor[THISACTOR].y my
subvar my 256
setactor[THISACTOR].y my

ifaction 0 ifpdistl 1600 { sound SOUND2 action ZERO }
enda

actor WINDOW_SPRITE sleeptime -1
ifpdistl 9000 { ifvare COUNTER 0 ifrnd 128 { setvar COUNTER 1 sound SOUND30 cstat 32768 } } else { ifvare COUNTER 1 ifrnd 128 { sound SOUND30 cstat 16 setvar COUNTER 0 } }
enda



move SMM 0
actor SMOKESPAWNER_SPRITE
cstat 32768 sleeptime -1
ifrnd 68 ifpdistl 15000 spawn SMOKE_SPRITE
move SMM randomangle
enda

spritenoshade SMOKE_SPRITE
move SMOKE_SPRITEMOVE 40 -36
move SMOKE_SPRITEMOVE2 0 -42
action SMOKE_SPRITEACTION 0 0 0 0 2
actor SMOKE_SPRITE setactor[THISACTOR].shade 10
ifaction 0 {  sizeat 8 8 cstat 32768 action SMOKE_SPRITEACTION }
ifaction SMOKE_SPRITEACTION {
ifactioncount 1 move SMOKE_SPRITEMOVE geth getv
sizeto 70 70
ifactioncount 10 ifrnd 32 { cstat 130 move SMOKE_SPRITEMOVE2 geth getv }
ifactioncount 15 { cstat 130 move SMOKE_SPRITEMOVE2 geth getv }
ifactioncount 46 cstat 642
ifactioncount 50 killit
}
enda

action ASTEAM_SPRITE1 0 1 1 1 2
action ASTEAM_SPRITE2 0 7 1 1 4
actor STEAM_SPRITE sleeptime -1
ifaction 0 action ASTEAM_SPRITE1
ifaction ASTEAM_SPRITE1 { cstat 32768 ifactioncount 50 ifrnd 19 { ifpdistl 8600 sound SOUND29 sizeat 83 56 cstat 2 action ASTEAM_SPRITE2 } }
ifaction ASTEAM_SPRITE2 { 
ifactioncount 1 sizeat 112 112
ifactioncount 6 cstat 514
ifactioncount 7 { cstat 32768 action ASTEAM_SPRITE1 } 
}
enda

actor WINDOW2_SPRITE sleeptime -1
ifaction 0 action ZERO
ifaction ZERO {
ifspritepal 10 { spritepal 4 action ZERO2 }
ifspritepal 11 ifactioncount 5 { spritepal 4 action ZERO2 }
ifspritepal 12 ifactioncount 10 { spritepal 4 action ZERO2 }
ifspritepal 13 ifactioncount 15 { spritepal 4 action ZERO2 }
ifspritepal 14 ifactioncount 20 { spritepal 4 action ZERO2 }
}

ifaction ZERO2 {
spritepal 4 ifactioncount 5 action ZERO3 }

ifaction ZERO3 {
spritepal 0 ifactioncount 25 action ZERO2 }
enda


actor SPINWALL_SPRITE 
state shadestate 
addvar ANGVAR 30
setactor[THISACTOR].ang ANGVAR
enda

actor DOORSPAWN_SPRITE
cstat 19 sizeat 128 128 ifcount 1 killit
enda

action AMESSAGE_SPRITE1 0 0 0 0 2
action AMESSAGE_SPRITE2 1 0 0 0 2
actor MESSAGE1_SPRITE 
ifvare LANGUAGE_VAR 0 action AMESSAGE_SPRITE1
else action AMESSAGE_SPRITE2 
enda

actor MESSAGE2_SPRITE 
ifvare LANGUAGE_VAR 0 action AMESSAGE_SPRITE1
else action AMESSAGE_SPRITE2 
enda


actor MESSAGE3_SPRITE 
ifvare LANGUAGE_VAR 0 spritepal 0
else spritepal 3
enda

actor MESSAGE4_SPRITE 
ifvare LANGUAGE_VAR 0 spritepal 0
else spritepal 3
enda

actor MESSAGE5_SPRITE sleeptime -1
ifaction 0 ifvare MUSIC_VAR 12 
{
ifvare LANGUAGE_VAR 0 action AMESSAGE_SPRITE1
else action AMESSAGE_SPRITE2 
}

ifaction AMESSAGE_SPRITE1 ifactioncount 108000 ifvare COUNTER 0 { globalsound SOUND3 palfrom 60 63 63 63 guts JIBS1 32 setvar COUNTER 1 }
ifaction AMESSAGE_SPRITE2 ifactioncount 108000 ifvare COUNTER 0 { globalsound SOUND3 palfrom 60 63 63 63 guts JIBS1 32 setvar COUNTER 1 }
ifvare MUSIC_VAR 12 { } else ifvare COUNTER 0 action 0
ifvare COUNTER 0 cstat 32768 else cstat 16
enda

actor MESSAGE6_SPRITE 
ifvare LANGUAGE_VAR 0 action AMESSAGE_SPRITE1
else action AMESSAGE_SPRITE2 
enda

actor MESSAGE7_SPRITE 
ifvare LANGUAGE_VAR 0 action AMESSAGE_SPRITE1
else action AMESSAGE_SPRITE2 
enda




action ADRIP_SPRITE1 0 1 1 1 2
action ADRIP_SPRITE2 1 5 1 1 3
actor DRIP_SPRITE fall sizeat 80 80 clipdist 1
ifaction 0 action ADRIP_SPRITE1
ifaction ADRIP_SPRITE1 { iffloordistl 1 action ADRIP_SPRITE2 }
ifaction ADRIP_SPRITE2 { ifactioncount 5 killit }
enda

state destruction
ifhitweapon { sound GLASS_HEAVYBREAK guts JIBS3 12 killit }
ends

actor OBJECT1_SPRITE 
state destruction
enda

actor OBJECT2_SPRITE 
state destruction
enda





state flyingparticle
ifaction 0 {
randvar ZVEL 2024
addvar ZVEL 512
mulvar ZVEL -1
action ZERO }
getactor[THISACTOR].z myz
addvarvar myz ZVEL
setactor[THISACTOR].z myz
addvarvar ZVEL GRAVITY
ends

move SPARKMOVE 30
actor SPARK_SPRITE clipdist 1 sizeat 44 44
move SPARKMOVE geth getv

addvar COUNTER 1
ifvarg COUNTER 20 iffloordistl 1 killit
ifnotmoving killit

ifvarg COUNTER 26 cstat 2
ifvarg COUNTER 28 cstat 514
ifvarg COUNTER 30 killit

state flyingparticle
enda

action ASCREEN_SPRITE1 1 0 0 0 2

action ASCREEN_SPRITE2 5 0 0 0 2
action ASCREEN_SPRITE3 6 0 0 0 2
action ASCREEN_SPRITE4 7 0 0 0 2
action ASCREEN_SPRITE5 8 0 0 0 2
action ASCREEN_SPRITE6 9 0 0 0 2
action ASCREEN_SPRITE7 10 0 0 0 2
action ASCREEN_SPRITE8 11 0 0 0 2
action ASCREEN_SPRITE9 12 0 0 0 2

action ASCREEN_SPRITE10 13 0 0 0 2
action ASCREEN_SPRITE11 14 0 0 0 2
action ASCREEN_SPRITE12 15 0 0 0 2
action ASCREEN_SPRITE13 16 0 0 0 2
action ASCREEN_SPRITE14 17 0 0 0 2
action ASCREEN_SPRITE15 18 0 0 0 2
action ASCREEN_SPRITE16 19 0 0 0 2
action ASCREEN_SPRITE17 20 0 0 0 2
actor SCREEN_SPRITE sleeptime -1
ifaction 0 ifcansee ifpdistl 4000 action ASCREEN_SPRITE1
ifaction ASCREEN_SPRITE1 { soundonce SOUND41 ifactioncount 16 {
ifspritepal 10 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE2 else action ASCREEN_SPRITE3 }
ifspritepal 11 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE4 else action ASCREEN_SPRITE5 }
ifspritepal 12 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE6 else action ASCREEN_SPRITE7 }
ifspritepal 13 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE8 else action ASCREEN_SPRITE9 }

ifspritepal 14 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE10 else action ASCREEN_SPRITE11 }
ifspritepal 15 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE12 else action ASCREEN_SPRITE13 }
ifspritepal 16 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE14 else action ASCREEN_SPRITE15 }
ifspritepal 17 { stopsound SOUND41 ifvare LANGUAGE_VAR 0 action ASCREEN_SPRITE16 else action ASCREEN_SPRITE17 }
}
}
enda

action ALARM_SPRITE1 -1 0 0 0 2
actor ALARM_SPRITE sleeptime -1
ifaction 0 ifvare VIRTUALVAR 5 action ALARM_SPRITE1
ifaction ALARM_SPRITE1 ifpdistl 9600 soundonce SOUND14
enda

action ALARMCAMERA_SPRITE1 -1 0 0 0 2
actor ALARMCAMERA_SPRITE sleeptime -1
ifaction 0 ifvare VIRTUALVAR 5 action ALARMCAMERA_SPRITE1
enda

action ASCREEN2_SPRITE1 -22 0 0 0 2
action ASCREEN2_SPRITE2 0 7 1 1 28
action ASCREEN2_SPRITE3 7 0 0 0 2
actor SCREEN2_SPRITE sleeptime -1
ifaction 0 { cstat 208 action ASCREEN2_SPRITE1 }
ifaction ASCREEN2_SPRITE1 ifactioncount 170 { cstat 80 action ASCREEN2_SPRITE2 }
ifaction ASCREEN2_SPRITE2 ifactioncount 7 { action ASCREEN2_SPRITE3 } 
ifaction ASCREEN2_SPRITE3 ifactioncount 25 { cstat 208 action ASCREEN2_SPRITE1 }
enda

actor HEAD_SPRITE sleeptime -1
ifaction 0 { cstat 32768 ifvare VIRTUALVAR 8 { cstat 2 ifspritepal 0 action ZERO2 else action ZERO } }
ifaction ZERO {
ifpdistl 3800 ifcansee killit
}

ifaction ZERO2 {
ifpdistl 2400 ifcansee killit
}
enda


actor SPINNINGSHAPE_SPRITE sleeptime -1
addvar ANGVAR 30
setactor[THISACTOR].ang ANGVAR
enda

actor LASERDRIP_SPRITE fall sizeat 16 88 cstat 514
iffloordistl 1 killit
enda


action TIME_SPRITE1 0 0 0 0 2
action TIME_SPRITE2 1 0 0 0 2
action TIME_SPRITE3 2 0 0 0 2
action TIME_SPRITE4 3 0 0 0 2
action TIME_SPRITE5 4 0 0 0 2
action TIME_SPRITE6 5 0 0 0 2
action TIME_SPRITE7 6 0 0 0 2
action TIME_SPRITE8 7 0 0 0 2
action TIME_SPRITE9 8 0 0 0 2
action TIME_SPRITE10 9 0 0 0 2

actor TIME_SPRITE sleeptime -1
ifvare MUSIC_VAR 12 { } else action 0
ifvare STUFF_VAR 6 action 0

ifaction 0 { stopsound SOUND48 ifvare MUSIC_VAR 12 action TIME_SPRITE1 }

ifaction TIME_SPRITE1 {
ifspritepal 10 ifactioncount 30 { globalsound SOUND48 action TIME_SPRITE2 }
ifspritepal 11 ifactioncount 300 action TIME_SPRITE2

ifspritepal 12 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE2 }
ifspritepal 13 ifactioncount 18000 action TIME_SPRITE2

ifspritepal 14 ifactioncount 108000 action TIME_SPRITE2
ifspritepal 15 ifactioncount 1080000 action TIME_SPRITE2
}

ifaction TIME_SPRITE2 {
ifspritepal 10 ifactioncount 30 action TIME_SPRITE3
ifspritepal 11 ifactioncount 300 action TIME_SPRITE3

ifspritepal 12 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE3 }
ifspritepal 13 ifactioncount 18000 action TIME_SPRITE3

ifspritepal 14 ifactioncount 108000 action TIME_SPRITE3
ifspritepal 15 ifactioncount 1080000 action TIME_SPRITE3
}

ifaction TIME_SPRITE3 {
ifspritepal 10 ifactioncount 30 { globalsound SOUND48  action TIME_SPRITE4 }
ifspritepal 11 ifactioncount 300 action TIME_SPRITE4

ifspritepal 12 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE4 }
ifspritepal 13 ifactioncount 18000 action TIME_SPRITE4

ifspritepal 14 ifactioncount 108000 action TIME_SPRITE4
ifspritepal 15 ifactioncount 1080000 action TIME_SPRITE4
}

ifaction TIME_SPRITE4 {
ifspritepal 10 ifactioncount 30 action TIME_SPRITE5
ifspritepal 11 ifactioncount 300 action TIME_SPRITE5

ifspritepal 12 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE5 }
ifspritepal 13 ifactioncount 18000 action TIME_SPRITE5

ifspritepal 14 ifactioncount 108000 action TIME_SPRITE5
ifspritepal 15 ifactioncount 1080000 action TIME_SPRITE5
}

ifaction TIME_SPRITE5 {
ifspritepal 10 ifactioncount 30 { globalsound SOUND48  action TIME_SPRITE6 }
ifspritepal 11 ifactioncount 300 action TIME_SPRITE6

ifspritepal 12 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE6 }
ifspritepal 13 ifactioncount 18000 action TIME_SPRITE6

ifspritepal 14 ifactioncount 108000 action TIME_SPRITE6
ifspritepal 15 ifactioncount 1080000 action TIME_SPRITE6
}

ifaction TIME_SPRITE6 {
ifspritepal 10 ifactioncount 30 action TIME_SPRITE7
ifspritepal 11 ifactioncount 300 action TIME_SPRITE1

ifspritepal 12 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE7 }
ifspritepal 13 ifactioncount 18000 action TIME_SPRITE1

ifspritepal 14 ifactioncount 108000 action TIME_SPRITE7
ifspritepal 15 ifactioncount 1080000 action TIME_SPRITE1
}

ifaction TIME_SPRITE7 {
ifspritepal 10 ifactioncount 30 { globalsound SOUND48  action TIME_SPRITE8 }

ifspritepal 13 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE8 }

ifspritepal 15 ifactioncount 108000 action TIME_SPRITE8
}

ifaction TIME_SPRITE8 {
ifspritepal 10 ifactioncount 30 action TIME_SPRITE9

ifspritepal 13 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE9 }

ifspritepal 15 ifactioncount 108000 action TIME_SPRITE9
}

ifaction TIME_SPRITE9 {
ifspritepal 10 ifactioncount 30 { globalsound SOUND48  action TIME_SPRITE10 }

ifspritepal 13 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE10 }

ifspritepal 15 ifactioncount 108000 action TIME_SPRITE10
}

ifaction TIME_SPRITE10 {
ifspritepal 10 ifactioncount 30  action TIME_SPRITE1

ifspritepal 13 ifactioncount 1800 { setvar STUFF_VAR 5 action TIME_SPRITE1 }

ifspritepal 15 ifactioncount 108000 action TIME_SPRITE1
}


enda

action ATIMECHECK_SPRITE1 0 0 0 0 2
action ATIMECHECK_SPRITE2 4 0 0 0 2
action ATIMECHECK_SPRITE3 0 0 0 0 2

actor TIMECHECK_SPRITE sleeptime -1

ifvare MUSIC_VAR 12 { } else action 0
ifaction 0 action ATIMECHECK_SPRITE1
ifaction ATIMECHECK_SPRITE1 ifvare STUFF_VAR 5 { setvar PRESS_VAR 1 setvar STUFF_VAR 0 action ATIMECHECK_SPRITE2 }
ifaction ATIMECHECK_SPRITE2 { ifp pfacing ifhitspace ifpdistl 1200 ifvare PRESS_VAR 0 { globalsound SOUND8 action ATIMECHECK_SPRITE1 } 
ifactioncount 120 { globalsound SOUND14 setvar STUFF_VAR 6 action ATIMECHECK_SPRITE3 }
}
ifaction ATIMECHECK_SPRITE3 ifactioncount 10 { setvar STUFF_VAR 0 action ATIMECHECK_SPRITE1 }

enda

move BLUESMOKE_MOVE 0 -40
actor BLUESMOKE_SPRITE spritepal 1
ifaction 0 { sizeat 48 26 action ZERO }
ifaction ZERO {

move BLUESMOKE_MOVE geth getv
ifactioncount 12 sizeat 45 23
ifactioncount 14 { cstat 2 sizeat 42 19 }
ifactioncount 16 { cstat 514 sizeat 37 14 }
ifactioncount 18 killit
}
enda




move BALL_MOVE 30

actor BALL_SPRITE
sizeat 72 72

ifaction 0 { cstat 514 action ZERO }
ifaction ZERO {
ifactioncount 4 cstat 2
ifactioncount 8 cstat 0
}

ifspritepal 0 spritepal 3

getactor[THISACTOR].z myz
addvarvar myz ZVEL
setactor[THISACTOR].z myz
addvarvar ZVEL GRAVITY
move BALL_MOVE geth getv


getactor[THISACTOR].z myz
getsector[THISACTOR].floorz sectorz
subvarvar sectorz myz

ifvarl sectorz 20 ifvare COUNTER 0 { 

ifspritepal 3 {

ifvarl ZVEL 512 { killit }
else { setvar COUNTER 5 mulvar ZVEL -1 divvar ZVEL 2 spritepal 21 ifpdistl 20000 sound SOUND55 } 
} 

}

ifvarg COUNTER 0 subvar COUNTER 1
ifspritepal 21 spritepal 3
ifnotmoving killit
enda


actor BLACKWALL_SPRITE ifspritepal 4 { 
sleeptime -1
ifaction 0 { cstat 32768 ifvare STUFF_VAR 11 action ZERO }

ifaction ZERO {
ifactioncount 90 cstat 531
ifactioncount 98 cstat 19
ifactioncount 106 cstat 17
}
}
enda

action ALAMP_SPRITE -1 
actor LAMP_SPRITE 
sizeto 230 230 sizeto 230 230 spritepal 2
ifaction 0 { palfrom 30 64 64 64 sound SOUND58 spritepal 2 guts JIBS1 12 action ALAMP_SPRITE }
enda


spritenoshade PLANE_SPRITE 
action APLANE_SPRITE1 0 0 0 0 2
action APLANE_SPRITE2 0 0 0 0 2
action APLANE_SPRITE3 668 0 0 0 2
actor PLANE_SPRITE
ifaction 0 { 

cstat 32768 
ifspritepal 0 ifvare STUFF_VAR 7 action APLANE_SPRITE1
ifspritepal 3 ifvare STUFF_VAR 8 action APLANE_SPRITE1
}

ifaction APLANE_SPRITE1 ifactioncount 30 { globalsound SOUND62 cstat 546 action APLANE_SPRITE2 }

ifaction APLANE_SPRITE2 {
ifactioncount 4 cstat 34
ifactioncount 8 cstat 32
ifactioncount 6 spawn PLANE_SPRITE2
ifactioncount 400 killit

getactor[THISACTOR].y my
ifspritepal 0 subvar my 900 else addvar my 900  
setactor[THISACTOR].y my
}

enda

actor PLANE_SPRITE2
spritepal 10
ifaction 0 { sizeat 255 255 cstat 34 action APLANE_SPRITE3 }

ifaction APLANE_SPRITE3 {
ifactioncount 1 cstat 546
ifactioncount 2 killit
}

enda

actor SWITCH1_SPRITE sleeptime -1
ifvare SWITCH1_VAR 0 { spritepal 10 setvar SWITCH1_VAR 10 }

ifcansee ifvare PRESS_VAR 0 ifp pfacing ifpdistl 1200 ifhitspace ifvare DOOROPEN_VAR 0 {
ifvare SWITCH1_VAR 10 { spritepal 14 setvar SWITCH1_VAR 14 } else
ifvare SWITCH1_VAR 14 { spritepal 16 setvar SWITCH1_VAR 16 } else
ifvare SWITCH1_VAR 16 { spritepal 17 setvar SWITCH1_VAR 17 } else
ifvare SWITCH1_VAR 17 { spritepal 18 setvar SWITCH1_VAR 18 } else
ifvare SWITCH1_VAR 18 { spritepal 10 setvar SWITCH1_VAR 10 }
setvar PRESS_VAR 1 sound SOUND1
}

ifvare DOOROPEN_VAR 1 state shadestate 
enda

actor SWITCH2_SPRITE sleeptime -1
ifvare SWITCH2_VAR 0 { spritepal 10 setvar SWITCH2_VAR 10 }

ifcansee ifvare PRESS_VAR 0 ifp pfacing ifpdistl 1200 ifhitspace ifvare DOOROPEN_VAR 0 {
ifvare SWITCH2_VAR 10 { spritepal 14 setvar SWITCH2_VAR 14 } else
ifvare SWITCH2_VAR 14 { spritepal 16 setvar SWITCH2_VAR 16 } else
ifvare SWITCH2_VAR 16 { spritepal 17 setvar SWITCH2_VAR 17 } else
ifvare SWITCH2_VAR 17 { spritepal 18 setvar SWITCH2_VAR 18 } else
ifvare SWITCH2_VAR 18 { spritepal 10 setvar SWITCH2_VAR 10 }
setvar PRESS_VAR 1 sound SOUND1
}

ifvare DOOROPEN_VAR 1 state shadestate 
enda


actor SWITCH3_SPRITE sleeptime -1
ifvare SWITCH3_VAR 0 { spritepal 10 setvar SWITCH3_VAR 10 }

ifcansee ifvare PRESS_VAR 0 ifp pfacing ifpdistl 1200 ifhitspace ifvare DOOROPEN_VAR 0 {
ifvare SWITCH3_VAR 10 { spritepal 14 setvar SWITCH3_VAR 14 } else
ifvare SWITCH3_VAR 14 { spritepal 16 setvar SWITCH3_VAR 16 } else
ifvare SWITCH3_VAR 16 { spritepal 17 setvar SWITCH3_VAR 17 } else
ifvare SWITCH3_VAR 17 { spritepal 18 setvar SWITCH3_VAR 18 } else
ifvare SWITCH3_VAR 18 { spritepal 10 setvar SWITCH3_VAR 10 }
setvar PRESS_VAR 1 sound SOUND1
}

ifvare DOOROPEN_VAR 1 state shadestate 
enda

actor SWITCH4_SPRITE sleeptime -1
ifvare SWITCH4_VAR 0 { spritepal 10 setvar SWITCH4_VAR 10 }

ifcansee ifvare PRESS_VAR 0 ifp pfacing ifpdistl 1200 ifhitspace ifvare DOOROPEN_VAR 0 {
ifvare SWITCH4_VAR 10 { spritepal 14 setvar SWITCH4_VAR 14 } else
ifvare SWITCH4_VAR 14 { spritepal 16 setvar SWITCH4_VAR 16 } else
ifvare SWITCH4_VAR 16 { spritepal 17 setvar SWITCH4_VAR 17 } else
ifvare SWITCH4_VAR 17 { spritepal 18 setvar SWITCH4_VAR 18 } else
ifvare SWITCH4_VAR 18 { spritepal 10 setvar SWITCH4_VAR 10 }
setvar PRESS_VAR 1 sound SOUND1
}

ifvare DOOROPEN_VAR 1 state shadestate 
enda
actor SWITCH5_SPRITE sleeptime -1
ifvare SWITCH5_VAR 0 { spritepal 10 setvar SWITCH5_VAR 10 }

ifcansee ifvare PRESS_VAR 0 ifp pfacing ifpdistl 1200 ifhitspace ifvare DOOROPEN_VAR 0 {
ifvare SWITCH5_VAR 10 { spritepal 14 setvar SWITCH5_VAR 14 } else
ifvare SWITCH5_VAR 14 { spritepal 16 setvar SWITCH5_VAR 16 } else
ifvare SWITCH5_VAR 16 { spritepal 17 setvar SWITCH5_VAR 17 } else
ifvare SWITCH5_VAR 17 { spritepal 18 setvar SWITCH5_VAR 18 } else
ifvare SWITCH5_VAR 18 { spritepal 10 setvar SWITCH5_VAR 10 }
setvar PRESS_VAR 1 sound SOUND1
}

ifvare DOOROPEN_VAR 1 state shadestate 
enda


actor PLATFORM_SPRITE ifspritepal 1 { sleeptime -1
ifaction 0 { cstat 32768 action ZERO }
ifpdistl 1800 { ifvare COUNTER 0 { setvar COUNTER 1 sound SOUND59 cstat 33 } } else { ifvare COUNTER 1 { sound SOUND59 cstat 32768 setvar COUNTER 0 } }
}
enda

action AENDINGBALL_SPRITE 0 0 0 0 2
action AENDINGBALL_SPRITE2 0 0 0 0 2
actor ENDINGBALL_SPRITE sleeptime -1
ifaction 0 { sizeat 45 80 action AENDINGBALL_SPRITE }

ifaction AENDINGBALL_SPRITE {
ifactioncount 2 sizeat 48 83
ifactioncount 4 { sizeat 45 80 resetactioncount }

ifhitweapon { sizeat 59 110 addvar HITPOINT_VAR 1 guts JIBS2 5 
sound SOUND22 palfrom 10 63 63 63 action AENDINGBALL_SPRITE2 } else strength COMMANDERSTRENGTH
}

ifaction AENDINGBALL_SPRITE2 { sizeat 56 96 ifactioncount 1 action AENDINGBALL_SPRITE }

ifvare HITPOINT_VAR 6 { globalsound SOUND69 quake 15 stopsound SOUND22 stopsound SOUND68 stopsound SOUND65 
guts JIBS2 40 palfrom 63 63 63 63 globalsound SOUND3 setvar STUFF_VAR 11 killit }
soundonce SOUND65
soundonce SOUND68

ifvare COUNTER 0 { spritepal 3 setvar COUNTER 1 } else
ifvare COUNTER 1 { spritepal 0 setvar COUNTER 0 }
enda


actor TRAFFICLIGHT_SPRITE sleeptime -1
ifaction 0 { cstat 32768
ifspritepal 10 ifvare STUFF_VAR 9 action ZERO5
ifspritepal 11 ifvare STUFF_VAR 10 action ZERO6
}

ifaction ZERO5 {
ifactioncount 2 cstat 595
ifactioncount 4 cstat 83
ifactioncount 6 cstat 81

ifvare STUFF_VAR 10 action ZERO7
}

ifaction ZERO6 {
ifactioncount 2 cstat 595
ifactioncount 4 cstat 83
ifactioncount 6 cstat 81
}

ifaction ZERO7 {
ifactioncount 2 cstat 83
ifactioncount 4 cstat 595
ifactioncount 6 cstat 32768
}
enda

action ACRUSHTV_SPRITE 0 0 0 0 2

action ACRUSHTV_SPRITE1 2 0 0 0 2
action ACRUSHTV_SPRITE2 4 0 0 0 2
action ACRUSHTV_SPRITE3 6 0 0 0 2
action ACRUSHTV_SPRITE4 8 0 0 0 2

action ACRUSHTV_SPRITE1_1 3 0 0 0 2
action ACRUSHTV_SPRITE2_2 5 0 0 0 2
action ACRUSHTV_SPRITE3_3 7 0 0 0 2
action ACRUSHTV_SPRITE4_4 9 0 0 0 2
actor CRUSHTV_SPRITE sleeptime -1
ifaction 0 action ACRUSHTV_SPRITE

ifaction ACRUSHTV_SPRITE ifactioncount 90 ifrnd 64 {
ifvare LANGUAGE_VAR 0 {
ifrnd 64 action ACRUSHTV_SPRITE1 else
ifrnd 128 action ACRUSHTV_SPRITE2 else
ifrnd 192 action ACRUSHTV_SPRITE3 else
action ACRUSHTV_SPRITE4
}
ifvare LANGUAGE_VAR 1 {
ifrnd 64 action ACRUSHTV_SPRITE1_1 else
ifrnd 128 action ACRUSHTV_SPRITE2_2 else
ifrnd 192 action ACRUSHTV_SPRITE3_3 else
action ACRUSHTV_SPRITE4_4
}
}

ifaction ACRUSHTV_SPRITE1 ifactioncount 150 action ACRUSHTV_SPRITE 
ifaction ACRUSHTV_SPRITE2 ifactioncount 150 action ACRUSHTV_SPRITE 
ifaction ACRUSHTV_SPRITE3 ifactioncount 150 action ACRUSHTV_SPRITE 
ifaction ACRUSHTV_SPRITE4 ifactioncount 150 action ACRUSHTV_SPRITE 

ifaction ACRUSHTV_SPRITE1_1 ifactioncount 150 action ACRUSHTV_SPRITE 
ifaction ACRUSHTV_SPRITE2_2 ifactioncount 150 action ACRUSHTV_SPRITE 
ifaction ACRUSHTV_SPRITE3_3 ifactioncount 150 action ACRUSHTV_SPRITE 
ifaction ACRUSHTV_SPRITE4_4 ifactioncount 150 action ACRUSHTV_SPRITE 

enda


actor WATCHER_SPRITE sleeptime -1
ifaction 0 { cstat 0
ifspritepal 10 ifvare STUFF_VAR 20 action ZERO 
ifspritepal 11 ifvare STUFF_VAR 21 action ZERO 
ifspritepal 12 ifvare STUFF_VAR 22 action ZERO 
ifspritepal 13 ifvare STUFF_VAR 23 action ZERO 
}
ifaction ZERO {
ifactioncount 5 cstat 2
ifactioncount 10 cstat 514
ifactioncount 15 killit
}
enda

move DIGITALEFFECT_MOVE 25
actor DIGITALEFFECT_SPRITE 
ifaction 0 { sizeat 10 10 cstat 658 action ZERO }
ifaction ZERO {
sizeto 152 152
ifactioncount 4 cstat 146
ifactioncount 8 cstat 144
move DIGITALEFFECT_MOVE geth getv
ifnotmoving killit
}
enda